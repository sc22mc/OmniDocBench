Define  $\delta_{i,n},i = 3,4$  by

$$
\begin{array}{c}{\delta_{3,n}\coloneqq \frac{1}{n}\log \left[\epsilon (n + 1)^{|\mathcal{X}|}\right.}\\ {\left.\times \{(n + 1)^{|\mathcal{X}|} + (n + 1)^{|\mathcal{X}||\mathcal{Z}|}\} \right],}\\ {\delta_{4,n}\coloneqq \frac{1}{n}\log \left[(7nR)(n + 1)^{3|\mathcal{X}||\mathcal{Z}|}\right.}\\ {\left.\times \{(n + 1)^{|\mathcal{X}|} + (n + 1)^{|\mathcal{X}||\mathcal{Z}|}\} \right].} \end{array}
$$

Note that for  $i = 3,4$ $\delta_{i,n}\to 0$  as  $n\to \infty$  .Our main result is the following.

Theorem 2. For any  $R_{\mathcal{A}},R > 0$  there exists a sequence of mappings  $\{(\phi^{(n)},\psi^{(n)})\}_{n = 1}^{\infty}$  satisfying

$$
R - \frac{1}{n}\leq \frac{1}{n}\log |\mathcal{X}^m | = \frac{m}{n}\log |\mathcal{X}|\leq R
$$

such that for any  $(p_X,p_K,W)$  with  $(R_{\mathcal{A}},R)\in \mathcal{R}^{(\mathrm{in})}($ $p_X,p_K,W)$  , we have that

$$
p_{\mathrm{e}}(\phi^{(n)},\psi^{(n)}|p_{X}^{n})\leq \mathrm{e}^{-n[E(R|p_{X}) - \delta_{3,n}]} \tag{9}
$$

and that for any eavesdropper  $\mathcal{A}$  with  $\phi_{\mathcal{A}}$  satisfying  $\phi_{\mathcal{A}}^{(n)}\in$ $\mathcal{F}_{\mathcal{A}}^{(n)}(R_{\mathcal{A}})$

$$
\begin{array}{rl} & {\Delta^{(n)}(\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{X}^{n},p_{K}^{n},W^{n})}\\ & {\leq \mathrm{e}^{-n[G(R_{\mathcal{A}},R|_{\mathcal{P}K},W) - \delta_{4,n}]}.\qquad (10} \end{array} \tag{10}
$$

By Theorem 2 under  $(R_{\mathcal{A}},R)\in \mathcal{R}^{(\mathrm{in})}(p_X,p_K,W)$  , we have the followings:

On the reliability,  $p_{\mathcal{E}}(\phi^{(n)},\psi^{(n)}|p_{X}^{n})$  goes to zero exponentially as  $n$  tends to infinity, and its exponent is lower bounded by the function  $E(R|p_{X})$  On the security, for any  $\phi_{\mathcal{A}}$  satisfying  $\phi_{\mathcal{A}}^{(n)}\in \mathcal{F}_{\mathcal{A}}^{(n)}(R_{\mathcal{A}})$ $\Delta^{(n)}(\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{X}^{n},p_{K}^{n},W^{n})$  goes to zero exponentially as  $n$  tends to infinity, and its exponent is lower bounded by the function  $G(R_{\mathcal{A}},R|_{\mathcal{P}K},W)$  The code that attains the exponent functions  $E(R|p_{X})$  and  $G(R_{\mathcal{A}},R|_{\mathcal{P}K},W)$  is the universal code that depends only on  $(R_{\mathcal{A}},R)$  not on the value of the distributions  $p_{X}$ $p_{Z}$  ,and  $W$

# V. PROOF OUTLINE OF THE MAIN RESULT

In this section we outline the proof of Theorem 2 We first present several definitions on the types. For any  $n$  - sequence  $k^n = k_1k_2\dots k_n\in \mathcal{X}^n$ $n(k|k^n)$  denotes the number of  $t$  such that  $k_{t} = k$  . The relative frequency  $\{n(k|k^n) / n\}_{k\in \mathcal{X}}$  of the components of  $x^n$  is called the type of  $k^n$  denoted by  $P_{kn}$  . The set that consists of all the types on  $\mathcal{A}$  is denoted by  $\mathcal{P}_n(\mathcal{X})$  .For  $p_{\overline{K}}\in \mathcal{P}_n(\mathcal{X})$  , set

$$
T_{\overline{K}}^{n}\coloneqq \{k^{n}:P_{k^{n}} = p_{\overline{K}}\} .
$$

Similarly, for any two  $n$  sequences  $k^n = k_1k_2$ $\cdot \cdot \cdot ,k_n\in$ $\mathcal{X}^n$  and  $z^n = z_1z_2,\dots ,z_n\in \mathcal{Z}^n$ $n(k,z|k^n,z^n)$  denotes the number of  $t$  such that  $(k_{t},z_{t}) = (k,z)$  .The relative frequency  $\{n(k,z|k^n,z^n) / n\}_{(k,z)\in \mathcal{X}\times \mathcal{Z}}$  of the components of  $(k^n,z^n)$  is called the joint type of  $(k^n,z^n)$  denoted by  $P_{kn},z^n$  . Furthermore, the set of all the joint type of  $\mathcal{X}\times \mathcal{Z}$  is denoted by  $\mathcal{P}_n(\mathcal{X}\times \mathcal{Z})$  .For  $p_{\overline{K}\overline{Z}}\in \mathcal{P}_n(\mathcal{X}\times \mathcal{Z})$  , set

$$
T_{\overline{K}\overline{Z}}^{n}\coloneqq \{(k^{n},z^{n}):P_{k^{n},z^{n}} = P_{\overline{K}\overline{Z}}\} .
$$

Furthermore, for  $p_{\overline{K}}\in \mathcal{P}_n(\mathcal{X})$  and  $k^n\in T_{\overline{K}}^n$  , set

$$
T_{\overline{Z} |\overline{K}}^{n}(k^{n})\coloneqq \{z^{n}:P_{k^{n},z^{n}} = p_{\overline{K}}\overline{z}\} .
$$

We next discuss upper bounds of

$$
\Delta_{n}(\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{X}^{n},p_{K}^{n},W^{n}) = I(\widetilde{C}^{m},M_{\mathcal{A}}^{(n)};X^{n}).
$$

According to 5, on an upper bound of  $I(\widetilde{C}^{m},M_{\mathcal{A}}^{(n)};X^{n})$  we have the following lemma.

Lemma 1: 5

$$
I(\widetilde{C}^{m},M_{\mathcal{A}}^{(n)};X^{n})\leq D\left(p_{\widetilde{K}^{m}|M_{\mathcal{A}}^{(n)}}\big||p_{V^{m}}\big|p_{M_{\mathcal{A}}^{(n)}}\right), \tag{11}
$$

where  $p_{V^m}$  is the uniform distribution over  $\mathcal{X}^m$

Set  $M^{(n)}\coloneqq P_{K^n,Z^n}$  . Then we have the following:

$$
\begin{array}{rl} & D\left(p_{\widetilde{K}^{m}|M_{\mathcal{A}}^{(n)}}\big||p_{V^{m}}\big|p_{M_{\mathcal{A}}^{(n)}}\right)\\ & \leq D\left(p_{\widetilde{K}^{m}|M_{\mathcal{A}}^{(n)}M^{(n)}}\big||p_{V^{m}}\big|p_{M_{\mathcal{A}}^{(n)}M^{(n)}}\right). \end{array} \tag{12}
$$

For  $p_{\overline{K}\overline{Z}}\in \mathcal{P}_n(\mathcal{X}\times \mathcal{Z})$  , set

$$
\begin{array}{rl} & D\left(p_{\widetilde{K}^{m}|M_{\mathcal{A}}^{(n)}M^{(n)} = p_{\overline{K}}\overline{z}}\big||p_{V^{m}}\big|p_{M_{\mathcal{A}}^{(n)}M^{(n)} = p_{\overline{K}}\overline{z}}\right)\\ & \coloneqq \zeta (\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{\overline{K}}\overline{z}). \end{array} \tag{13}
$$

From 1112)and 13),we have

$$
\begin{array}{rlr}\Delta_{n}(\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{X}^{n},p_{K}^{n},W^{n})\leq & \sum_{p_{K}\geq \mathcal{Z}} & 1\\ & \in \mathcal{P}_{n}(\mathcal{X}\times \mathcal{Z})\\ & \times \operatorname *{Pr}\{M^{(n)} = p_{\overline{K}\overline{Z}}\} \zeta (\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{\overline{K}\overline{Z}}). \end{array} \tag{14}
$$

For  $p_{\overline{K}\overline{Z}}\in \mathcal{P}_n(\mathcal{X}\times \mathcal{Z})$  , define

$$
\begin{array}{rl} & {\Upsilon (R,\phi_{\mathcal{A}}^{(n)}|p_{\overline{K}\overline{Z}})\coloneqq \sum_{(a,k^n)\atop \in \mathcal{M}_{\mathcal{A}}^{(n)}\times T_{\overline{K}}^n}\frac{|(\phi_{\mathcal{A}}^{(n)})^{-1}(a)\cap T_{\overline{Z} |K}^n(k^n)|}{|T_{\overline{K}}^n\overline{z}|}}\\ & {\quad \times \log [1 + (\mathrm{e}^{nR} - 1)\frac{|(\phi_{\mathcal{A}}^{(n)})^{-1}(a)\cap T_{\overline{Z} |K}^n(k^n)||T_{\overline{K}}^n|}{|(\phi_{\mathcal{A}}^{(n)})^{-1}(a)\cap T_{\overline{Z}}^n||T_{\overline{K}}^n\overline{z}|}].} \end{array}
$$

On  $\zeta (\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{\overline{K}\overline{Z}})$  for  $p_{\overline{K}\overline{Z}}\in \mathcal{P}_n(\mathcal{X}\times \mathcal{Z})$  , we have the following lemma.

Lemma 2: For any  $p_{\overline{K}\overline{Z}}\in \mathcal{P}_n(\mathcal{X}\times \mathcal{Z})$

$$
\mathbf{E}\left[\zeta (\phi^{(n)},\phi_{\mathcal{A}}^{(n)}|p_{\overline{K}\overline{Z}})\right]\leq \Upsilon (R,\phi_{\mathcal{A}}^{(n)}|p_{\overline{K}\overline{Z}}), \tag{15}
$$

where  $\mathbf{E}[\cdot ]$  is an expectation based on the random choice of  $\phi^{(n)}$

To prove the above lemma we use a technique quite similar to that of Hayashi 7 used for an ensemble of universal2 functions. The following proposition is a key result for the proof of Theorem 1

Proposition  $I$  For any  $R_{\mathcal{A}},R > 0$  there exists a sequence of mappings  $\{(\phi^{(n)},\psi^{(n)})\}_{n = 1}^{\infty}$  satisfying

$$
R - \frac{1}{n}\leq \frac{1}{n}\log |\mathcal{X}^{m}| = \frac{m}{n}\log |\mathcal{X}|\leq R
$$