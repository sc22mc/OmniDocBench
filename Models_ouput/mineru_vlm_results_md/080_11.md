Lemma 3. Let  $\mathcal{A} = (Q,\Sigma ,\delta)$  be a PFA with carefully synchronizing word  $w$  Further, let  $q\in Q$  be such that there exists  $p\in Q$  such that  $q\in p.a^{- 1}$  .Let also  $\mathcal{A}^{\prime} = (Q\cup \{q^{\prime}\} ,\Sigma ,\delta^{\prime})$  where  $\delta^{\prime}$  is defined as  $\delta$  on  $Q$  and  $\delta^{\prime}(q^{\prime},a) = q$  .Then  $w$  carefully synchronizes  $\mathcal{A}^\prime$

Proof. Since  $a$  is defined for all states of  $Q^{\prime}$  ,and  $|\Sigma | = 2$  , then the first letter of  $w$  must be  $a$  .Let  $w^{\prime}$  be the word  $w$  without the first letter. Since  $\delta^{\prime}(q^{\prime},a) = q$  and we assumed that there exist  $p\in Q$  such that  $q\in p.a^{- 1}$  it is straightforward, that  $Q^{\prime}.a = Q.a$  . Since we have not added any other transitions to  $\mathcal{A}^\prime$  and  $\delta^{\prime}$  is defined as  $\delta$  on  $Q$  , we obtain that  $Q^{\prime}.aw^{\prime} = Q.aw^{\prime} = Q.w$  and that concludes the proof.

For the next lemma we assume notation as in former part of the paper.

Lemma 4. Let  $\begin{array}{r}\mathcal{B} = \bigcup_{i = 1}^{k}\mathcal{A}_k \end{array}$  and  $m\in \mathbb{N}$  be the smallest integer such that  $Q.a^{m} = Q.a^{m + 1}$  .Define  $B_{i} = Q_{i}.a^{m}b$  and let  $\mathcal{C}_1 = (S_1,\{a\} ,\eta_1),\ldots ,\mathcal{C}_l =$ $(S_{l},\{a\} ,\eta_{l})$  be a- clusters with depth 1 and centers  $K_{1},\ldots ,K_{l}$  respectively. Let  $\begin{array}{r}\mathcal{B}^{\prime} = \mathcal{B}\cup \bigcup_{i = 1}^{l}\mathcal{C}_{i} = (P^{\prime},\Sigma ,\rho^{\prime}) \end{array}$  .If we define  $b$  transitions for all states  $q\in$ $\textstyle \bigcup_{i = 1}^{l}K_{i}$  such that there exists  $0< j< k + 1$  such that  $\rho^{\prime}(q,b)\in B_{j}$  then  $P^{\prime}.w = \{q_{l}^{1},\dots,q_{l}^{k}\}$

Proof. Since  $a$  is the only letter defined for all states in  $\mathcal{A}$  and  $Q.a^{m} = Q.a^{m + 1}$  then  $w$  starts with a word  $a^{m_1}b$  for  $0< m_{1}< m + 1$  . Note  $w = a^{m_1}bw'$  Observe that  $Q.a^{i + 1}\subseteq Q.a^{i}$  for all  $i\geq 0$  . From that we have, that  $Q.a^{m}\subseteq Q.a^{m_1}$  and further for all copies of  $\mathcal{A}$  in  $B^{\prime}$  we obtain that  $B_{i}\in Q_{i}.a^{m_{1}}.b$  .Also, since the depth of any cluster  $C_i$  is  $1$  , we have that  $P_{j}.a^{m_{1}} = K_{j}$  for all  $0< j< m + 1$  Notice that  $\begin{array}{r}P^{\prime} = \bigcup_{i = 1}^{k}Q_{i}\cup \bigcup_{i = 1}^{l}S_{i} \end{array}$  so

$$
P^{\prime}.w = \bigcup_{i = 1}^{k}Q_{i}.w\cup \bigcup_{i = 1}^{l}S_{i}.w = \bigcup_{i = 1}^{k}Q_{i}.a^{m_{1}}bw^{\prime}\cup \bigcup_{i = 1}^{l}S_{i}.a^{m_{1}}bw^{\prime}
$$

which gives

$$
P^{\prime}.w = \bigcup_{i = 1}^{k}B_{i}.w^{\prime}\cup \bigcup_{i = 1}^{l}K_{i}bw^{\prime}.
$$

But we know, that for all  $\textstyle q\in \bigcup_{i = 1}K_{i}$  there exists  $0< i< k + 1$  such that  $\delta^{\prime}(q,b)\in B_{i}$  . From that we obtain

$$
P^{\prime}.w = \bigcup_{i = 1}^{k}B_{i}w^{\prime},
$$

and since each  $B_{i} = Q_{i}.a^{m}b$  then  $B_{i}.w^{\prime} = Q_{i}.a^{m}bw^{\prime} = Q_{i}.w = \{q_{l}^{i}\}$  and that concludes the proof.

Using these two lemmas we can move on to the description of the extended method of encryption and decryption. In the next two subsections we follow the notation provided in sections 3 and 4.