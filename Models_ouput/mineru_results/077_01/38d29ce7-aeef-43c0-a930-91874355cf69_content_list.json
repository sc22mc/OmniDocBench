[
    {
        "type": "text",
        "text": "Timewarp: Transferable Acceleration of Molecular Dynamics by Learning Time-Coarsened Dynamics ",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Leon Klein $^ { * } \\dag 1 2$ Andrew Y. K.Foong\\*1 Tor Erlend Fjelde $\\ast \\dagger 3$ Bruno Mlodozeniec\\*†3 Marc Brockschmidt \\* Sebastian NowozinFrank Noe124Ryota Tomioka1 ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Abstract ",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Molecular dynamics (MD) simulation is a widely used technique to simulate molecular systems, most commonly at the all-atom resolution where the equations of motion are integrated with timesteps on the order of femtoseconds( $\\mathrm { 1 f s = }$ $1 0 ^ { - 1 5 } \\mathrm { s } )$ .MD is often used to compute equilibriumproperties,which requires sampling from an equilibrium distribution such as the Boltzmann distribution. However, many important processes,suchas bindingand folding,occur over timescales of milliseconds or beyond,and cannot be efficiently sampled with conventional MD. Furthermore, new MD simulations need to be performed from scratch for each molecular system studied.We present Timewarp,an enhanced samplingmethod which uses a normalising flow as a proposal distribution in a Markov chain Monte Carlo method targeting the Boltzmann distribution.The flow is trained offline on MD trajectories and learns to make large steps in time, simulating the molecular dynamics of $\\mathrm { 1 0 ^ { 5 } - 1 0 ^ { 6 } }$ fs. Crucially, Timewarp is transferable between molecular systems: once trained,we show that it generalises to unseen small peptides (2-4 amino acids), exploring their metastable states and providing wallclock acceleration when sampling compared to standard MD. Our method constitutes an important step towards developing general, transferable algorithms for accelerating MD. ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "1. Introduction ",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Molecular dynamics (MD) is a well-established technique for simulating physical systems at the atomic level. When performed accurately, it provides unrivalled insight into the detailed mechanics of molecular motion,without the need forwet lab experiments.MD simulations have been used to understand processes of central interest in molecular biophysics,such as protein folding (Noé et al., 2009; Lindorff-Larsen et al., 2011),protein-ligand binding (Buch etal.,2O11),and protein-protein association (Plattner et al., 2017). Many crucial applications of MD boil down to efficiently sampling from the Boltzmann distribution,i.e., the equilibrium distribution of a molecular system at a temperature $T$ Let $( x ^ { p } ( t ) , x ^ { v } ( t ) ) : = x ( t ) \\in \\mathbb { R } ^ { 6 N }$ be the state of the molecule at time $t$ ,consisting of the positions $ { \\boldsymbol { x } } ^ { p } ( t ) \\in \\mathbb { R } ^ { 3 N }$ and velocities $x ^ { v } ( t ) \\in  { \\mathbb { R } } ^ { 3 N }$ of the $N$ atoms in Cartesian coordinates.The Boltzmann distribution is given by: ",
        "page_idx": 0
    },
    {
        "type": "image",
        "img_path": "images/928f6b4cbce3e64ac66e69a7f6ee619609c2049100872470def03620f2604b0e.jpg",
        "image_caption": [
            "Figure 1. Initial state $x ( t )$ (Left) and accepted proposal state $x ( t +$ $\\tau ) \\sim p _ { \\theta } ( x ( t + \\tau ) | x ( t ) )$ (Right) sampled from Timewarp for the tetrapeptide LAKS (not in trainset). The proposed state undergoes alarge conformational change relative to the initial state,traversing from one metastable state to another. "
        ],
        "image_footnote": [],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 0
    },
    {
        "type": "equation",
        "img_path": "images/ab0d63489b670777342415efa0c05d1d0c3f7e3ffc2d67fd9198e0d3e2683bf9.jpg",
        "text": "$$\n\\begin{array} { r } { \\textstyle \\mu ( x ^ { p } , x ^ { v } ) \\propto \\exp \\left( - \\frac { 1 } { k _ { B } T } ( U ( x ^ { p } ) + K ( x ^ { v } ) ) \\right) , } \\end{array}\n$$",
        "text_format": "latex",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "where $U ( x ^ { p } )$ is the potential energy, $K ( x ^ { v } )$ is the kinetic energy,and $k _ { B }$ is Boltzmann's constant. In practice we are interested in the marginal distribution of the positions, $\\mu ( x ^ { p } )$ .Many important quantities,such as the free energies associated with protein folding and protein-ligand binding, can be computed as expectations under $\\mu ( x ^ { p } )$ ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "A popular method in MD to sample from the Boltzmann distribution is Langevin dynamics (Langevin,19o8),which obeys the following stochastic differential equation (SDE): ",
        "page_idx": 0
    },
    {
        "type": "equation",
        "img_path": "images/abcff34d61983fc02b04000909fb0c78160c4c8c216d6ab47c5b5e7fcbed58db.jpg",
        "text": "$$\n\\begin{array} { r } { m _ { i } \\mathrm { d } x _ { i } ^ { v } = - \\nabla _ { i } U \\mathrm { d } t - \\gamma m _ { i } x _ { i } ^ { v } \\mathrm { d } t + \\sqrt { 2 m _ { i } \\gamma k _ { B } T } \\mathrm { d } B _ { t } . } \\end{array}\n$$",
        "text_format": "latex",
        "page_idx": 0
    }
]