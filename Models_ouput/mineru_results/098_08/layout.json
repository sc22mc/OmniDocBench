{
    "pdf_info": [
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        524,
                        399,
                        2027,
                        662
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                567,
                                333,
                                1974,
                                385
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        569,
                                        330,
                                        1976,
                                        390
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                569,
                                                330,
                                                1258,
                                                390
                                            ],
                                            "score": 0.973,
                                            "content": "Table 6: The results of pretrained ICAE (",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                1259,
                                                336,
                                                1434,
                                                380
                                            ],
                                            "score": 0.84,
                                            "content": "5 1 2  1 2 8",
                                            "type": "inline_equation"
                                        },
                                        {
                                            "bbox": [
                                                1436,
                                                330,
                                                1976,
                                                390
                                            ],
                                            "score": 0.977,
                                            "content": "based on different targetLLMs",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                524,
                                399,
                                2027,
                                662
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        524,
                                        399,
                                        2027,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                524,
                                                399,
                                                2027,
                                                662
                                            ],
                                            "score": 0.978,
                                            "html": "<table><tr><td rowspan=\"2\">Target LLM</td><td colspan=\"2\"></td><td colspan=\"2\">PP</td><td></td></tr><tr><td>BLEU()</td><td>Loss</td><td></td><td></td><td>△</td></tr><tr><td>Llama-7b</td><td>99.1</td><td>0.017</td><td>9.01</td><td>9.50</td><td>+0.49</td></tr><tr><td>Llama-2-7b</td><td>99.5</td><td>0.009</td><td>8.81</td><td>9.18</td><td>+0.37</td></tr><tr><td>Llama-2-13b</td><td>99.8</td><td>0.004</td><td>8.15</td><td>8.45</td><td>+0.30</td></tr></table>",
                                            "type": "table",
                                            "image_path": "5154e574a33e3dc228651e270fad3019f22139bc2396e6d6a77f17e2eabf5001.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        524,
                                        399,
                                        2027,
                                        486.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        524,
                                        486.6666666666667,
                                        2027,
                                        574.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        524,
                                        574.3333333333334,
                                        2027,
                                        662.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0
                },
                {
                    "type": "table",
                    "bbox": [
                        613,
                        770,
                        1938,
                        1205
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                442,
                                705,
                                2102,
                                756
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        443,
                                        696,
                                        2103,
                                        766
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                443,
                                                696,
                                                2103,
                                                766
                                            ],
                                            "score": 0.979,
                                            "content": "Table 7: Latency comparison of LLM (generation) and LLM+ICAE (compression then generation)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 4
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                613,
                                770,
                                1938,
                                1205
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        613,
                                        770,
                                        1938,
                                        1205
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                613,
                                                770,
                                                1938,
                                                1205
                                            ],
                                            "score": 0.981,
                                            "html": "<table><tr><td>Input (Batch×Length)</td><td>Method</td><td>Compression Time (Cachable)</td><td>Decoding Time</td><td>Total Time</td></tr><tr><td>8*2048</td><td>LLM4MCAE</td><td>3.4</td><td>240</td><td>7.324.3x)</td></tr><tr><td>8*512</td><td>LLM+MCAE</td><td>0.6</td><td>9.3</td><td>4.3(2.2x)</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>32*512</td><td>LLM+ICAE</td><td>2.6</td><td>24.3</td><td>6.824.6x)</td></tr></table>",
                                            "type": "table",
                                            "image_path": "ef2dc2a48a1b42af256b1bb43b04953a1461d50eae589523cf69a3c3a7e11988.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        613,
                                        770,
                                        1938,
                                        915.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        613,
                                        915.0,
                                        1938,
                                        1060.0
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        613,
                                        1060.0,
                                        1938,
                                        1205.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 5.0
                },
                {
                    "type": "text",
                    "bbox": [
                        448,
                        1252,
                        2108,
                        1439
                    ],
                    "lines": [
                        {
                            "bbox": [
                                439,
                                1250,
                                2112,
                                1308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1250,
                                        971,
                                        1308
                                    ],
                                    "score": 0.973,
                                    "content": "even more significant- around",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        973,
                                        1255,
                                        1066,
                                        1299
                                    ],
                                    "score": 0.51,
                                    "content": "3 . 5 \\times",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1067,
                                        1250,
                                        1722,
                                        1308
                                    ],
                                    "score": 0.978,
                                    "content": "- in compute-intensive scenarios (e.g.,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1723,
                                        1255,
                                        1866,
                                        1299
                                    ],
                                    "score": 0.9,
                                    "content": "8 \\times 2 0 4 8",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1867,
                                        1250,
                                        1941,
                                        1308
                                    ],
                                    "score": 0.999,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1942,
                                        1254,
                                        2086,
                                        1299
                                    ],
                                    "score": 0.88,
                                    "content": "3 2 \\times 5 1 2",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        2088,
                                        1250,
                                        2112,
                                        1308
                                    ],
                                    "score": 0.617,
                                    "content": "）",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                444,
                                1299,
                                2106,
                                1350
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        444,
                                        1299,
                                        2106,
                                        1350
                                    ],
                                    "score": 0.979,
                                    "content": "Given that the compressed memory slots can be cached in advance (for frequently used texts like",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                439,
                                1339,
                                2108,
                                1401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1339,
                                        1693,
                                        1401
                                    ],
                                    "score": 0.986,
                                    "content": " textbooks, government reports or articles of law), ICAE may introduce over",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1695,
                                        1347,
                                        1754,
                                        1389
                                    ],
                                    "score": 0.87,
                                    "content": "7 \\times",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1755,
                                        1339,
                                        2108,
                                        1401
                                    ],
                                    "score": 0.995,
                                    "content": "inference speedup in",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                440,
                                1388,
                                1537,
                                1443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1388,
                                        1537,
                                        1443
                                    ],
                                    "score": 0.988,
                                    "content": "these cases.Details of the profiling are presented in Appendix B.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 9.5
                },
                {
                    "type": "title",
                    "bbox": [
                        447,
                        1474,
                        1260,
                        1522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                440,
                                1470,
                                1261,
                                1524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1470,
                                        1261,
                                        1524
                                    ],
                                    "score": 0.97,
                                    "content": "3.3.3MULTIPLE SPANS OF MEMORY SLOTS",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 12
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        1541,
                        2108,
                        1956
                    ],
                    "lines": [
                        {
                            "bbox": [
                                443,
                                1544,
                                2108,
                                1594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        1544,
                                        2108,
                                        1594
                                    ],
                                    "score": 0.973,
                                    "content": "Thus far,we have mainly discussed a single span of memory slots.In this section,we shall discuss",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                443,
                                1590,
                                2108,
                                1640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        1590,
                                        2108,
                                        1640
                                    ],
                                    "score": 0.969,
                                    "content": "multiple spans of memory slots. As illustrated in Figure 6(Left), we can segment a long context",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                439,
                                1631,
                                2108,
                                1686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1631,
                                        524,
                                        1686
                                    ],
                                    "score": 0.996,
                                    "content": "into",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        525,
                                        1637,
                                        568,
                                        1677
                                    ],
                                    "score": 0.81,
                                    "content": "N",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        569,
                                        1631,
                                        2108,
                                        1686
                                    ],
                                    "score": 0.985,
                                    "content": "chunks,compress them individually,and then concatenate them to represent the original",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                440,
                                1683,
                                2108,
                                1733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1683,
                                        2108,
                                        1733
                                    ],
                                    "score": 0.984,
                                    "content": "long context.However,this did not work initially,because the model had never seen multiple span",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                440,
                                1728,
                                2108,
                                1778
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1728,
                                        2108,
                                        1778
                                    ],
                                    "score": 0.983,
                                    "content": "concatenation patterns during training. Fortunately, we can incorporate a small number of multiple",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                439,
                                1773,
                                2110,
                                1825
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1773,
                                        2110,
                                        1825
                                    ],
                                    "score": 0.981,
                                    "content": "span concatenation samples during training,enabling the model to work with concatenated spans of",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                439,
                                1816,
                                2111,
                                1873
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1816,
                                        2111,
                                        1873
                                    ],
                                    "score": 0.969,
                                    "content": "memory slots,as OpenAI's work (Bavarian et al.,2022)on introducing the “fillin the middle”ability",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                439,
                                1860,
                                2111,
                                1918
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1860,
                                        2111,
                                        1918
                                    ],
                                    "score": 0.978,
                                    "content": "for the GPT.The results in Figure 6(Right) indicate that,using an equivalent length context,ICAE's",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                440,
                                1909,
                                2112,
                                1964
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1909,
                                        1601,
                                        1964
                                    ],
                                    "score": 0.985,
                                    "content": "memory achieves better performance-because memory can represent",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1602,
                                        1911,
                                        1660,
                                        1952
                                    ],
                                    "score": 0.86,
                                    "content": "4 \\times",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1661,
                                        1909,
                                        2112,
                                        1964
                                    ],
                                    "score": 0.978,
                                    "content": "the original contextlength.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        1978,
                        2108,
                        2210
                    ],
                    "lines": [
                        {
                            "bbox": [
                                440,
                                1980,
                                2108,
                                2034
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1980,
                                        2108,
                                        2034
                                    ],
                                    "score": 0.985,
                                    "content": "The ability of ICAE demonstrates great promise to handle long contexts,as it can save a significant",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                443,
                                2025,
                                2108,
                                2079
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2025,
                                        2108,
                                        2079
                                    ],
                                    "score": 0.988,
                                    "content": "amount of GPU memory when addressing long contexts without touching the existing LLM.As",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                440,
                                2071,
                                2112,
                                2124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2071,
                                        2112,
                                        2124
                                    ],
                                    "score": 0.973,
                                    "content": "illustrated in Figure 6(Right),2048-length memory slots can perform on par with 4096-token contexts.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                442,
                                2112,
                                2111,
                                2172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        442,
                                        2112,
                                        2111,
                                        2172
                                    ],
                                    "score": 0.987,
                                    "content": "This means that conditioning on 2048 memory slots instead of the original 4096 context tokens can",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                439,
                                2159,
                                1619,
                                2215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2159,
                                        1619,
                                        2215
                                    ],
                                    "score": 0.97,
                                    "content": "save about 20GB of GPU memory5with minimal quality degradation.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "title",
                    "bbox": [
                        451,
                        2255,
                        883,
                        2308
                    ],
                    "lines": [
                        {
                            "bbox": [
                                438,
                                2250,
                                889,
                                2316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2250,
                                        889,
                                        2316
                                    ],
                                    "score": 0.999,
                                    "content": "4RELATEDWORK",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        2349,
                        2108,
                        2672
                    ],
                    "lines": [
                        {
                            "bbox": [
                                439,
                                2348,
                                2108,
                                2402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2348,
                                        2108,
                                        2402
                                    ],
                                    "score": 0.966,
                                    "content": "Prompt compression and context distillation (Askell et al.,2O21; Snell et al.,2022) are closely related",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                438,
                                2392,
                                2108,
                                2451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2392,
                                        2108,
                                        2451
                                    ],
                                    "score": 0.989,
                                    "content": " areas to this work: Wingate et al. (2O22) proposed a method to learn compact soft prompts to simulate",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                439,
                                2438,
                                2108,
                                2495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2438,
                                        2108,
                                        2495
                                    ],
                                    "score": 0.977,
                                    "content": "the original natural language prompt by optimizing the KL divergence.However, this approach has",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                438,
                                2486,
                                2111,
                                2544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2486,
                                        2111,
                                        2544
                                    ],
                                    "score": 0.993,
                                    "content": "a very high computational cost, as it requires performing back-propagation for each new incoming",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                439,
                                2533,
                                2112,
                                2585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2533,
                                        2112,
                                        2585
                                    ],
                                    "score": 0.993,
                                    "content": "prompt to learn and obtain the compressed prompt, which severely limits its application. Qin &",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                440,
                                2572,
                                2108,
                                2632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2572,
                                        2108,
                                        2632
                                    ],
                                    "score": 0.974,
                                    "content": "Van Durme (2023) propose Neural Agglomerative Embeddings named NUGGET, which encodes",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                440,
                                2623,
                                1629,
                                2679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2623,
                                        1629,
                                        2679
                                    ],
                                    "score": 0.985,
                                    "content": "language into a compact representation for an encoder-decoder model.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 31
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        2695,
                        2106,
                        2879
                    ],
                    "lines": [
                        {
                            "bbox": [
                                438,
                                2685,
                                2111,
                                2754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2685,
                                        2111,
                                        2754
                                    ],
                                    "score": 0.983,
                                    "content": " The most closely related studies to our research are GIST (Mu et al., 2023) and AutoCompressors",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                438,
                                2734,
                                2108,
                                2802
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2734,
                                        2108,
                                        2802
                                    ],
                                    "score": 0.975,
                                    "content": "(Chevalier et al., 2023). GIST achieves prompt compression by fine-tuning an LLM in a similar way",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                440,
                                2785,
                                2107,
                                2843
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2785,
                                        2107,
                                        2843
                                    ],
                                    "score": 0.978,
                                    "content": "to ours. The resulting model can produce gist tokens as the compression of a prompt, which are",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                439,
                                2829,
                                2108,
                                2886
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2829,
                                        2108,
                                        2886
                                    ],
                                    "score": 0.988,
                                    "content": "similar to our memory slots.Nonetheless,this approach is limited to compressing short prompts and",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 36.5
                }
            ],
            "page_idx": 0,
            "page_size": [
                2550,
                3300
            ],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        446,
                        2918,
                        2103,
                        3052
                    ],
                    "lines": [
                        {
                            "bbox": [
                                493,
                                2911,
                                2110,
                                2972
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        493,
                                        2911,
                                        2110,
                                        2972
                                    ],
                                    "score": 0.979,
                                    "content": "5Llama-7b(fp16)requires 24GB GPU memory for 2048 context tokens and 44GB for 4096 during inference",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                446,
                                2962,
                                1237,
                                3007
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        446,
                                        2962,
                                        1237,
                                        3007
                                    ],
                                    "score": 0.993,
                                    "content": "(measured without optimization like flash attention).",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                493,
                                2999,
                                1972,
                                3060
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        493,
                                        2999,
                                        1972,
                                        3060
                                    ],
                                    "score": 0.982,
                                    "content": "6Prompts in Mu et al. (2O23)refer to task instructions before input texts,so they are usually short.",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        449,
                        112,
                        1223,
                        157
                    ],
                    "lines": [
                        {
                            "bbox": [
                                440,
                                108,
                                1228,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        108,
                                        1228,
                                        162
                                    ],
                                    "score": 0.967,
                                    "content": "Published as a conference paper at ICLR 2024",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        1260,
                        3132,
                        1289,
                        3167
                    ],
                    "lines": [
                        {
                            "bbox": [
                                1259,
                                3128,
                                1291,
                                3174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        1259,
                                        3128,
                                        1291,
                                        3174
                                    ],
                                    "score": 0.993,
                                    "content": "8",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        524,
                        399,
                        2027,
                        662
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                567,
                                333,
                                1974,
                                385
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        569,
                                        330,
                                        1976,
                                        390
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                569,
                                                330,
                                                1258,
                                                390
                                            ],
                                            "score": 0.973,
                                            "content": "Table 6: The results of pretrained ICAE (",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                1259,
                                                336,
                                                1434,
                                                380
                                            ],
                                            "score": 0.84,
                                            "content": "5 1 2  1 2 8",
                                            "type": "inline_equation"
                                        },
                                        {
                                            "bbox": [
                                                1436,
                                                330,
                                                1976,
                                                390
                                            ],
                                            "score": 0.977,
                                            "content": "based on different targetLLMs",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                524,
                                399,
                                2027,
                                662
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        524,
                                        399,
                                        2027,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                524,
                                                399,
                                                2027,
                                                662
                                            ],
                                            "score": 0.978,
                                            "html": "<table><tr><td rowspan=\"2\">Target LLM</td><td colspan=\"2\"></td><td colspan=\"2\">PP</td><td></td></tr><tr><td>BLEU()</td><td>Loss</td><td></td><td></td><td>△</td></tr><tr><td>Llama-7b</td><td>99.1</td><td>0.017</td><td>9.01</td><td>9.50</td><td>+0.49</td></tr><tr><td>Llama-2-7b</td><td>99.5</td><td>0.009</td><td>8.81</td><td>9.18</td><td>+0.37</td></tr><tr><td>Llama-2-13b</td><td>99.8</td><td>0.004</td><td>8.15</td><td>8.45</td><td>+0.30</td></tr></table>",
                                            "type": "table",
                                            "image_path": "5154e574a33e3dc228651e270fad3019f22139bc2396e6d6a77f17e2eabf5001.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        524,
                                        399,
                                        2027,
                                        486.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        524,
                                        486.6666666666667,
                                        2027,
                                        574.3333333333334
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        524,
                                        574.3333333333334,
                                        2027,
                                        662.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0
                },
                {
                    "type": "table",
                    "bbox": [
                        613,
                        770,
                        1938,
                        1205
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                442,
                                705,
                                2102,
                                756
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        443,
                                        696,
                                        2103,
                                        766
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                443,
                                                696,
                                                2103,
                                                766
                                            ],
                                            "score": 0.979,
                                            "content": "Table 7: Latency comparison of LLM (generation) and LLM+ICAE (compression then generation)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 4
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                613,
                                770,
                                1938,
                                1205
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        613,
                                        770,
                                        1938,
                                        1205
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                613,
                                                770,
                                                1938,
                                                1205
                                            ],
                                            "score": 0.981,
                                            "html": "<table><tr><td>Input (Batch×Length)</td><td>Method</td><td>Compression Time (Cachable)</td><td>Decoding Time</td><td>Total Time</td></tr><tr><td>8*2048</td><td>LLM4MCAE</td><td>3.4</td><td>240</td><td>7.324.3x)</td></tr><tr><td>8*512</td><td>LLM+MCAE</td><td>0.6</td><td>9.3</td><td>4.3(2.2x)</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>32*512</td><td>LLM+ICAE</td><td>2.6</td><td>24.3</td><td>6.824.6x)</td></tr></table>",
                                            "type": "table",
                                            "image_path": "ef2dc2a48a1b42af256b1bb43b04953a1461d50eae589523cf69a3c3a7e11988.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        613,
                                        770,
                                        1938,
                                        915.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        613,
                                        915.0,
                                        1938,
                                        1060.0
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        613,
                                        1060.0,
                                        1938,
                                        1205.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 5.0
                },
                {
                    "type": "text",
                    "bbox": [
                        448,
                        1252,
                        2108,
                        1439
                    ],
                    "lines": [
                        {
                            "bbox": [
                                439,
                                1250,
                                2112,
                                1308
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1250,
                                        971,
                                        1308
                                    ],
                                    "score": 0.973,
                                    "content": "even more significant- around",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        973,
                                        1255,
                                        1066,
                                        1299
                                    ],
                                    "score": 0.51,
                                    "content": "3 . 5 \\times",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1067,
                                        1250,
                                        1722,
                                        1308
                                    ],
                                    "score": 0.978,
                                    "content": "- in compute-intensive scenarios (e.g.,",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1723,
                                        1255,
                                        1866,
                                        1299
                                    ],
                                    "score": 0.9,
                                    "content": "8 \\times 2 0 4 8",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1867,
                                        1250,
                                        1941,
                                        1308
                                    ],
                                    "score": 0.999,
                                    "content": "and",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1942,
                                        1254,
                                        2086,
                                        1299
                                    ],
                                    "score": 0.88,
                                    "content": "3 2 \\times 5 1 2",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        2088,
                                        1250,
                                        2112,
                                        1308
                                    ],
                                    "score": 0.617,
                                    "content": "）",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                444,
                                1299,
                                2106,
                                1350
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        444,
                                        1299,
                                        2106,
                                        1350
                                    ],
                                    "score": 0.979,
                                    "content": "Given that the compressed memory slots can be cached in advance (for frequently used texts like",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                439,
                                1339,
                                2108,
                                1401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1339,
                                        1693,
                                        1401
                                    ],
                                    "score": 0.986,
                                    "content": " textbooks, government reports or articles of law), ICAE may introduce over",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1695,
                                        1347,
                                        1754,
                                        1389
                                    ],
                                    "score": 0.87,
                                    "content": "7 \\times",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1755,
                                        1339,
                                        2108,
                                        1401
                                    ],
                                    "score": 0.995,
                                    "content": "inference speedup in",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                440,
                                1388,
                                1537,
                                1443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1388,
                                        1537,
                                        1443
                                    ],
                                    "score": 0.988,
                                    "content": "these cases.Details of the profiling are presented in Appendix B.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 9.5,
                    "bbox_fs": [
                        439,
                        1250,
                        2112,
                        1443
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        447,
                        1474,
                        1260,
                        1522
                    ],
                    "lines": [
                        {
                            "bbox": [
                                440,
                                1470,
                                1261,
                                1524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1470,
                                        1261,
                                        1524
                                    ],
                                    "score": 0.97,
                                    "content": "3.3.3MULTIPLE SPANS OF MEMORY SLOTS",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 12
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        1541,
                        2108,
                        1956
                    ],
                    "lines": [
                        {
                            "bbox": [
                                443,
                                1544,
                                2108,
                                1594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        1544,
                                        2108,
                                        1594
                                    ],
                                    "score": 0.973,
                                    "content": "Thus far,we have mainly discussed a single span of memory slots.In this section,we shall discuss",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                443,
                                1590,
                                2108,
                                1640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        1590,
                                        2108,
                                        1640
                                    ],
                                    "score": 0.969,
                                    "content": "multiple spans of memory slots. As illustrated in Figure 6(Left), we can segment a long context",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                439,
                                1631,
                                2108,
                                1686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1631,
                                        524,
                                        1686
                                    ],
                                    "score": 0.996,
                                    "content": "into",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        525,
                                        1637,
                                        568,
                                        1677
                                    ],
                                    "score": 0.81,
                                    "content": "N",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        569,
                                        1631,
                                        2108,
                                        1686
                                    ],
                                    "score": 0.985,
                                    "content": "chunks,compress them individually,and then concatenate them to represent the original",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                440,
                                1683,
                                2108,
                                1733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1683,
                                        2108,
                                        1733
                                    ],
                                    "score": 0.984,
                                    "content": "long context.However,this did not work initially,because the model had never seen multiple span",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                440,
                                1728,
                                2108,
                                1778
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1728,
                                        2108,
                                        1778
                                    ],
                                    "score": 0.983,
                                    "content": "concatenation patterns during training. Fortunately, we can incorporate a small number of multiple",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                439,
                                1773,
                                2110,
                                1825
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1773,
                                        2110,
                                        1825
                                    ],
                                    "score": 0.981,
                                    "content": "span concatenation samples during training,enabling the model to work with concatenated spans of",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                439,
                                1816,
                                2111,
                                1873
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1816,
                                        2111,
                                        1873
                                    ],
                                    "score": 0.969,
                                    "content": "memory slots,as OpenAI's work (Bavarian et al.,2022)on introducing the “fillin the middle”ability",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                439,
                                1860,
                                2111,
                                1918
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        1860,
                                        2111,
                                        1918
                                    ],
                                    "score": 0.978,
                                    "content": "for the GPT.The results in Figure 6(Right) indicate that,using an equivalent length context,ICAE's",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                440,
                                1909,
                                2112,
                                1964
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1909,
                                        1601,
                                        1964
                                    ],
                                    "score": 0.985,
                                    "content": "memory achieves better performance-because memory can represent",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        1602,
                                        1911,
                                        1660,
                                        1952
                                    ],
                                    "score": 0.86,
                                    "content": "4 \\times",
                                    "type": "inline_equation"
                                },
                                {
                                    "bbox": [
                                        1661,
                                        1909,
                                        2112,
                                        1964
                                    ],
                                    "score": 0.978,
                                    "content": "the original contextlength.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 17,
                    "bbox_fs": [
                        439,
                        1544,
                        2112,
                        1964
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        1978,
                        2108,
                        2210
                    ],
                    "lines": [
                        {
                            "bbox": [
                                440,
                                1980,
                                2108,
                                2034
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        1980,
                                        2108,
                                        2034
                                    ],
                                    "score": 0.985,
                                    "content": "The ability of ICAE demonstrates great promise to handle long contexts,as it can save a significant",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                443,
                                2025,
                                2108,
                                2079
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2025,
                                        2108,
                                        2079
                                    ],
                                    "score": 0.988,
                                    "content": "amount of GPU memory when addressing long contexts without touching the existing LLM.As",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                440,
                                2071,
                                2112,
                                2124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2071,
                                        2112,
                                        2124
                                    ],
                                    "score": 0.973,
                                    "content": "illustrated in Figure 6(Right),2048-length memory slots can perform on par with 4096-token contexts.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                442,
                                2112,
                                2111,
                                2172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        442,
                                        2112,
                                        2111,
                                        2172
                                    ],
                                    "score": 0.987,
                                    "content": "This means that conditioning on 2048 memory slots instead of the original 4096 context tokens can",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                439,
                                2159,
                                1619,
                                2215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2159,
                                        1619,
                                        2215
                                    ],
                                    "score": 0.97,
                                    "content": "save about 20GB of GPU memory5with minimal quality degradation.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 24,
                    "bbox_fs": [
                        439,
                        1980,
                        2112,
                        2215
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        451,
                        2255,
                        883,
                        2308
                    ],
                    "lines": [
                        {
                            "bbox": [
                                438,
                                2250,
                                889,
                                2316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2250,
                                        889,
                                        2316
                                    ],
                                    "score": 0.999,
                                    "content": "4RELATEDWORK",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        2349,
                        2108,
                        2672
                    ],
                    "lines": [
                        {
                            "bbox": [
                                439,
                                2348,
                                2108,
                                2402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2348,
                                        2108,
                                        2402
                                    ],
                                    "score": 0.966,
                                    "content": "Prompt compression and context distillation (Askell et al.,2O21; Snell et al.,2022) are closely related",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                438,
                                2392,
                                2108,
                                2451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2392,
                                        2108,
                                        2451
                                    ],
                                    "score": 0.989,
                                    "content": " areas to this work: Wingate et al. (2O22) proposed a method to learn compact soft prompts to simulate",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                439,
                                2438,
                                2108,
                                2495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2438,
                                        2108,
                                        2495
                                    ],
                                    "score": 0.977,
                                    "content": "the original natural language prompt by optimizing the KL divergence.However, this approach has",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                438,
                                2486,
                                2111,
                                2544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2486,
                                        2111,
                                        2544
                                    ],
                                    "score": 0.993,
                                    "content": "a very high computational cost, as it requires performing back-propagation for each new incoming",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                439,
                                2533,
                                2112,
                                2585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2533,
                                        2112,
                                        2585
                                    ],
                                    "score": 0.993,
                                    "content": "prompt to learn and obtain the compressed prompt, which severely limits its application. Qin &",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                440,
                                2572,
                                2108,
                                2632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2572,
                                        2108,
                                        2632
                                    ],
                                    "score": 0.974,
                                    "content": "Van Durme (2023) propose Neural Agglomerative Embeddings named NUGGET, which encodes",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                440,
                                2623,
                                1629,
                                2679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2623,
                                        1629,
                                        2679
                                    ],
                                    "score": 0.985,
                                    "content": "language into a compact representation for an encoder-decoder model.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 31,
                    "bbox_fs": [
                        438,
                        2348,
                        2112,
                        2679
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        447,
                        2695,
                        2106,
                        2879
                    ],
                    "lines": [
                        {
                            "bbox": [
                                438,
                                2685,
                                2111,
                                2754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2685,
                                        2111,
                                        2754
                                    ],
                                    "score": 0.983,
                                    "content": " The most closely related studies to our research are GIST (Mu et al., 2023) and AutoCompressors",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                438,
                                2734,
                                2108,
                                2802
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2734,
                                        2108,
                                        2802
                                    ],
                                    "score": 0.975,
                                    "content": "(Chevalier et al., 2023). GIST achieves prompt compression by fine-tuning an LLM in a similar way",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                440,
                                2785,
                                2107,
                                2843
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        440,
                                        2785,
                                        2107,
                                        2843
                                    ],
                                    "score": 0.978,
                                    "content": "to ours. The resulting model can produce gist tokens as the compression of a prompt, which are",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                439,
                                2829,
                                2108,
                                2886
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        439,
                                        2829,
                                        2108,
                                        2886
                                    ],
                                    "score": 0.988,
                                    "content": "similar to our memory slots.Nonetheless,this approach is limited to compressing short prompts and",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 36.5,
                    "bbox_fs": [
                        438,
                        2685,
                        2111,
                        2886
                    ]
                }
            ]
        }
    ],
    "_backend": "pipeline",
    "_version_name": "2.1.8"
}