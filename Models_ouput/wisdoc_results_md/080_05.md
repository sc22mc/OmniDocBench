Define an automaton P = ({p1, p2, .., p|u|+1}, {0, 1}, γ) where γ is defined as follows: for i ∈ {1, .., |u| + 1} set γ(pi−1, ui) = pi, where ui is i-th letter of a word u. In other words we encode our plaintext in the form of a directed path, where consecutive edges correspond to the consecutive letters of the word u. Encryption consists of four steps: ⋃|u|+1 ⋃|u|+1 ⋃|u|+1 1. Compute B = Ai and denote δi = ρ, P = Qi i=1 i=1 i=1

2. for any transition (pi, pj) in P , labelled with a letter x ∈ {0, 1} choose any j i, pair of states qi ∈ Qi and q ∈ Qj , and set ρ(q x) = qj ,

i, 3. for all i ∈ {1, .., |u|+1} and for every letter a ∈ Σ, if qi ∈ Qi and δ(q a) is i, undefined, then choose any j and any state qj ∈ Qj and set ρ(q a) = qj ,

i i 4. for all i ∈ {1, .., |u| + 1} choose ki ∈ N. Choose ki pairs (q q and a p, r) i letter x ∈ {0, 1} and define ρ(qip, x) = q r

Automaton B is our ciphertext. It is straightforward from the construction, that computing such automaton is polynomial in terms of Q,Σ and length of the plaintext. We also state two obvious observations.

Fact 2. After removing letters x ∈ {0, 1} from automaton B we obtain a DFA over Σ.

Fact 3. After removing letters a ∈ Σ from automaton B we obtain a digraph labelled with letters x ∈ {0, 1} with longest path between the vertices of length 1.

Procedure of encrypting the word 01 is depicted on figures 3, 4, 5 and 6. As a public key we take the automaton depicted on Figure 2.