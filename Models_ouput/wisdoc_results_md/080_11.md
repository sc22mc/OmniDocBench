Lemma 3. Let A = (Q,Σ, δ) be a PFA with carefully synchronizing word w. Further, let q ∈ Q be such that there exists p ∈ Q such that q ∈ p.a−1. Let also A′ = (Q ∪ {q′},Σ, δ′) where δ′ is defined as δ on Q and δ′(q′, a) = q. Then w carefully synchronizes A′.

Proof. Since a is defined for all states of Q′, and |Σ| = 2, then the first letter of w must be a. Let w′ be the word w without the first letter. Since δ′(q′, a) = q and we assumed that there exist p ∈ Q such that q ∈ p.a−1 it is straightforward, that Q′.a = Q.a. Since we have not added any other transitions to A′ and δ′ is defined as δ on Q, we obtain that Q′.aw′ = Q.aw′ = Q.w and that concludes the proof.

For the next lemma we assume notation as in former part of the paper. ⋃k and m ∈

Lemma 4. Let B = N be the smallest integer such that i=1Ak mb Q.am = Q.am+1. Define Bi = Qi.a and let C1 = (S1, {a}, η1), . . . , Cl = (Sl, {a}, ηl) be a-clusters with depth 1 and centers K1, . . . ,Kl respectively. Let ⋃l ′,Σ, B′ = B ∪ Ci = (P ρ′). If we define b transitions for all states q ∈ i=1 ⋃l ′(q, such that there exists 0 < j < k + 1 such that ρ b) ∈ Bj then i=1Ki ′.w k P = {q1l , ..., q }. l

Proof. Since a is the only letter defined for all states in A and Q.am = Q.am+1 m1bw′ then w starts with a word am1b for 0 < m1 < m+1. Note w = a Observe that Q.ai+1 ⊆ Q.ai for all i ≥ 0. From that we have, that Q.am ⊆ Q.am1 and m1 further for all copies of A in B′ we obtain that Bi ∈ Qi.a .b. Also, since the m1 depth of any cluster Ci is 1, we have that Pj .a = Kj for all 0 < j < m + 1. ⋃k ⋃l ′ Notice that P ∪ Si, so i=1Qi i=1

$$
P^{\prime}.w=\bigcup_{i=1}^{k}Q_{i}.w\cup\bigcup_{i=1}^{l}S_{i}.w=\bigcup_{i=1}^{k}Q_{i}.a^{m_{1}}bw^{\prime}\cup\bigcup_{i=1}^{l}S_{i}.a^{m_{1}}bw^{\prime}
$$

which gives

$$
P^{\prime}.w=\bigcup_{i=1}^{k}B_{i}w^{\prime}\cup\bigcup_{i=1}^{l}K_{i}bw^{\prime}.
$$

⋃

But we know, that for all q ∈ there exists 0 < i < k + 1 such that i=1Ki δ′(q, b) ∈ Bi. From that we obtain

$$
P^{\prime}.w=\bigcup_{i=1}^{k}B_{i}w^{\prime},
$$

mb ′ mbw′ i and since each Bi = Qi.a then Bi.w = Qi.a = Qi.w = {q and that l} concludes the proof.

Using these two lemmas we can move on to the description of the extended method of encryption and decryption. In the next two subsections we follow the notation provided in sections 3 and 4.