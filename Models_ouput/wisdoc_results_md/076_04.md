for this purpose was introduced in 2020 with VectorNet [23]. Thus, VectorNet is a solid baseline and ideally suitable for our application. The problem is flipped: In typical motion prediction tasks, AVs predict surrounding objects’ trajectories. In testing, the trajectories of surrounding objects are (partially) known, but the AVs’ behavior has to be predicted.

Scenario embeddings do not cover all properties of in- stantiated scenarios. The relevant properties may have to be determined by feature selection. Remaining properties can be accounted for by probabilistic motion prediction models.

IV. EXPERIMENTS

Below, we describe our investigation aimed at addressing three main questions: Can VectorNet predict Ego trajectories... for individual functional scenarios it is trained on?

• for multiple functional scenarios it is trained on?

• for functional scenarios not seen during training?

•

A. Generation of the Scenario Embeddings and Trajectories

To enable a comparison to regression metamodels, we gen- erate vectorized scenario embeddings for the three scenarios in Fig. 2 parametrically but introduce random variations making the scenarios more complex and realistic (see Fig. 4).

The center of the lanes follows a polynomial of 3rd degree ∈ with where vectors describe the lanes x [−55m, 55m]; ≤24 −55m + 110m24 · i ∀ ∈ (at N ), the of i y-coordinate the lane’s center is shifted uniformly by U(−0.5m, 0.5m). Accordingly, the lane width is 3.5m+U(−0.3m, 0.3m). Ego and Co use a lane keeping controller; the resulting vehicle U(−2.9◦, 2.9◦).

orientations are varied randomly with

The

Co’s velocity follows the description in Fig. 2 and is varied ms ms with U(−0.1 , 0.1 ). Using a P-controller, the Ego tries to ensure a time gap of 2 s to the Co. Concrete scenarios are sampled uniformly from the ranges given in Table I. The time step width is 0.2 s, and the scenarios are simulated for 5 s.

B. Training of the Motion Prediction Model VectorNet

We build upon a publically available implementation of VectorNet [9]. VectorNet is supplied with the lanes, the Co’s trajectory, and the initial vector of the Ego (which holds information about the position, orientation, and velocity). It has to predict all following vectors of the Ego. Available data are split into 90% training and 10% validation data.

Fig. 4. Data of the scenario ACC&LK. Each vector is defined by its start and end points, object type, object ID, and timestamp. The numbers next to the vectors represent their timestamps in seconds; lanes’ timestamps are 0. Note that vectors can contain more features, e.g., bounding boxes or object colors.

C. Evaluation Procedure and Criteria

To answer the research questions, VectorNet is trained with different mixes of the three scenarios’ data. NLK, NACC, and denote the number of samples of the respective NACC&LK scenario VectorNet is supplied with. ADELK, ADEACC, and ADEACC&LK denote the average displacement error (ADE) with respect to the Ego’s trajectory. The ADEs are calculated based on a test set with a size of 10k per functional scenario.

As shown in Fig. 1, we also use VectorNet’s predictions to calculate evaluation metrics and compare these to predictions of regression metamodels, which predict the evaluation metrics based on the respective inputs of the scenarios in Table I.

V. RESULTS

Below, we assess VectorNet’s predictive performance based on the predicted Ego trajectories and evaluation metrics.

A. Assessment Based on Predicted Ego Trajectories

Rows 1 to 3 of Table II indicate that trained with individual functional scenarios’ data, VectorNet achieves good ADEs for the functional scenario it is trained on. Rows 4 to 7 show that combining data from two functional scenarios is possible; however, for LK and ACC&LK, 3k samples are required. Combining data from all three scenarios (row 8), the predictive performance is similar to that of the separately trained models (rows 1 to 3); Fig. 5 visualizes this model’s predictions.

The more challenging task is the generalization to functional scenarios not seen during training. Row 3 shows that trained on ACC&LK, a low ADE for ACC is achieved. This is expected

TABLE I

AVERAGE DISPLACEMENT ERRORS (ADE) OF PRED. EGO TRAJECTORIES

LOGICAL SCENARIOS’ INPUTS AND RANGES TABLE II

\begin{tabular}{|l|c|c|c|l|} \hline {\bf Input} & {\bf Min} & {\bf Max} & {\bf Unit} & {\bf Explanation} \\ \hline $a_0$ & $-1$ & $1$ & - & 0$^\text{th}$ polynomial coefficient \\ \hline $a_1$ & $-0.1$ & $0.1$ & - & 1$^\text{st}$ polynomial coefficient \\ \hline $a_2$ & $-0.01$ & $0.01$ & - & 2$^\text{nd}$ polynomial coefficient \\ \hline $a_3$ & $-0.001$ & $0.001$ & - & 3$^\text{rd}$ polynomial coefficient \\ \hline $v_{\text{Ego}}$ & $8$ & $16$ & $\frac{\text{m}}{\text{s}}$ & Ego's initial velocity \\ \hline $v_{\text{Co}}$ & $-50+v_{\text{Ego}}$ & $-50+2v_{\text{Ego}}$ & $\text{m}$ & Co's initial $x$-coordinate \\ \hline $v_{\text{Co}}$ & $v_{\text{Ego}}-4$ & $v_{\text{Ego}}+4$ & $\frac{\text{m}}{\text{s}}$ & Co's initial velocity \\ \hline $t_{v\ \text{Co}}$ & $0$ & $3$ & $\text{s}$ & duration of constant velocity \\ \hline $a_{\text{Co}}$ & $-8$ & $-1$ & $\frac{\text{m}}{\text{s}^2}$ & Co's acceleration \\ \hline $t_{a\ \text{Co}}$ & $1$ & $3$ & $\text{s}$ & duration of acceleration \\ \hline \end{tabular}

\begin{tabular}{|c|r|r|r||r|r|r|} \hline \textbf{Row} & \textbf{$N_{\rm ACC}$} & \textbf{$N_{\rm LR}$} & \textbf{$N_{\rm ACC\&LK}$} & \textbf{$\bar{\rm ADE}_{\rm ACC}$} & \textbf{$\bar{\rm ADE}_{\rm LR}$} & \textbf{$\bar{\rm ADE}_{\rm ACC\&LK}$} \\ \hline 1 & 2000 & 0 & 0 & ${\bf 0.37\,m}$ & $12.47\, \rm m$ & $8.96\, \rm m$ \\ \hline 2 & 0 & 2000 & 0 & $2.40\, \rm m$ & ${\bf 0.40\,m}$ & $6.48\, \rm m$ \\ \hline 3 & 0 & 0 & 2000 & $0.43\, \rm m$ & $14.86\, \rm m$ & $0.52\, \rm m$ \\ \hline 4 & 2000 & 2000 & 0 & $0.39\, \rm m$ & $0.41\, \rm m$ & $4.69\, \rm m$ \\ \hline 5 & 0 & 2000 & 2000 & $1.58\, \rm m$ & $0.97\, \rm m$ & $1.73\, \rm m$ \\ \hline 6 & 0 & 3000 & 3000 & $0.45\, \rm m$ & $0.46\, \rm m$ & $0.54\, \rm m$ \\ \hline 7 & 2000 & 0 & 2000 & ${\bf 0.37\,m}$ & $9.18\, \rm m$ & ${\bf 0.47\,m}$ \\ \hline 8 & 2000 & 2000 & 2000 & $0.40\, \rm m$ & $0.42\, \rm m$ & $0.60\, \rm m$ \\ \hline 9 & 2000 & 2000 & 200 & $0.41\, \rm m$ & $0.42\, \rm m$ & $0.83\, \rm m$ \\ \hline 10 & 0 & 0 & 200 & $0.88\, \rm m$ & $9.95\, \rm m$ & $1.13\, \rm m$ \\ \hline \end{tabular}