HARKIN et al.: FIELD-TO-FIELD COORDINATE-BASED SEGMENTATION ALGORITHM

(speed = 0) are filtered out. This is a regular occurrence in the baler dataset where the baler stops to: tip wrapped bales; replace used wrap or net; deal with machine blockages, or remove obstacles from the path. Outlier coordinate points can also occur on a GNSS cold start [59]. This scenario could arise if power to the implement (which powered the custom ECU) was disrupted. These are removed if they are not within 800 m of the centroid coordinate of the site (empirically derived from the size of job sites in the baler and mower datasets). Next, the Euclidean distances between consecutive points (ordered by timestamp) are calculated and defined as follows:

$$
|p_{n+1}-p_{n}|\,\forall\,n\in\{0,1,2,\dots,N-1\}
$$

(1)

where N denotes the number of coordinates measured at a site. Consecutive points must be within 10 m of each other. Points measured greater than 10 m from each other are classified as discontinuous; the data are separated into distinct lists at each discontinuity, to be processed separately for plotting. Parti- tioning the site data into separate lists at these discontinuities ensures that trajectory line plots are not drawn across fields. This accounts for gaps in the GNSS data capture and filtering errors that may arise from Stage I.

Each list is interpolated by a factor of two and are plotted as individual lines. Next, we create a filled polygon from each plotted line, using the matplotlib fill polygon function [60]. A filled polygon must be closed, signifying that the polygon edges are connected from beginning to end (i.e., edge lines start at one point, and finish at the same point).

All sites are plotted inside a constant boundary box of 450 by 450 m. These were the largest dimensions observed in the baler and mower datasets. The plot is saved as a. png image with dimensions 857 Ã— 857 pixels. The saved image includes a padding of 22 pixels on either side. Discounting the padding, there are 813 pixels to represent 450 m in each direction. Thus, the pixel per meter resolution is 450/813 = 0.55 m per pixel. 0.55 m per pixel was chosen as the GNSS receiver sampling rate was 1 Hz. This allowed the method to adequately capture the transitions of any vehicle traveling above 2 km/hr.

The result is a filled polygon of the site coordinate data, as illustrated in Fig. 3(a). The white pixels in the image represent field objects. The blackpixels represent the background, nonfield regions. In the following steps, we wish to isolate these field objects from each other by removing the field pathway pixels connecting them.

A scenario where the operator starts a job in one field, and finishes in another field, is shown in Fig. 4. The line segment, necessary to close the filled polygon (from the job end point to the start point) can be observed along the dashed red line illustrated in Fig. 4(a). Consequently, the closing polygon edge is drawn across several fields and the pathways between field objects are obscured. To solve, the coordinate site data are redefined by forcing the end point to be the same as the start point. A solution is obtained by solving for a set of points that provide an end-to-start path from the end to start point; the path is then appended to the original sampled coordinate image plotting data.

Fig. 4. (a) Example job site where PTO activation starts in one field and ends in another field. Thematplotlib fill polygon function will close the filled polygon across the fields, as represented by the Start to End Edge. (b) End to start path is calculated using only existing site coordinates. The path is appended to the sampled coordinate image plotting data. The start and end point are now the same, meaning that the closing polygon edge is not drawn across fields.

The end-to-start point path, as represented by the dashed red line in Fig. 4(b), is calculated by first obtaining the spatial distance matrix; a 2-D array of Euclidian distances between all possible pairwise combinations of job site coordinates. The distance matrix is subsequently used to create an adjacency matrix. Points within a four meter radius of each other are labeled adjacent. The adjacency matrix is converted into a set of nodes, adjacent nodes are connected by edges. A shortest path algorithm, using unweighted graph methods, is applied [61]. The calculated path is then appended to the sampled coordinate image plotting data. The start and end points are now the same, meaning that the closing polygon edge is not drawn across fields.

Once the sampled coordinate image is obtained, it must be further processed to remove holes inside the field objects as shown in Fig. 3(b).

b) Flood Fill: Flood fill [62] is an image processing tool that assigns contiguous pixels with a new value. It can be used as a technique to eliminate holes in binary images. Holes are defined as black, background pixel regions enclosed by white, fore- ground pixel regions (field objects). Holes, as seen in Fig. 3(a), can present in field objects in two ways. Either in the data collection process when the machinery operator must navigate around obstacles in a field, or from the matplotlib fill polygon function. The flood fill operation, as illustrated in Fig. 3(b), is expanded in Fig. 5. It is necessary to fill these holes before solving for field boundaries. Otherwise, holes inside the field objects will be detected as field boundaries.

A designated starting pixel must be defined before starting the flood fill process. Pixel (0, 0) is selected as the starting pixel, its value is denoted by its color (black). The image padding addedwhen creating the sampled coordinate image ensures pixel (0, 0) is part of the image background for every sampled coor- dinate image. All pixels, interconnected with the starting pixel by sharing the same value, are assigned a new value (white). By flooding the interconnected background pixels, this isolates the holes inside field objects.

Fig. 5(a) shows the original image.Note the black holes inside the field objects. The image post flood fill is shown in Fig. 5(b), the only remaining background regions are the field object holes.

97