PNS Convection and NDW r-Processing 5

where 𝜖 represents the energy density of the wind, excluding rest mass. Once the condition in equation (13) is met, the waves will deposit energy into the wind at a rate

$$
\dot{q}_{\scriptscriptstyle W}=\frac{L_{\scriptscriptstyle W}}{4\pi r^{2}\rho l_{d}}=\frac{c_{\scriptscriptstyle S}}{\rho l_{d}}\sigma.
$$

(17)

3.3 Reverse Shock

As the wind expands outward, it will eventually collide with slow- moving material behind the primary supernova shock, causing a reverse shock in the wind (Arcones et al. 2007). The radius at which this happens will depend on the dynamics of the explosion, and we treat it as a free parameter with the value 5 × 108cm. The relativistic Rankine-Hugoniot shock conditions then determine the conditions of the post-shock wind:

$$
\begin{array}{rcl}{{v_{1}\rho_{1}W_{1}}}&{{=}}&{{v_{2}\rho_{2}W_{2}}}\\ {{W_{1}^{2}h_{1}\rho_{1}v_{1}^{2}+P_{1}}}&{{=}}&{{W_{2}^{2}h_{2}\rho_{2}v_{2}^{2}+P_{2}}}\\ {{W_{1}h_{1}}}&{{=}}&{{W_{2}h_{2}}}\end{array}
$$

(18)

with all quantities defined as previously, and the subscripts 1 and 2 denoting pre- and post- shock conditions respectively. We treat the post-shock outflow behavior following Arcones & Thielemann (2012): for the first second post-shock, density is held constant, with velocity dropping as 𝑟2. After the first second, velocity is held con- stant with density dropping as 𝑟2 for the rest of the outflow.

4 COMPUTATIONAL METHOD

In order to circumvent the critical point singularity in equation (3), we introduce a dimensionless integration variable 𝜓 such that

$$
{\frac{d\ln r}{d\theta}}=f_{\mathrm{I}}
$$

$$
{\frac{d\ln v}{d\!\!\!\!\slash}}=f_{2}
$$

$$
{\frac{d\ln T}{d\psi}}={\frac{f_{l}r}{T}}=\left[{\frac{\left({\frac{\partial T}{\partial s}}\right)_{\rho}}{\frac{ds}{dr}}}+{\left({\frac{\partial T}{\partial\rho}}\right)_{s}}{\frac{d\rho}{dr}}\right]
$$

$$
\frac{d\ln{y}}{d\boldsymbol{u}}=f_{1}\xi_{E}
$$

)]

$$
\frac{d\ln S}{d\psi}=-f_{1}r\left[\frac{2}{r}+\frac{1}{l_{d}}+\frac{1}{v+c_{s}}\left(\frac{dv}{dr}+\frac{dc_{s}}{dr}\right)\right]
$$

√︄

$$
{\frac{dI}{d\psi}}={\sqrt{\frac{\omega S}{\rho}}}f_{1}r
$$

(19)

with 𝑓1 and 𝑓2 defined as previously. We recast the entropy evolution into a temperature evolution equation, as our EOS is formulated in √︃ ∫ terms of the Helmholtz free energy. The integral in equation (13) 𝑟 ′.

𝜔𝑆 is converted to a similar form, with 𝐼 = Because our 𝑑𝑟 𝜌

system of equations is relatively stiff, we use an interpolation function between an infinite dissipation length (i.e. no shock heating) and the physical value in equation (16) to control the activation of shock heating in the wind.

The six differential equations in equation (19) are integrated with respect to 𝜓 using a 4th order SDIRKmethod (Kennedy & Carpenter 2016), with the wind dynamics adjusted at the appropriate points for the reverse shock and subsequent outflow. The starting radius is set to be the surface of the neutron star (fixed at 𝑟0 = 1 × 106 cm), and the starting density is set to be the surface density of the neutron star (fixed at 𝜌0 = 1 × 1012 g/cm3). We assume the wind begins in heating-cooling equilibrium,which fixes the starting temperature and electron fraction (see Qian & Woosley 1996). The starting value for the wave action is determined by the wave luminosity per equation (5), which we treat as a fraction of neutrino luminosity and a free parameter. The initial wind velocity is also treated as a free parameter, ¤𝑀NS Λ𝑣0𝜌0. and maps directly to the PNS mass loss rate = 4𝜋𝑟20𝑊𝑒 In order to find the critical (or transonic) solution of the wind equations, 𝑓1 and 𝑓2 must pass through zero at the same radius. We use a shooting method to determine the critical mass loss rate (i.e. 𝑣0) for a given parameter set via a one-dimensional rootfinder. We map a given 𝑣0 to the value of max{ 𝑓1, 0} − max{ 𝑓2, 0} at the minimum radius for which 𝑓1 passes through zero, for the profile that is generated by that specific 𝑣0. The root of this function is the critical velocity, for which 𝑓1 and 𝑓2 pass through zero simultaneously. Once the critical velocity (or mass loss rate) is found, the full integration is run to a maximum radius of 1010 cm. The sensitivity of the evolution equations makes it numerically impossible to actually generate the critical solution, as every solution appears as either a breeze solution or an unphysical one that returns to the initial radius, even when 𝑣0 is obtained to machine precision. To circumnavigate this issue, we assign 𝑓1 and 𝑓2 to their absolute values for the full integration. This produces the correct behavior to machine precision for the transonic solution.

The temperature and density versus time for a Lagrangian observer are then extracted from the resulting steady state wind profile (and extended to late times with a 𝑡−3 power law). These profiles are then used to perform calculations of nucleosynthesis using the nuclear reaction network code SkyNet (Lippuner & Roberts 2017). The re- action network calculations include strong, weak, symmetric fission, and spontaneous fission reactions, with inverse reactions calculated via detailed balance.

The input parameters for our models are the PNS mass (𝑀NS/𝑀 ∈ [1.4, 2.1]), the total neutrino luminosity (𝐿𝜈 ∈

[3 × 1052, 1.2 × 1053] erg s−1), and the wave luminosity as a frac- tion of total neutrino luminosity (𝐿𝑤/𝐿𝜈 ∈ [10−5, 10−2]). We also examine the impact of different wave frequencies in the range of 102 to 104 𝑠−1. We assume that the neutrinos have equal luminosities in all flavors, a zero chemical potential Fermi-Dirac spectrum, and the average electron neutrino energy is fixed at 12 MeV as measured at the surface of the PNS. The average electron antineutrino energy is chosen such that the equilibrium electron fraction of the wind, 𝑌𝑒,eq = 𝜆𝜈𝑒/(𝜆𝜈𝑒 + 𝜆𝜈̄𝑒 ), takes a target value (see Qian & Woosley 1996), where 𝜆𝜈𝑒 and 𝜆𝜈̄𝑒 are the electron neutrino and antineu- trino capture rates, respectively. We primarily consider𝑌𝑒,eq = 0.48, unless otherwise noted. Relativistic corrections are included in the neutrino capture rates as in Thompson et al. (2001).

5 RESULTS 5.1 Models without Wave Heating

In the absence of wave contributions (i.e. 𝐿𝑤 = 0), we find general agreement with prior work regarding the hydrodynamic structure of the wind (e.g. Thompson et al. 2001; Wanajo 2013). These models serve as a baseline for comparison with the wave heating models shown in subsequent sections. Figure 2 shows a set of radial entropy profiles for varied PNS masses with a fixed neutrino luminosity of 6×1051 erg s−1. Increased PNSmass leads to overall higher entropies throughout the wind (Qian & Woosley 1996), which decreases the efficiency of seed formation and brings conditions closer to those

MNRAS 000, 1–14 (2022)