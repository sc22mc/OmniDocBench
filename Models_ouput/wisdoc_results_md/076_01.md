Vectorized Scenario Description and

Motion Prediction for Scenario-Based Testing

1st Max Winkelmann ID

AD Functions & Simulation

IAV GmbH

Berlin, Germany max.winkelmann@iav.de

2nd Constantin Vasconi AD Functions & Simulation

IAV GmbH

Berlin, Germany constantin.vasconi@iav.de

Abstract—Automated vehicles (AVs) are tested in diverse scenarios, typically specified by parameters such as velocities, distances, or curve radii. To describe scenarios uniformly inde- pendent of such parameters, this paper proposes a vectorized scenario description defined by the road geometry and vehicles’ trajectories. Data of this form are generated for three scenarios, merged, and used to train the motion prediction model VectorNet, allowing to predict an AV’s trajectory for unseen scenarios. Pre- dicting scenario evaluation metrics, VectorNet partially achieves lower errors than regression models that separately process the three scenarios’ data. However, for comprehensive generalization, sufficient variance in the training data must be ensured. Thus, contrary to existing methods, our proposed method can merge diverse scenarios’ data and exploit spatial and temporal nuances in the vectorized scenario description. As a result, data from specified test scenarios and real-world scenarios can be compared and combined for (predictive) analyses and scenario selection.

Index Terms—automated driving, motion prediction, safety validation, scenario-based testing, scenario selection

I. INTRODUCTION

Validating the safety of automated vehicles (AVs) is chal- lenging. Their environment’s complex and open nature pre- vents all-encompassing testing of AVs. Due to the rare nature of accidents, statistical safety validation based on representa- tive routes of human drivers is not possible either [1]. Thus, AVs’ validation requires targeted testing to uncover problems effectively and determine residual risks precisely [2], [3].

Which scenarios are risky differs from AV to AV, de- pending on the hardware and software. Thus, search-based techniques systematically vary scenarios and provoke criti- cal behaviors [4]. Here, scenario-based testing provides the framework for variation [5]. First, a functional scenario is described in natural language, e.g., “The AV (Ego) follows a curved road.”. An associated logical scenario specifies open parameters and their ranges, e.g., vEgo ∈ [8 ms , 16 ms ]. Finally, concrete scenarios, e.g., vEgo = 9 ms , are parameterized within the logical scenario. Here, data of executed concrete scenarios are used to perform predictive analyses for further concrete scenarios and select relevant concrete scenarios for execution.

However, the description of scenarios by parameters has limitations. Conventional techniques for predictive analyses cannot be used across logical and functional scenarios as

This work was supported in part by IAV GmbH, 10587 Berlin, Germany.

3rd Steffen Müller

Department of Automotive Engineering Technische Universität Berlin

Berlin, Germany steffen.mueller@tu-berlin.de

their parameters vary considerably. Thus, the search for rel- evant concrete scenarios starts anew for each functional and logical scenario. Furthermore, real-world scenarios may only be described inadequately by parameters since, e.g., the road geometry can be arbitrarily complex [6]–[8]. Thus, it is unclear what behavior to expect in real-world tests, and the comparison of AVs’ behavior in tests and real-world scenarios is restricted.

This paper explores how a uniform scenario description and predictive analyses across logical, functional, and real-world scenarios can be achieved. Motion prediction techniques are examined as possible solutions. Our main contributions are:

• A vectorized scenario description suitable for diverse and complex concrete scenarios and (predictive) analyses.

• The integration of motion prediction into scenario- based testing, enabling comprehensive predictive analyses across functional, logical, and real-world scenarios.

• The implementation and investigation of our approach using the motion prediction model VectorNet [9].

II. RELATED WORK

Below, we discuss the essential artifacts in scenario-based testing and assess their suitability as a basis for predictive analyses. The lower part of Fig. 1 illustrates these artifacts.

A. From Functional Scenarios to Concrete Scenarios

Functional scenarios are described in natural language [5] and can be supported by sketches [10]. Thus, functional scenarios are human-readable, but their representation and abstraction limit their suitability as a data basis for predictive analyses. Similar limitations apply to abstract scenarios [10], which we do not discuss further due to their low prevalence.

Logical scenarios complement functional scenarios with NI influencing parameters [5], which we denote by inputs ∈ RNI . Furthermore, lower and upper bounds of or the distribution p(x) are determined. For a specific functional scenario, different logical scenarios can exist if influences are modeled differently in different test setups or are not controllable. E.g., fog may be modeled by noise in a 2D simulation, rendered in a 3D simulation, or real but not controllable in a field test. Due to their open nature, logical scenarios cannot be directly processed but they provide the structure for predictive analyses and search-based techniques.

arXiv:2302.01161v1 [cs.LG] 2 Feb 2023