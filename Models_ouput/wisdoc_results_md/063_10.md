LIANG-CHUNG HSIA, HUA-CHIEH LI, ANDWEI-LIANG SUN

Lemma 3.2. Let n ∈ N and m ∈ Z. Then

$$
c_{n}(\boldsymbol{m})=\boldsymbol{\mu}\,\left(\frac{\boldsymbol{n}}{(\boldsymbol{n,m})}\right)\frac{\boldsymbol{\phi}(\boldsymbol{n})}{\boldsymbol{\phi}\left(\frac{\boldsymbol{n}}{(\boldsymbol{n,m})}\right)}.
$$

Proof. First of all, suppose that m= 1. Recall an elementary formula that

$$
\sum_{kr}\boldsymbol{\mu}(k)=\left\{\begin{array}{ll}{1}&{\textrm{if}\,r=1;}\\ {0}&{\textrm{if}\,r>0,}\end{array}\right.
$$

for r ∈ N ([Bur11, Theorem 6.6]). Then

$$
c_{n}(1)=\sum_{l=1}^{n}\pmb{\zeta}_{n}^{l}\sum_{k|(t,n)}\pmb{\mu}(k)=\sum_{k|n}\pmb{\mu}(k)\sum_{\underset{1\leq t^{\prime}\leq n,}{1\leq t\leq n}}\pmb{\zeta}_{n}^{t}=\sum_{k|n}\pmb{\mu}(k)\sum_{\underset{1\leq t^{\prime}\leq\frac{n}{k}}{1\leq t^{\prime}\leq\frac{n}{k}}}(\pmb{\zeta}_{n}^{k})^{t^{\prime}}
$$

′ kn where t . Since ζ is a primitive -th root of 1, the last sum gives 1 if k = n and 0 if k < n. Hence, cn(1) = µ(n).

For general m ∈ Z, we rewrite cn(m) as

$$
\boldsymbol{c}_{n}(\boldsymbol{m})=\sum_{\textit{t}\in(\mathbb{Z}/\textit{n}\mathbb{Z})^{\times}}\mathcal{Z}^{t}
$$

× where z = ζmn . Let d = . Recall that (Z/nZ) =M ·N where M and N are given in (n,m) m(n,m) = 1. Hence, Lemma 3.1. Note that z= ζmn is a primitive d-th root of 1 since

$$
c_{n}(\boldsymbol{m})=\sum_{I_{1}\in\boldsymbol{M}}\sum_{t_{2}\in\mathcal{N}}\vec{z}^{I_{1}t_{2}}=\sum_{I_{1}\in\boldsymbol{M}}|N|\vec{z}^{I_{1}}=|\mathcal{N}|c_{d}(1).
$$

ϕ(n) Now, the result follows from |N|= and cd(1) = µ(d) by the first paragraph. ϕ(d)

Note that (n,m) = (n,(n,m)). Thus, we have the following immediate consequence. Corollary 3.3. Let n ∈ N and m ∈ Z. Then cn(m) = cn((n,m)).

As a consequence, we note that if m′ is an integer such that m′ ≡ m (mod n), then we ′) conclude from Corollary 3.3 that cn(m = cn(m).

The following decomposition of a Cartesian product is useful for counting pairs of integers. Roughly speaking, the product below is partitioned by parallel lines on Z×Z.

Lemma 3.4. Let n ∈ N and let I = {1,2, . . . ,n−1}. For every a,b ∈ Z, we have ⊎ ⊎

$$
I\times I=\biguplus_{d\mid n}\biguplus_{\stackrel{1\leq t\leq\frac{n}{d}}{(t,\frac{n}{d})=1}}\{(x,y)\in I\times I\mid ax\!+\!by\equiv td\pmod{n}\}.
$$