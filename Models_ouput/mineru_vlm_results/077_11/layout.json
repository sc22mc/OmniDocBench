{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        229,
                        273,
                        951,
                        330
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                229,
                                273,
                                951,
                                330
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        229,
                                        273,
                                        951,
                                        330
                                    ],
                                    "type": "text",
                                    "content": "A. Symmetries of the architecture"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        226,
                        359,
                        734,
                        412
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                226,
                                359,
                                734,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        226,
                                        359,
                                        734,
                                        412
                                    ],
                                    "type": "text",
                                    "content": "A.1. Proof of Proposition 4.1"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        224,
                        438,
                        2264,
                        541
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                224,
                                438,
                                2264,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        224,
                                        438,
                                        2264,
                                        541
                                    ],
                                    "type": "text",
                                    "content": "In this appendix we provide more details on the equivariance of the Timewarp architecture. We first prove Proposition 4.1 from the main body:"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        221,
                        587,
                        2264,
                        792
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                221,
                                587,
                                2264,
                                792
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": "Proof. Let "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "X(t + \\tau)_{x(t)}"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " denote the random variable obtained by sampling "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "Z\\sim p(z)"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " and computing "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "X(t + \\tau)\\coloneqq f(Z;x(t))"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " Here we subscript "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "X(t + \\tau)_{x(t)}"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " by "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "x(t)"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " to emphasize that this is the random variable obtained when conditioning the flow on "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "x(t)"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " . We first note that the equivariance condition on the densities "
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "inline_equation",
                                    "content": "p(\\sigma x(t + \\tau)|\\sigma x(t)) = p(x(t + \\tau)|x(t))"
                                },
                                {
                                    "bbox": [
                                        221,
                                        587,
                                        2264,
                                        792
                                    ],
                                    "type": "text",
                                    "content": " is equivalent to the following constraint on the random variables:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        961,
                        805,
                        2254,
                        877
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                961,
                                805,
                                2254,
                                877
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        961,
                                        805,
                                        2254,
                                        877
                                    ],
                                    "type": "interline_equation",
                                    "content": "X(t + \\tau)_{\\sigma x(t)}\\overset {d}{=}\\sigma X(t + \\tau)_{x(t)}, \\tag{20}",
                                    "image_path": "cb9e64747c8fcf47c8daf8f68f840d74299ed773de1d1ec1a7adef30b33cdd59.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        226,
                        907,
                        2274,
                        1009
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                226,
                                907,
                                2274,
                                1009
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\stackrel {d}{=}"
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "text",
                                    "content": " denotes equality in distribution. To see this, let "
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "inline_equation",
                                    "content": "p_{X}"
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "text",
                                    "content": " denote the density of the random variable "
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "inline_equation",
                                    "content": "X"
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "text",
                                    "content": " . Then, in terms of densities, Equation (20) is equivalent to stating that, for all "
                                },
                                {
                                    "bbox": [
                                        226,
                                        907,
                                        2274,
                                        1009
                                    ],
                                    "type": "inline_equation",
                                    "content": "x"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        907,
                        1019,
                        2254,
                        1164
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                907,
                                1019,
                                2254,
                                1164
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        907,
                                        1019,
                                        2254,
                                        1164
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & p_{X(t + \\tau)_{\\sigma x(t)}}(x) = p_{X(t + \\tau)_{x(t)}}(x)\\\\ & \\qquad = p_{X(t + \\tau)_{x(t)}}(\\sigma^{-1}x), \\end{array} \\tag{22}",
                                    "image_path": "b49411807c9467ee51eb4ff5914c2b453092e2630e3b6572a745ed7e50658a8a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        234,
                        1171,
                        2264,
                        1273
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                234,
                                1171,
                                2264,
                                1273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        234,
                                        1171,
                                        2264,
                                        1273
                                    ],
                                    "type": "text",
                                    "content": "where in Equation (22) we used the change- of- variables formula, along with the fact that the group actions we consider (rotations, translations, permutations) have unit absolute Jacobian determinant. Redefining "
                                },
                                {
                                    "bbox": [
                                        234,
                                        1171,
                                        2264,
                                        1273
                                    ],
                                    "type": "inline_equation",
                                    "content": "x\\gets \\sigma x"
                                },
                                {
                                    "bbox": [
                                        234,
                                        1171,
                                        2264,
                                        1273
                                    ],
                                    "type": "text",
                                    "content": " , we get that for all "
                                },
                                {
                                    "bbox": [
                                        234,
                                        1171,
                                        2264,
                                        1273
                                    ],
                                    "type": "inline_equation",
                                    "content": "x"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        933,
                        1283,
                        2254,
                        1353
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                933,
                                1283,
                                2254,
                                1353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        933,
                                        1283,
                                        2254,
                                        1353
                                    ],
                                    "type": "interline_equation",
                                    "content": "p_{X(t + \\tau)_{\\sigma x(t)}}(\\sigma x) = p_{X(t + \\tau)_{x(t)}}(x). \\tag{23}",
                                    "image_path": "aa8b5498dfbfda38f18ae7239296d14ff4f1251c5100056f7d9113e60b9f9545.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        234,
                        1362,
                        2269,
                        1461
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                234,
                                1362,
                                2269,
                                1461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        234,
                                        1362,
                                        2269,
                                        1461
                                    ],
                                    "type": "text",
                                    "content": "Recalling the notation that "
                                },
                                {
                                    "bbox": [
                                        234,
                                        1362,
                                        2269,
                                        1461
                                    ],
                                    "type": "inline_equation",
                                    "content": "X(t + \\tau)_{x(t)}"
                                },
                                {
                                    "bbox": [
                                        234,
                                        1362,
                                        2269,
                                        1461
                                    ],
                                    "type": "text",
                                    "content": " is interpreted as the random variable obtained by conditioning the flow on "
                                },
                                {
                                    "bbox": [
                                        234,
                                        1362,
                                        2269,
                                        1461
                                    ],
                                    "type": "inline_equation",
                                    "content": "x(t)"
                                },
                                {
                                    "bbox": [
                                        234,
                                        1362,
                                        2269,
                                        1461
                                    ],
                                    "type": "text",
                                    "content": " , this can be written as"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        1020,
                        1478,
                        2254,
                        1534
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                1020,
                                1478,
                                2254,
                                1534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        1020,
                                        1478,
                                        2254,
                                        1534
                                    ],
                                    "type": "interline_equation",
                                    "content": "p(\\sigma x|\\sigma x(t)) = p(x|x(t)) \\tag{24}",
                                    "image_path": "03df694540c9a1a274730117de305659281df444dfc3be5c5372d88900837ca3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        234,
                        1554,
                        2277,
                        1656
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                234,
                                1554,
                                2277,
                                1656
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        234,
                                        1554,
                                        2277,
                                        1656
                                    ],
                                    "type": "text",
                                    "content": "which is exactly the equivariance condition stated in terms of densities above. Having rephrased the equivariance condition in terms of random variables in Equation (20), the proof of Proposition 4.1 is straightforward"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        956,
                        1663,
                        2254,
                        1937
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                956,
                                1663,
                                2254,
                                1937
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        956,
                                        1663,
                                        2254,
                                        1937
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & X(t + \\tau)_{\\sigma x(t)}\\coloneqq f(Z,\\sigma x(t))\\\\ & \\qquad \\stackrel {d}{=}f(\\sigma Z,\\sigma x(t))\\\\ & \\qquad = \\sigma f(Z,x(t))\\\\ & \\qquad \\coloneqq \\sigma X(t + \\tau)_{x(t)}, \\end{array} \\tag{25}",
                                    "image_path": "c87c69fc66fd3fcbd994da9e6893f09ff77305e760c5ac440d2da31f6f2b188d.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        224,
                        1950,
                        1639,
                        2003
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                224,
                                1950,
                                1639,
                                2003
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        224,
                                        1950,
                                        1639,
                                        2003
                                    ],
                                    "type": "text",
                                    "content": "where in Equation (26) we used the fact that the base distribution "
                                },
                                {
                                    "bbox": [
                                        224,
                                        1950,
                                        1639,
                                        2003
                                    ],
                                    "type": "inline_equation",
                                    "content": "p(z)"
                                },
                                {
                                    "bbox": [
                                        224,
                                        1950,
                                        1639,
                                        2003
                                    ],
                                    "type": "text",
                                    "content": " is "
                                },
                                {
                                    "bbox": [
                                        224,
                                        1950,
                                        1639,
                                        2003
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma"
                                },
                                {
                                    "bbox": [
                                        224,
                                        1950,
                                        1639,
                                        2003
                                    ],
                                    "type": "text",
                                    "content": " - invariant."
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        226,
                        2052,
                        1119,
                        2105
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                226,
                                2052,
                                1119,
                                2105
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        226,
                                        2052,
                                        1119,
                                        2105
                                    ],
                                    "type": "text",
                                    "content": "A.2. Translation equivariance via canonicalisation"
                                }
                            ]
                        }
                    ],
                    "index": 14,
                    "level": 1
                },
                {
                    "bbox": [
                        224,
                        2131,
                        2269,
                        2283
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                224,
                                2131,
                                2269,
                                2283
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        224,
                                        2131,
                                        2269,
                                        2283
                                    ],
                                    "type": "text",
                                    "content": "We now describe the canonicalisation technique used to make our models translation equivariant. Let "
                                },
                                {
                                    "bbox": [
                                        224,
                                        2131,
                                        2269,
                                        2283
                                    ],
                                    "type": "inline_equation",
                                    "content": "q(x^{p}(t + \\tau),x^{v}(t+"
                                },
                                {
                                    "bbox": [
                                        224,
                                        2131,
                                        2269,
                                        2283
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau)|x^{p}(t))"
                                },
                                {
                                    "bbox": [
                                        224,
                                        2131,
                                        2269,
                                        2283
                                    ],
                                    "type": "text",
                                    "content": " be an arbitrary conditional density model, which is not necessarily translation equivariant. We can make it translation equivariant in the following way. Let "
                                },
                                {
                                    "bbox": [
                                        224,
                                        2131,
                                        2269,
                                        2283
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\overline{x^p}"
                                },
                                {
                                    "bbox": [
                                        224,
                                        2131,
                                        2269,
                                        2283
                                    ],
                                    "type": "text",
                                    "content": " denote the average position of the atoms,"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        1088,
                        2293,
                        2254,
                        2435
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                1088,
                                2293,
                                2254,
                                2435
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        1088,
                                        2293,
                                        2254,
                                        2435
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\overline{x^p} \\coloneqq \\frac{1}{N}\\sum_{i = 1}^{N}x_i^p. \\tag{29}",
                                    "image_path": "18a68ba58fef6faea65d3ce0cfda71d703e1ca8ca04db70018da03a42cbe9bf7.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        226,
                        2448,
                        479,
                        2501
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                226,
                                2448,
                                479,
                                2501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        226,
                                        2448,
                                        479,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": "Then we define"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        553,
                        2508,
                        2254,
                        2570
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                553,
                                2508,
                                2254,
                                2570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        553,
                                        2508,
                                        2254,
                                        2570
                                    ],
                                    "type": "interline_equation",
                                    "content": "p(x^p (t + \\tau),x^v (t + \\tau)|x^p (t))\\coloneqq q(x^p (t + \\tau) - \\overline{x^p(t)},x^v (t + \\tau)|x^p (t) - \\overline{x^p(t)}) \\tag{30}",
                                    "image_path": "4f0c9861815324ea057fad60eaf5455c0283d1f810fc133e5876267bf618884c.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        234,
                        2597,
                        2266,
                        2699
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                234,
                                2597,
                                2266,
                                2699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "text",
                                    "content": "where the subtraction of "
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\overline{x^p(t)}"
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "text",
                                    "content": " is broadcasted over all atoms. We now consider the effect of translating both "
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "inline_equation",
                                    "content": "x^{p}(t)"
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "inline_equation",
                                    "content": "x^{p}(t + \\tau)"
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "text",
                                    "content": " by the same amount. Let "
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "text",
                                    "content": " be a translation vector in "
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbb{R}^3"
                                },
                                {
                                    "bbox": [
                                        234,
                                        2597,
                                        2266,
                                        2699
                                    ],
                                    "type": "text",
                                    "content": " . Then"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        298,
                        2706,
                        2254,
                        2983
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                298,
                                2706,
                                2254,
                                2983
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        2706,
                                        2254,
                                        2983
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & {p(x^{p}(t + \\tau) + a,x^{v}(t + \\tau)|x^{p}(t) + a) = q(x^{p}(t + \\tau) + a - (\\overline{x^{p}(t) + a}),x^{v}(t + \\tau)|x^{p}(t) + a - (\\overline{x^{p}(t) + a})}\\\\ & {\\qquad = q(x^{p}(t + \\tau) + a - \\overline{x^{p}(t)} -a,x^{v}(t + \\tau)|x^{p}(t) + a - \\overline{x^{p}(t)} -a)}\\\\ & {\\qquad = q(x^{p}(t + \\tau) - \\overline{x^{p}(t)},x^{v}(t + \\tau)|x^{p}(t) - \\overline{x^{p}(t)})}\\\\ & {\\qquad = p(x^{p}(t + \\tau),x^{v}(t + \\tau)|x^{p}(t)).} \\end{array} \\tag{34}",
                                    "image_path": "86b5f8729e13fb8fb50e5c19af07d028007029a768cb88330787bd62f0ddc173.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 20
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                2550,
                3300
            ],
            "page_idx": 0
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.1.9"
}