{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        448,
                        339,
                        1142,
                        392
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                448,
                                339,
                                1142,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        448,
                                        339,
                                        1142,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "2 IN-CONTEXT AUTOENCODER"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        446,
                        422,
                        981,
                        468
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                446,
                                422,
                                981,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        446,
                                        422,
                                        981,
                                        468
                                    ],
                                    "type": "text",
                                    "content": "2.1 MODEL ARCHITECTURE"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        443,
                        495,
                        2106,
                        636
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                495,
                                2106,
                                636
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        495,
                                        2106,
                                        636
                                    ],
                                    "type": "text",
                                    "content": "Like a typical autoencoder (Kramer, 1991), ICAE consists of an encoder and a decoder. Similar to the design of Gisting (Mu et al., 2023) and AutoCompressor (Chevalier et al., 2023), the ICAE performs both the encoding and decoding processes in an in- context manner, as illustrated in Figure 3."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "image",
                    "bbox": [
                        561,
                        656,
                        1983,
                        1379
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                561,
                                656,
                                1983,
                                1379
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        561,
                                        656,
                                        1983,
                                        1379
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                561,
                                                656,
                                                1983,
                                                1379
                                            ],
                                            "type": "image",
                                            "image_path": "9a24c1b7c22515274d75122bdb93bddb5d07043e72d89ad945888c182569ee7a.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                441,
                                1412,
                                2106,
                                1692
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        441,
                                        1412,
                                        2106,
                                        1692
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "text",
                                            "content": "Figure 3: The encoder of the ICAE is a LoRA-adapted LLM, which is used for encoding the original context "
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "inline_equation",
                                            "content": "c = (w_{1},w_{2},\\ldots ,w_{L})"
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "text",
                                            "content": " into a few memory slots "
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "inline_equation",
                                            "content": "(\\widetilde{m_1},\\ldots ,\\widetilde{m_k})"
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "text",
                                            "content": ". The decoder of the ICAE is the target LLM itself that can condition on the memory slots produced by the encoder for various purposes (e.g., the autoencoding task as in this figure). "
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "inline_equation",
                                            "content": "e(\\cdot)"
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "text",
                                            "content": " denotes the word embedding lookup in the target LLM and "
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "inline_equation",
                                            "content": "e_{m}(\\cdot)"
                                        },
                                        {
                                            "bbox": [
                                                441,
                                                1412,
                                                2106,
                                                1692
                                            ],
                                            "type": "text",
                                            "content": " denotes the learnable embedding lookup of memory tokens that are used for producing memory slots. [AE]' is a special token to indicate the autoencoding pretraining task."
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "type": "image_caption"
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        443,
                        1712,
                        2106,
                        1950
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                1712,
                                2106,
                                1950
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": "Given the intuition, we propose to use a LoRA- adapted LLM as the encoder of the ICAE, as illustrated in Figure 3. When encoding a context "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "c = (w_{1},\\ldots ,w_{L})"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": " with the length "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "L"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": ", we first append "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "(k< < L)"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": " memory tokens "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "(m_{1},\\ldots ,m_{k})"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": " to the context "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "c"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": " to obtain their outputs "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\widetilde{m_1},\\ldots ,\\widetilde{m_k})"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": " as the memory slots for the context "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "inline_equation",
                                    "content": "c"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1712,
                                        2106,
                                        1950
                                    ],
                                    "type": "text",
                                    "content": ". Therefore, the ICAE encoder is very lightweight - it only adds a LoRA adapter and an embedding lookup for memory tokens compared with the target LLM."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        443,
                        1966,
                        2106,
                        2108
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                1966,
                                2106,
                                2108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        1966,
                                        2106,
                                        2108
                                    ],
                                    "type": "text",
                                    "content": "As introduced above, we expect the memory slots "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1966,
                                        2106,
                                        2108
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\widetilde{m_1},\\ldots ,\\widetilde{m_k})"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1966,
                                        2106,
                                        2108
                                    ],
                                    "type": "text",
                                    "content": " to be conditioned on by the target LLM on behalf of the original context "
                                },
                                {
                                    "bbox": [
                                        443,
                                        1966,
                                        2106,
                                        2108
                                    ],
                                    "type": "inline_equation",
                                    "content": "c"
                                },
                                {
                                    "bbox": [
                                        443,
                                        1966,
                                        2106,
                                        2108
                                    ],
                                    "type": "text",
                                    "content": ". Therefore, we use the untouched target LLM as the decoder of the ICAE to ensure the compatibility of memory slots within the target LLM."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        443,
                        2161,
                        800,
                        2207
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                2161,
                                800,
                                2207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2161,
                                        800,
                                        2207
                                    ],
                                    "type": "text",
                                    "content": "2.2 PRETRAINING"
                                }
                            ]
                        }
                    ],
                    "index": 7,
                    "level": 1
                },
                {
                    "bbox": [
                        443,
                        2230,
                        879,
                        2277
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                2230,
                                879,
                                2277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2230,
                                        879,
                                        2277
                                    ],
                                    "type": "text",
                                    "content": "2.2.1 AUTOENCODING"
                                }
                            ]
                        }
                    ],
                    "index": 8,
                    "level": 1
                },
                {
                    "bbox": [
                        438,
                        2296,
                        2103,
                        2395
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                438,
                                2296,
                                2103,
                                2395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "text",
                                    "content": "Like a typical autoencoder, one of the ICAE's pretraining objectives is to restore the original input text "
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "inline_equation",
                                    "content": "c"
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "text",
                                    "content": " of the length "
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "inline_equation",
                                    "content": "L"
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "text",
                                    "content": " from its produced memory slots "
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\widetilde{m_1},\\ldots ,\\widetilde{m_k})"
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "text",
                                    "content": " of the length "
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        438,
                                        2296,
                                        2103,
                                        2395
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        535,
                        2402,
                        2004,
                        2475
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                535,
                                2402,
                                2004,
                                2475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        535,
                                        2402,
                                        2004,
                                        2475
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathcal{L}_{\\mathrm{AE}} = \\max_{\\widetilde{m_1},\\ldots ,\\widetilde{m_k}}P(c|\\widetilde{m_1},\\ldots ,\\widetilde{m_k};\\Theta_{LLM}) = \\max_{\\Theta_{LoRA},e_m}P(c|m_1\\ldots m_k;\\Theta_{LLM},\\Theta_{LoRA},e_m)",
                                    "image_path": "b9b3182bb480aca9eba4d9b8637f80bccb3d0c90f849f0fd69091c926c175da8.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        443,
                        2478,
                        2106,
                        2616
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                2478,
                                2106,
                                2616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2478,
                                        2106,
                                        2616
                                    ],
                                    "type": "text",
                                    "content": "To indicate the autoencoding task, we append a special token [AE]' to "
                                },
                                {
                                    "bbox": [
                                        443,
                                        2478,
                                        2106,
                                        2616
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\widetilde{m_1},\\ldots ,\\widetilde{m_k})"
                                },
                                {
                                    "bbox": [
                                        443,
                                        2478,
                                        2106,
                                        2616
                                    ],
                                    "type": "text",
                                    "content": " in the decoder, as Figure 3 shows. As this pretraining objective does not need any extra annotation, we can use massive text data to train the In- context Autoencoder."
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        443,
                        2666,
                        974,
                        2712
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                2666,
                                974,
                                2712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2666,
                                        974,
                                        2712
                                    ],
                                    "type": "text",
                                    "content": "2.2.2 TEXT CONTINUATION"
                                }
                            ]
                        }
                    ],
                    "index": 12,
                    "level": 1
                },
                {
                    "bbox": [
                        441,
                        2745,
                        2108,
                        2976
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                441,
                                2745,
                                2108,
                                2976
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        441,
                                        2745,
                                        2108,
                                        2976
                                    ],
                                    "type": "text",
                                    "content": "While autoencoding pretraining offers a straightforward learning objective to encode a context, its inherent simplicity and exclusive focus on the single objective may lead to suboptimal generalization. To address this issue, we incorporate an additional objective during the pretraining phase: text continuation, as illustrated in Figure 7 in Appendix A. This self- supervised task is widely acknowledged to facilitate the learning of more generalizable representations in language models:"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        532,
                        2986,
                        2009,
                        3062
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                532,
                                2986,
                                2009,
                                3062
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        532,
                                        2986,
                                        2009,
                                        3062
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathcal{L}_{\\mathrm{LM}} = \\max_{\\widetilde{m_1},\\ldots ,\\widetilde{m_k}}P(\\pmb {o}|\\widetilde{m_1},\\ldots ,\\widetilde{m_k};\\Theta_{LLM}) = \\max_{\\Theta_{LoRA},e_m}P(\\pmb {o}|m_1\\ldots m_k;\\Theta_{LLM},\\Theta_{LoRA},e_m)",
                                    "image_path": "7dc36eb880e282d6e1ee69fbb9f32177fe4ecffd078983099922188db1d97be3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 14
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                2550,
                3300
            ],
            "page_idx": 0
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.1.9"
}