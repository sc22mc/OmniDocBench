{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        453,
                        396,
                        2106,
                        1379
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                453,
                                396,
                                2106,
                                1379
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        453,
                                        396,
                                        2106,
                                        1379
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                453,
                                                396,
                                                2106,
                                                1379
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Origin Context</td><td>Restoration</td></tr><tr><td>Large pretrained language models have shown surprising In-Context Learning (ICL) ability. With a few demonstration input-label pairs, they can predict the label for an unseen input without additional parameter updates. Despite the great success in performance, the working mechanism of ICL still remains an open problem. In order to better understand how ICL works, this paper explains language models as meta-optimizers and understands ICL as a kind of implicit finetuning. Theoretically, we figure out that the Transformer attention has a dual form of gradient descent based optimization. On top of it, we understand ICL as follows: GPT first produces metagradients according to the demonstration examples, and then these meta-gradients are applied to the original GPT to build an ICL model. Experimentally, we comprehensively compare the behavior of ICL and explicit finetuning based on real tasks to provide empirical evidence that supports our understanding. The results prove that ICL has supports our to explicit finetuning at the prediction level, the representation level, and the attention behavior level. Further, inspired by our understanding of meta-optimization, we design a momentum-based attention by analogy with the momentum-based gradient descent algorithm. Its consistently better performance over vanilla attention supports our understanding again from another aspect, and more importantly, it shows the potential to utilize our understanding for future model designing.</td><td>Large pretrained models have shown surprising In-Context Learning (ICL) ability. With a few demonstration input-label pairs, they can predict the label for an unseen input without additional parameter updates. Despite the great success in performance, the working mechanism of ICL still remains an open problem. In order to better understand how ICL works, this paper explains how language models as meta-optimizers and understands ICL as a kind of implicit finetuning. Theoretically, we figure out that the Transformer attention has a dual form of gradient descent based on optimization. On top of it, we understand ICL as follows: GPT first produces metagradients according to the demonstration examples, and then these meta-gradients are applied to the original GPT to build an ICL model. Experimentally, we comprehensively compare the behavior of ICL and explicit finetuning based on real tasks to provide empirical evidence that ICL has our findings to the experimental evidence proves that ICL behaves like us. The same extent. Prediction at the explicit finetuning level, the representation level, and the attention behavior level. Further, inspired by our understanding of meta-optimization, we design a momentum-based attention by analogy with the gradient descent-based momentum gradient algorithm. Its consistently better performance against vanilla attention supports us again from another aspect, and more importantly, it shows the potential to use our understanding for future modeling tasks.</td></tr></table>",
                                            "image_path": "c5cb1c03ce310e892fd61eaa32ce841cb067ab9667243eb40806a6a4a9b52013.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                476,
                                333,
                                2052,
                                382
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        476,
                                        333,
                                        2052,
                                        382
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                476,
                                                333,
                                                2052,
                                                382
                                            ],
                                            "type": "text",
                                            "content": "Table 2: 1 example showing how the pretrained ICAE ( "
                                        },
                                        {
                                            "bbox": [
                                                476,
                                                333,
                                                2052,
                                                382
                                            ],
                                            "type": "inline_equation",
                                            "content": "k = 128"
                                        },
                                        {
                                            "bbox": [
                                                476,
                                                333,
                                                2052,
                                                382
                                            ],
                                            "type": "text",
                                            "content": " ) restores the original context."
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "table_caption"
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "table",
                    "bbox": [
                        889,
                        1544,
                        1652,
                        1785
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                889,
                                1544,
                                1652,
                                1785
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        889,
                                        1544,
                                        1652,
                                        1785
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                889,
                                                1544,
                                                1652,
                                                1785
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Content type</td><td>Loss</td><td>BLEU</td></tr><tr><td>Normal text</td><td>0.01</td><td>99.3</td></tr><tr><td>Patterned random text</td><td>1.63</td><td>3.5</td></tr><tr><td>Completely random text</td><td>4.55</td><td>0.2</td></tr></table>",
                                            "image_path": "c0f639529f6571ef4783e43a2bb4eb77b968dfb37448b75d8428e4d211623a68.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                441,
                                1425,
                                2106,
                                1518
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        441,
                                        1425,
                                        2106,
                                        1518
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                441,
                                                1425,
                                                2106,
                                                1518
                                            ],
                                            "type": "text",
                                            "content": "Table 3: Restoration performance for different types of 512-token content with 128 memory slots. Patterned random text is obtained by adding 1 to each token_id in a normal text."
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "table_caption"
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        441,
                        1818,
                        2103,
                        1907
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                441,
                                1818,
                                2103,
                                1907
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        441,
                                        1818,
                                        2103,
                                        1907
                                    ],
                                    "type": "text",
                                    "content": "Based on this intuition, it is very likely that a more powerful LLM may support a higher compression ratio without significant forgetting. We will discuss it in Section 3.3.1."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        448,
                        1966,
                        928,
                        2013
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                448,
                                1966,
                                928,
                                2013
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        448,
                                        1966,
                                        928,
                                        2013
                                    ],
                                    "type": "text",
                                    "content": "3.2.2 FINE-TUNED ICAE"
                                }
                            ]
                        }
                    ],
                    "index": 5,
                    "level": 1
                },
                {
                    "bbox": [
                        441,
                        2039,
                        2108,
                        2501
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                441,
                                2039,
                                2108,
                                2501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": "In order to evaluate the fine- tuned ICAE's performance, we evaluate on the PwC test set. We use the GPT- 4 to compare the outputs of the two systems to determine which one performs better or if they are on par with each other, following Mu et al. (2023). Table 4 shows the comparison of results of the LLMs conditioned on memory slots and original contexts. For Llama- 7b (fine- tuned ICAE), we compare with Alpaca and StableLM- tuned- alpha- 7b since there is no official instruction- tuned Llama- 1 model. The Llama- 7b (ICAE) conditioned on 128 memory slots largely outperforms both Alpaca and StableLM which can access original contexts ("
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sim 512"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": " tokens), with a win rate of "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "inline_equation",
                                    "content": "56.7\\%"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "inline_equation",
                                    "content": "74.1\\%"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": " respectively and a win+tie rate of "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "inline_equation",
                                    "content": "73\\% \\sim 81\\%"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": ". However, when compared to the GPT- 4 (we regard it as the gold standard), there is still a significant gap, with around "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "inline_equation",
                                    "content": "70\\%"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": " of the cases underperforming the GPT- 4's results, and a win+tie ratio of about only "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "inline_equation",
                                    "content": "30\\%"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2039,
                                        2108,
                                        2501
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        441,
                        2517,
                        2106,
                        2798
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                441,
                                2517,
                                2106,
                                2798
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "text",
                                    "content": "When we switch the base model to Llama- 2- chat, we observe ICAE's performance becomes much better than its counterpart based on Llama- 1: when "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 128"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "text",
                                    "content": ", its win+tie rate can reach around "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "inline_equation",
                                    "content": "75\\%"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "text",
                                    "content": " against the GPT- 4 although it still lags behind its counterpart conditioning on the original context as the compression is lossy. As "
                                },
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        441,
                                        2517,
                                        2106,
                                        2798
                                    ],
                                    "type": "text",
                                    "content": " increases, the win+tie rate further improves while the compression rate decreases. We perform the same comparative studies on Llama- 2- 13b- chat and observe better results of ICAE, supporting our assumption in Section 3.2.1 that the ICAE can benefit more on larger LLMs."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        443,
                        2818,
                        2103,
                        3049
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                443,
                                2818,
                                2103,
                                3049
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "text",
                                    "content": "We investigate the impact of memory length on results. Table 5 shows pairwise comparisons between ICAE models with varying memory slot lengths. A higher compression ratio makes it harder to ensure response quality, but a larger ratio doesn't always lead to worse performance. Table 5 highlights that a pretrained ICAE with "
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "inline_equation",
                                    "content": "8\\times"
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "text",
                                    "content": " compression ("
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 64"
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "text",
                                    "content": ") can match a non- pretrained ICAE with "
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "inline_equation",
                                    "content": "4\\times"
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "text",
                                    "content": " compression ("
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 128"
                                },
                                {
                                    "bbox": [
                                        443,
                                        2818,
                                        2103,
                                        3049
                                    ],
                                    "type": "text",
                                    "content": "). Under the same ratio, the pretrained ICAE performs much better than its"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                2550,
                3300
            ],
            "page_idx": 0
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.1.9"
}