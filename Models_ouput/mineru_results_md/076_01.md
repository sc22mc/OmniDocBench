# Vectorized Scenario Description and Motion Prediction for Scenario-Based Testing

1st Max Winkelmann   
ADFunctions & Simulation IAVGmbH Berlin, Germany max.winkelmann@iav.de $2 ^ { \mathrm { n d } }$ Constantin Vasconi   
ADFunctions& Simulation IAVGmbH Berlin, Germany   
constantin.vasconi@iav.de

$3 ^ { \mathrm { r d } }$ Steffen Muller Department of Automotive Engineering TechnischeUniversitat Berlin Berlin, Germany steffen.mueller@tu-berlin.de

Abstract-Automated vehicles (AVs)are tested in diverse scenarios,typically specified by parameters such asvelocities, distances,or curve radii. To describe scenariosuniformly independent of such parameters,this paper proposes a vectorized scenario description defined by the road geometryand vehicles' trajectories.Data of this form are generated for three scenarios, merged,and used to train the motion prediction model VectorNet, allowing to predict an AV's trajectory for unseen scenarios.Predicting scenario evaluation metrics,VectorNet partially achieves lowererrors than regression models that separately process the three scenarios'data.However, for comprehensive generalization, sufficient variance in the training data must be ensured.Thus, contrary to existing methods,our proposed method can merge diverse scenarios‘data and exploit spatial and temporal nuances in the vectorized scenario description.As a result,data from specified test scenarios and real-world scenarios can be compared and combined for (predictive) analyses and scenario selection.

Index Terms-automated driving，motion prediction,safety validation,scenario-based testing,scenario selection

# I.INTRODUCTION

Validating the safety of automated vehicles (AVs) is challenging.Their environment’s complex and open nature prevents all-encompassing testing of AVs.Due to the rare nature of accidents,statistical safety validation based on representative routes of human drivers is not possible either $\mathbb { [ [ \begin{array} { l } { 1 } \end{array} ] }$ Thus, AVs’validation requires targeted testing to uncover problems effectively and determine residual risks precisely [2], [3].

Which scenariosare risky differs from AV to AV,depending on the hardware and software.Thus,search-based techniques systematically vary scenarios and provoke critical behaviors $\textcircled { 4 }$ .Here，scenario-based testing provides the framework for variation $\textcircled { \scriptsize { 1 5 } }$ .First, a functional scenario is described in natural language,e.g.，“The AV (Ego） follows a curved road.".An associated logical scenario specifies open parameters and their ranges, e.g., $v _ { \mathrm { E g o } } \in [ 8 \frac { \mathrm { m } } { \mathrm { s } } , 1 6 \frac { \mathrm { m } } { \mathrm { s } } ]$ Finally, concrete scenarios, e.g., $\begin{array} { r } { v _ { \mathrm { E g o } } = 9 \frac { \mathrm { m } } { \mathrm { s } } } \end{array}$ ,are parameterized within the logical scenario.Here, data of executed concrete scenarios are used to perform predictive analyses for further concrete scenarios and select relevant concrete scenarios for execution.

However, the description of scenarios by parameters has limitations. Conventional techniques for predictive analyses cannot be used across logical and functional scenarios as theirparameters vary considerably. Thus,the search for relevant concrete scenarios starts anew for each functional and logical scenario. Furthermore,real-world scenarios may only be described inadequately by parameters since, e.g., the road geometry can be arbitrarily complex |6l-l8J. Thus, it is unclear what behavior to expect in real-world tests,and the comparison ofAVs’behavior in testsand real-world scenariosisrestricted.

This paper explores how a uniform scenario description and predictive analysesacross logical, functional,and real-world scenarios can be achieved.Motion prediction techniques are examined as possible solutions.Our main contributions are:

·A vectorized scenario description suitable for diverse and complex concrete scenarios and (predictive） analyses. ，The integration of motion prediction into scenariobased testing,enabling comprehensive predictive analyses across functional, logical, and real-world scenarios. ·The implementation and investigation of our approach using the motion prediction model VectorNet 9j.

# II.RELATEDWORK

Below,we discuss the essential artifacts in scenario-based testing and assess their suitability as a basis for predictive analyses.The lower part ofFig.1illustrates these artifacts.

# A. From Functional Scenarios to Concrete Scenarios

Functional scenarios are described in natural language [5 and can be supported by sketches $\underline { { \| 1 0 \| } }$ Thus,functional scenariosare human-readable,but their representation and abstraction limit their suitability asa data basis for predictive analyses.Similar limitations apply to abstract scenarios $\boxed { 1 0 }$ which we do not discuss further due to their low prevalence.

Logical scenarios complement functional scenarios with $N _ { I }$ influencing parameters $\boxed { \ 5 }$ ，which we denote by inputs $\boldsymbol { x } ~ \in ~ \mathbb { R } ^ { N _ { I } }$ .Furthermore,lower and upper bounds of $_ { x }$ or the distribution $p ( { \boldsymbol { x } } )$ are determined.Fora specific functional scenario,different logical scenarios can exist if influences are modeled differently in different test setups or are not controllable.E.g.， fog may be modeled by noise in a 2D simulation,rendered in a 3D simulation，or real but not controllable in a field test.Due to their open nature,logical scenarios cannot be directly processed but they provide the structure for predictive analyses and search-based techniques.