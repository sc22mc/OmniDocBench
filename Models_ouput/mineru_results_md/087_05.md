contributions of this study to field segmentation using coordinate-based methods.

There are a limited number of examples in the literature where field segmentation is performed using machinery coordinate data.This is despite the fact that GPS is a proven,robust,and readily available technology.The review highlights how existing vehicular trajectory segmentation methods do not translate well to the field segmentation problem. Common trajectory segmentation policies either requirea priori knowledge of machinery operator behavior and their driving patterns;geo-markers from third party sources; or rely on using established road networks. These concepts and methods do not crossover to an agricultural setting.To the best of the authors’knowledge,challenging conjoined field segmentation cases have not been addressed in thecurrent literature.Acost-effective coordinate-based solution to automatically segment agricultural fields is required.

# III.MATERIALSANDMETHOD

A coordinate-based method is presented to overcome the challenges highlighted in Section II.First, the data acquisition from two harvesting implements is outlined in Section III-A. Then,the proposed algorithm is presented in two stages.In Stage I,measurements are preprocessed to determine whether PTO activation has occurred and ifroad travel has taken place between activation periods,as described in Section II-B. In Stage II, pathways that may be present between adjacent fields in the sampled image are removed by applying a series of morphological image operations. The algorithm then detects the individual field boundaries from the processed image.Finally,the feld boundaries are converted back to Cartesian and the machinery coordinatedata are labeled as belonging toaparticular field,with details given in Section III-C. The method is fully automated, deterministic,and segments all fields in a job site in one pass.

# A. Data Capture

Georeferenced time series implement data were collected on twoimplements；a 2013, $5 4 0 ~ \mathrm { r / m i n }$ ，McHaleFusion3Plus baler-wrapper [51] and McHale Proglide R3100 mower [52].A custom electronic control unit (ECU) was programmed to relay data from the implements across a J1939/CAN network [53] to aDeutz-Fahr Agrotron 6180 [54] and a John Deere 6150R [55]. The machinery was owned and operated by a machinery contractorbased in Galway, Ireland,as detailedin[56].For machinery coordinates,a NEO-M8 GNSS positioning receiver with a wideband GNSS antenna was fitted to the implements [57].The acquisition frequency of the GNSS is $1 \ \mathrm { H z }$ PTO speed was measured usingan NPN digital hall-effect sensor [5O] installed on the implement drivetrain sprocket with a protruding notch. Pulse counts were translated to frequency, which are represented as the PTO rotations per minute (rpm).Fuel usage measurements were obtained from the tractor J1939 interface.The data were stored locally in a document-based database operating on an 8th generation Intel Nuc (Intel i3 processor and 4 GB of RAM) running Ubuntu 16.

TABLEIRESULTFROM STAGEI ON THE BALER TRAJECTORYDATA SHOWING THENUMBER OF SINGLE AND CONJOINED FIELD SITES IN THE BALER DATASET  

<table><tr><td>Fields per Site</td><td>Site Count</td></tr><tr><td>1</td><td>134</td></tr><tr><td>2</td><td>19</td></tr><tr><td>3</td><td>2</td></tr><tr><td>4</td><td>0</td></tr><tr><td>Total</td><td>155</td></tr></table>

TABLEIIRESULTFROMSTAGEION THE MOWER TRAJECTORY DATA SHOWING THENUMBER OF SINGLEAND CONJOINED FIELD SITES IN THEMOWER DATASET  

<table><tr><td>Fields per Site</td><td>Site Count</td></tr><tr><td>1</td><td>162</td></tr><tr><td>2</td><td>9</td></tr><tr><td>3</td><td>0</td></tr><tr><td>4</td><td>1</td></tr><tr><td>Total</td><td>172</td></tr></table>

# B. Stage I: Data Preproccessing

In preprocessing,unique job sites are determined from the measurement campaign bycoarse filtering therawmachinery trajectory data.At this stage in the process,it is acceptable to label several fields from a single work episode as belonging to one site.

A siteisdetermined by the filtering rules listed below.   
1）Periods where the PTO remains active ( $> = 4 0 0 ~ \mathrm { r / m i n } ,$ ） a）In scenarios where normal machinery operation is interrupted and the operator must stop the PTO,the dataare segmented if the Euclidean distance from the PTO stop location is greater than $4 0 \textrm { m }$ to thePTO restart location.(In the recorded datasets,operators may stop and restart the PTO during harvesting operations ina field.The most common example is to deal with blockages.This may not be representative of all implements).   
2）Machinery operation continues without stoppages （ $> =$ $1 2 0 \mathrm { m i n }$ ）between operations.   
3）Machinery speeds do not exceed $8 \mathrm { m / s }$ during in-field operation. (In the recorded datasets,operators do not exceed thisspeed during harvesting operations ina field,only on the road between job sites.This may not be representative of all implements).

The results of the filtered trajectories based on the policies listed above are shown in Tables Iand II.

# C.Stage II:Path Removal

Once the raw machinery trajectory data have been filtered into job sites,the algorithm moves to Stage I1,Path Removal. Fig.3 describes the procedure;the process is divided into six steps.Each stepis labeled alphabetically andwill be referred to throughout this section. The goal of this stage is to remove pathways between fields and isolate field geometric boundaries