![](images/be450abc7e52da9fdcb3971d6b4b25ea6f62d17d64061378d93501f729b917a8.jpg)  
Figure3.ValidationofewmetastabletatesfoudwithTmewapexploratio.Theedcoesindcatetediferentconditioingtates. (a)TICAplotsfor(otconditional)mplesgeneratedviaalongajectoryimewarpexplorationlgorit2)anTip MCMC(Algorithm1).TimewarpexplorationdiscoversomemetastablestatesunseeninthelongMDtrajectories(botomofLYVIplot botomleftofCTAplot).()ConditionaldistrbutionsgeneratedwithMDorithteTimewarpmodel,artingfromstatessitedby thelongMDtrjectorysownin(a).SomeshortDtrajectoriesnowdiscoverthenewmetastableateserifingthattheyareineed validstates.OnlythefinalstateofeachshortMDtrajectoryisrecorded.(c)Conditionaldistributions generatedwithMDorwiththe Timewarp model,starting fromthenew metastable states discovered byoneofthe shortMDtrajectories shown in (b).

# B.5.Exploration of new metastable states

For some tetrapetides in the test set even long MD trajectories ( $\mathbf { 1 } \mu \mathbf { s } )$ miss some metastable states, e.g. for LYVI and CSTA showninFigure 13a.However,wecaneasily explore these with the Timewarp explorationalgorithm(Algorithm2).To confirm that these additional metastable states are in fact stable,we run several shorter MD trajectories $( 0 . 5 \times 1 0 ^ { 6 } \mathrm { f s } )$ ,in the same wayas in Appendix B.3,starting in a nearby metastable state already discovered with the long MD trajectory (Figure 13b). Once one of them hits the new,previously undiscovered state,we start new short MD trajectories $( 0 . 5 \times 1 0 ^ { 6 } \mathrm { f s } )$ fromthereas well(Figure13c).Thesenew short MDtrajectories eithersamplewithinthis previouslyundiscovered state,or transitiontotheother metastablestates.Thisshowsthatthismetastable statediscoveredbyTimewarp explorationis indeed valid,and was simplyundiscovered during thelong MDtrajectory.Inaddition, wecompare inFigure13theconditional MD distributions with that of Timewarp,again showing close agreement.

# C.Exploration of metastable states using Timewarp without MH corrections

We describe the exploration algorithm for Timewarp, which accepts allproposed states unlessthe energy is above acertain cutoff value.As there is noMHcorrection,the generatedsamples willnotasymptoticall followthe Boltzmanndistribution, buttheexplorationofthestatespaceismuchfasterthanwithMDorAlgorithm1.ThepseudocodeisshowninAlgorithm2:

<table><tr><td> Algorithm 2 Fast exploration of the state space with Timewarp</td></tr><tr><td>Require: Initial state X, number of steps M,maximum allowed energy increase ‚ñ≥Umax</td></tr><tr><td>form=0,...,Mdo</td></tr><tr><td>SampleXm~pe(-|XmÔºâ{Sample from conditional flow)</td></tr><tr><td>ifU(XÔºâ-U(xÔºâ&lt;‚ñ≥Umax then</td></tr><tr><td>xm+1‚ÜêX</td></tr><tr><td>else</td></tr><tr><td>en+1 ‚Üê- Xp Rejetf ergy hage s thih</td></tr><tr><td></td></tr><tr><td>end for outputXÔÅ®,. XùëÄ</td></tr></table>

NotethatunlikeAlgorithm1,thereisnoneedfortheauxiliary variables,since theconditional fowonlydepends on the positions,and no MH acceptance ratio is computed here. The potential energy $U$ includes here also a large penalty if the ordering ofachiralitycenter changes as describedin Appendix A.3.Assampling proposals from Timewarpcan be batched,