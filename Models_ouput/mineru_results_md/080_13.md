· $q \in A _ { i }$ · $q \in S _ { m }$ such that there exist $p \in C _ { i } \cap S _ { m }$ (notation from Lemma 4)

First two cases are straightforward.To prove the theorem for the third case observe that if $q \notin Q _ { i } \cup A _ { i }$ ,then $q \notin A _ { j }$ and $q \notin Q _ { k }$ forany $j , k \neq i$ otherwise $\boldsymbol { B }$ would be non-deterministic.So we deduce that $q \in S _ { m }$ for some $m$ .For the sake of contradiction suppose that $C _ { i } \cap S _ { m } = \emptyset$ . But that means, that $q . a ^ { m } b \in B _ { j }$ for $j \neq i$ and further $q . a b ^ { m } w ^ { \prime } = q . w = q _ { l } ^ { y }$ what is a contradiction. From these considerationswe areable to determine for each $i$ the sets $A _ { i }$ and $Q _ { i }$ thatare subsets of the set $Q _ { i } ^ { \prime }$ . In order to compute the sets $C _ { i }$ we first compute $S _ { 1 } ^ { \prime } , . . , S _ { n } ^ { \prime }$ inducing all $a$ -clustersin $\boldsymbol { B }$ byremoving $b , 0 , 1$ transitions and determine all connected components of the resulting structure. Now we examine three cases for a cluster $S _ { j } ^ { \prime }$

· $S _ { j } ^ { \prime } \cap Q _ { i } = \emptyset$   
· $S _ { j } ^ { \prime } \subseteq Q _ { i }$ $S _ { j } ^ { \prime } \cap Q _ { i } \neq \emptyset$ and $S _ { j } ^ { \prime } \not \subset Q _ { i }$

Notice, that if the first case holds we know that no state of $S _ { j } ^ { \prime }$ belongs to $C _ { i }$ If the second case holds,we must check if $S _ { j } ^ { \prime } \subseteq Q _ { i } \cup A _ { i }$ .If this is not true,then we have found a cluster ${ \mathit { C } } _ { m }$ ，such that for all $q \in K _ { m }$ it holds $\rho ( q , b ) \in B _ { i }$ and wedetermined the $a$ -clusterthatbelongs to $C _ { i }$ .Inthethirdcaseweknowthat some of the states of the cluster $S _ { j } ^ { \prime }$ arein $C _ { i }$ and some are not.To compute those that are let us take the center of the $a$ -cluster $S _ { j } ^ { \prime }$ ，say $K _ { j } ^ { \prime }$ ，and observe that $q \in C _ { i }$ if,and only if $q \in \{ p \in K _ { j } ^ { \prime } : \rho ( p , b ) \in B _ { i } \} = K _ { j } ^ { \prime \prime }$ or $q$ belongs to some branch with destination in $K _ { j } ^ { \prime \prime }$ . That concludes the proof. □

Using two former lemmas,decryption method is similar as in 4. Extended step is depicted on Figure 7. If we choose the public key to be the automaton on Figure 2, then notice,that in Lemma 4 we have $m \ : = \ : 2$ ，and $Q . a ^ { 2 } b \ =$ $\{ 2 , 3 , 7 , 1 2 , 1 3 \}$