arXiv:2302.00920v1 [math.NT] 2 Feb 2023

# CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

ABSTRACT. We study the construction of optimal conflict-avoiding codes (CAC) from a number theoretical point of view. The determination of the size of optimal CAC of prime length  $p$  and weight 3 is formulated in terms of the solvability of certain twisted Fermat equations of the form  $g^2X^{\ell} + gY^{\ell} + 1 = 0$  over the finite field  $\mathbb{F}_p$  for some primitive root g modulo  $p$ . We treat the problem of solving the twisted Fermat equations in a more general situation by allowing the base field to be any finite extension field  $\mathbb{F}_q$  of  $\mathbb{F}_p$ . We show that for  $q$  greater than a lower bound of the order of magnitude  $O(\ell^2)$  there exists a generator g of  $\mathbb{F}_q^{\times}$  such that the equation in question is solvable over  $\mathbb{F}_q$ . Using our results we are able to contribute new results to the construction of optimal CAC of prime lengths and weight 3.

Keywords: binary protocol sequence, conflict-avoiding code, diagonal equation, Hasse-Weil bound, Ramanujan's sum, Fibonacci primitive root.

# 1. INTRODUCTION

A binary protocol sequence set for transmitting data packets over a multiple-access collision channel without feedback is called a *conflict-avoiding code* (CAC) in information theory. It has been studied a few decades ago by [Mat90, NGM92, GV93, TR02, LT05, Lev07]. A mathematical model for CACs of length  $n$  and (Hamming) weight  $w$  is as follows. Let  $\mathbb{Z}/n\mathbb{Z}$  be the additive group of the integer ring  $\mathbb{Z}$  modulo  $n$ . For a  $w$ -subset  $\mathbf{x} = \{x_1, \dots, x_w\}$  of  $\mathbb{Z}/n\mathbb{Z}$ , let  $\Delta(\mathbf{x}) = \{x_i - x_j \mid i \neq j\}$ . A CAC of length  $n$  and weight  $w$  is a collection  $\mathscr{C}$  of  $w$ -subsets of  $\mathbb{Z}/n\mathbb{Z}$  such that  $\Delta(\mathbf{x}) \cap \Delta(\mathbf{y}) = \varnothing$  for every distinct  $\mathbf{x}, \mathbf{y} \in \mathscr{C}$ . Each  $w$ -subset  $\mathbf{x}$  of  $\mathscr{C}$  is called a *codeword*. A CAC  $\mathscr{C}$  is said to be *optimal* if its size is maximal among all CACs of the same length and weight. In the case where the weight is one or two, there is no difficulty to find the optimal size. However, for weights more than 2, finding an optimal CAC and determining its size is still an open problem. The first challenge is the case of weight 3. One of the purpose of this note is to treat the problem of finding optimal CAC's from a number theoretical point of view and contribute new results to the construction of optimal CAC of weight 3. Thus, all CACs which we are concerned with will be of weight 3.

In the case of even lengths and weight 3, the problem of constructing optimal CACs has a complete answer by the work [LT05, JMJ<sup>+</sup>07, MFU09, FLM10]. In contrast, it is incomplete for odd lengths. Let  $o_m(2)$  denote the multiplicative order of 2 modulo a positive odd integer *m*. For a CAC of odd length *n*, we write  $n = n_1 n_2$  such that  $o_p(2)$  is a multiple of 4 for all the prime divisors p of  $n_1$  while  $o_p(2)$  is not divisible by 4 for all 

1

2

LIANG-CHUNG HSIA,HUA-CHIEH LI,AND WEI-LIANG SUN

prime divisors  $p$  of  $n_2$ . An optimal CAC are constructed in [LT05, Lev07] when  $n_2 = 1$ . If  $n_2 \neq 1$ , it is proved in [FLS14] that an optimal CAC of length  $n$  can be constructed from an optimal CAC of length  $n_2$ . It is also proved in [FLS14] that an optimal CAC of a prime power length can be constructed if we know how to construct an optimal CAC of prime length provided that the prime  $p$  in question is a non-Wieferich prime. For other odd lengths or *tight/equi-difference* CACs, we refer to [Mom07, WF13, LMSJ14, MM17, HLS] for the constructions. It turns out that CACs of prime lengths are the fundamental cases needed to be constructed. This naturally leads us to study CACs of *prime lengths* and weight 3.

Let *p* be an odd prime and denote by  $\mathbb{F}_p = \mathbb{Z}/p\mathbb{Z}$  a finite field of *p* elements. Recall that a codeword of the form  $\{0, a, 2a\}$  is said to be *equi-difference*. In the paper [\[LT05\]](#LT05), the authors show that there exists an optimal CAC consisting of  $\frac{p-1}{4}$  equi-difference codewords in the case where  $4 \mid o_p(2)$ . In contrast, if  $4 \nmid o_p(2)$  then a CAC consisting of equi-difference codewords only is usually not optimal. By analyzing nonequi-difference codewords, an upper bound of the size of optimal CAC of odd length is given in [\[FLS14\]](#FLS14). Let us recall their results for the case of CAC with prime lengths. Put

$$
\mathscr{O}(p) = \begin{cases} \frac{p-1}{2o_p(2)} & \text{if } o_p(2) \text{ is odd,} \\ \frac{p-1}{o_p(2)} & \text{if } o_p(2) \equiv 2 \pmod{4}, \\ 0 & \text{if } 4 \mid o_p(2) \end{cases}
$$

and  $M(p)$  to be the size of optimal CAC of length  $p$ . Then, by [\[FLS14](#FLS14), Lemma 3] one has(1) 

(1)

$$
\frac{p-1-2\mathscr{O}(p)}{4} \leq M(p) \leq \frac{p-1-2\mathscr{O}(p)}{4} + \left\lfloor \frac{\mathscr{O}(p)}{3} \right\rfloor.
$$

Note that in the case where  $\mathscr{O}(p) \leq 2$ , inequality (1) already gives that  $M(p) = \frac{p-1-2\mathscr{O}(p)}{4}$ . For  $\mathscr{O}(p) \geq 3$  the authors provide an algorithm for constructing nonequi-difference CAC and conjectured that the algorithm produces a CAC consists of  $\frac{p-1-2\mathscr{O}(p)}{4}$  equi-difference codewords and  $\lfloor \frac{\mathscr{O}(p)}{3} \rfloor$  nonequi-difference codewords. In other words, the upper bound in  $(1)$  can be attained and hence the CAC obtained by their algorithm is actually an optimal CAC. The key property needed for their algorithm to work is given as Conjecture A below. For our purpose, we rephrase their conjecture in terms of cosets of the subgroup generated by  $-1$  and 2 in the multiplicative group  $\mathbb{F}_p^{\times} = \mathbb{F}_p \setminus \{0\}$  of  $\mathbb{F}_p$ .

**Conjecture A** ([\[FLS14, Conjecture 1\]](#)). Let  $p$  be a non-Wieferich prime. Then there are  $3\left\lfloor\frac{\mathcal{O}(p)}{3}\right\rfloor$  cosets  $A_1, B_1, C_1, \dots, A_{\left\lfloor\frac{\mathcal{O}(p)}{3}\right\rfloor}, B_{\left\lfloor\frac{\mathcal{O}(p)}{3}\right\rfloor}, C_{\left\lfloor\frac{\mathcal{O}(p)}{3}\right\rfloor}$  of the subgroup generated by  $-1$  and 2 in  $\mathbb{F}_p^{\times}$  such that for each  $i = 1, \ldots, \left\lfloor \frac{\mathcal{O}(p)}{3} \right\rfloor$  there exists a triple  $(a_i, b_i, c_i) \in A_i \times B_i \times C_i$  satisfying

$$
a_{i} + b_{i} + c_{i} = 0
$$
 in  $\mathbb{F}_{p}$ .
 
 CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS 
 
 3

Throughout this article we denote by  $H = \langle -1, 2 \rangle$  the subgroup generated by  $-1$  and 2 in  $\mathbb{F}_{p}^{\times}$  and set

$$
\ell_0 = [\mathbb{F}_p^\times : H]
$$

for the index of H in  $\mathbb{F}_p^{\times}$ . Notice that if  $4 \nmid o_p(2)$  then by definition we have that  $\mathcal{O}(p) = \ell_0$ . Furthermore, Conjecture A is a non-empty statement if and only if  $\mathcal{O}(p) = \ell_0 \geq 3$ .

The idea behind Conjecture A is the following. Suppose that Conjecture A holds, then each triple  $(a_i, b_i, c_i)$  in the conjecture corresponds to a nonequi-difference codeword  $\mathbf{x_i} = {\{0, a_i, -c_i\}}$  with difference set  $\Delta(\mathbf{x_i}) = {\{\pm a_i, \pm b_i, \pm c_i\}}$ . Hence, we have  $\left\lfloor\frac{\mathcal{O}(p)}{3}\right\rfloor$  nonequi-difference codewords whose difference sets are disjoint. From the complement of  $\bigcup_{i=1}^{1} \Delta(\mathbf{x_i})$  in  $\mathbb{F}_p^{\times}$ , their algorithm then produces  $\frac{p-1-2\mathcal{O}(p)}{4}$  equi-difference codewords and hence gives a CAC of size matching the upper bound given in  $(1)$ .

As an illustration, we briefly discuss the case treated in [FLS14, Example 3] where the length  $p = 31$ . Note that  $o_{31}(2) = 5$  and hence  $\mathcal{O}(31) = 3$ . Then Conjecture A predicts that there are  $3\left\lfloor\frac{\mathcal{O}(31)}{3}\right\rfloor = 3$  cosets and one element in each coset such that their sum is zero. One finds that the triple  $(2, 3, -5)$  gives a solution and the corresponding codeword is  $\{0,2,5\}$  whose difference set is just  $\{\pm 2, \pm 3, \pm 5\}$  while 2, 3 and  $-5$  lie exactly in three distinct cosets of H in  $\mathbb{F}_p^{\times}$ . Moreover, there are six equi-difference codewords  $\{0,4,8\}$ ,  $\{0,6,12\}, \{0,7,14\}, \{0,9,18\}, \{0,10,20\}$  and  $\{0,15,30\}$  produced by their algorithm. In total, one concludes that the size of an optimal CAC of length 31 is  $M(31) = 7$ .

Independently, in [MZS14] the authors proposed a conjecture which provides solutions to the existence of the triples  $(A_i, B_i, C_i)$  in Conjecture A in terms of the group structure of  $\mathbb{F}_p^{\times}/H$ .

**Conjecture B** ([MZS14, Conjecture]). Let *p* be an odd prime. If  $\ell_0 \ge 3$ , then there exist  $b \in gH$  and  $c \in g^2H$  such that

$$
1 + b + c = 0 \quad \text{in } \mathbb{F}_p
$$

for some generator  $g$  of  $\mathbb{F}_p^{\times}$ .

**Remark 1.1.** We see that Conjecture B implies Conjecture A by setting  $A_1 = H$ ,  $B_1 = gH$ ,  $C_1 = g^2H$ ,  $A_2 = g^3H$ ,  $B_2 = g^4H$ ,  $C_2 = g^5H$ ,..., $A_e = g^{3e-3}H$ ,  $B_e = g^{3e-2}H$  and  $C_e = g^{3e-1}H$  where  $e = \left\lfloor\frac{\ell_0}{3}\right\rfloor$ . Moreover, Conjecture B does not assume that  $4 \nmid o_p(2)$ .

Note that the subgroup  $H = \langle -1, 2 \rangle$  consists of all the  $\ell_0$ -th power of elements of  $\mathbb{F}_p^{\times}$ . It follows that the elements  $b$  and  $c$  in Conjecture B are of the forms  $gy^{\ell_0}$  and  $g^2x^{\ell_0}$  respectively for some  $x, y \in \mathbb{F}_p^{\times}$ . Observe that if  $\ell_0 \geq 3$  then any  $\mathbb{F}_p$ -rational solutions  $(x, y)$  to the the *diagonal equation*  $g^2X^{\ell_0} + gY^{\ell_0} + 1 = 0$  must satisfy  $xy \neq 0$  since  $-1 \in H$  and  $g$  is a generator of  $\mathbb{F}_p^{\times}$ . Thus, any  $\mathbb{F}_p$ -rational solution gives a pair of elements  $b$  and  $c$  in Conjecture B. So Conjecture B is equivalent to the following statement.

4

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

**Conjecture C.** Let *p* be an odd prime. If  $\ell_0 \geq 3$ , then there is a generator *g* of  $\mathbb{F}_p^{\times}$  such that the diagonal equation

(2)

$$
g^2X^{\ell_0} + gY^{\ell_0} + 1 = 0
$$

is solvable over  $\mathbb{F}_p$ .

The formulation in Conjecture C has the advantage that the number of  $\mathbb{F}_p$ -rational solutions to Equation  $(2)$  can be computed in terms of certain character sums which have been well studied in number theory. By establishing valid cases in Conjecture C, we also obtain the cases where Conjecture B as well as Conjecture A are true. Therefore, by studying the solvability of Equation (2) over  $\mathbb{F}_p$ , we are able to provide new results to the construction of optimal CACs.

Motivated by Conjecture C, instead of working on the diagonal equations as (2) over the prime field  $\mathbb{F}_p$  and the specific exponent  $\ell_0$ , we will look at general situations by taking the base field to be a finite extension of  $\mathbb{F}_p$  and the exponent in the equation is allowed to be more general than  $\ell_0$ . Let q be a prime power and  $\ell$  be a proper divisor of  $q - 1$ . We consider the solvability of the following diagonal equation

(3) 

$$
g^2 X^{\ell} + g Y^{\ell} + 1 = 0
$$

over a finite field  $\mathbb{F}_q$  of  $q$  elements, where  $g$  is a generator of the multiplicative group  $\mathbb{F}_q^{\times}$  of  $\mathbb{F}_q$ . In view of Conjecture C, we're interested in whether or not there exists a generator  $g$  such that Equation (3) has a  $\mathbb{F}_q$ -rational solution. However, the answer can be false for divisors of  $q - 1$  other than  $\ell_0$ . For example, in the case where  $(q,\ell) = (13,6), (23,11)$  there does not exist any generator of  $\mathbb{F}_q^{\times}$  such that (3) has a  $\mathbb{F}_q$ -rational solution. On the other hand, as a consequence of our main result below, Equation (3) does have a  $\mathbb{F}_q$ -rational solution for some generator  $g$  of  $\mathbb{F}_q^{\times}$  provided that  $q \ge 19$  if  $\ell = 6$  and  $q \ge 322$  if  $\ell = 11$ . Our first main result is to give a lower bound for  $q$  such that Equation (3) has a  $\mathbb{F}_q$ -rational solution for some generator  $g$  of  $\mathbb{F}_q^{\times}$ .

**Theorem A** (= Theorem 4.3). Let q be a prime power and let  $\ell$  be a proper divisor of  $q-1$ . If

$$
q \ge (2^{\omega(\ell)}(\ell - 3 - \delta) + 2)^2 - 2
$$

where  $\omega(\ell)$  is the number of distinct prime divisors of  $\ell$  and

$$\delta = \begin{cases} 1 & \text{if } 4 \mid \ell, \\ 0 & \text{otherwise,} \end{cases}
$$

then there is a generator  $g$  of  $\mathbb{F}_q^{\times}$  such that Equation (3) is solvable over  $\mathbb{F}_q$ .

**Remark 1.2.** It follows from the Hasse-Weil bound (see Theorem 1) that the number of  $\mathbb{F}_q$ -rational solutions to Equation (3) is bounded below by  $q+1-2g_{\ell}\sqrt{q}$  where  $g_{\ell}=(\ell-1)(\ell-2)/2$  is the genus of the curve defined by (3) over  $\mathbb{F}_q$ . As a result, Equation (3) has a  $\mathbb{F}_q$ -rational solution for any  $g \in \mathbb{F}_q^{\times}$  provided that  $q > (\ell - 1)^2 (\ell - 2)^2$ . It is reasonable to expect that this lower bound can be improved under the weaker condition given in

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

5

Conjecture C. What we have shown in Theorem A is that the improved lower bound has the order of magnitude  $O(\ell^2)$ .

Theorem A gives a sufficient condition for the truth of Conjecture C (and so are Conjecture A and B) in the case where  $q = p$  a prime number and  $\ell = \ell_0$ . Thus, under the given sufficient condition an optimal CAC of length  $p$  with  $4 \nmid o_p(2)$  and weight 3 has the desired size.

**Corollary B.** Let *p* be an odd prime such that  $4 \nmid o_p(2)$ , let  $\ell_0 = [\mathbb{F}_p^{\times}: H]$  and let  $\omega(\ell_0), \delta$  be as in Theorem A with respect to  $\ell_0$ . If  $p \geq (2^{\omega(\ell_0)}(\ell_0 - 3 - \delta) + 2)^2 - 2$ , then an optimal conflict-avoiding code of length p and weight 3 has the size

$$
\frac{p-1-2\ell_0}{4}+\left\lfloor\frac{\ell_0}{3}\right\rfloor.
$$

Applying Corollary B, we can establish the truth of Conjecture C unconditionally for primes with small values of  $\ell_0$ . For instance, if  $1 \le \ell_0 \le 6$  then Conjecture C is true (see, Corollary 2.3, 4.4 and 4.5). Combining the results computed in [MZS14], Theorem A confirms the validity of Conjecture C for a large range of  $\ell_0$ . For instance, if  $\ell_0$  is prime power satisfying  $\ell_0 < 16411$  or if it has two distinct prime divisors such that  $\ell_0 < 8197$  then Conjecture C is true for prime numbers  $p$  with  $\ell_0$  satisfying properties just stated (see Theorem 5.1 and Theorem 5.2 for more cases).

The organization of this note is as follows. In Section 2 we fix some notations and discuss some well-known facts related to Equation (3). In particular, by applying Hasse-Weil bound, we give a proof of the facts that Equation (3) is solvable over  $\mathbb{F}_q$  in the case where  $1 \leq \ell \leq 4$  (Corollary 2.3). Then, we collect and prove necessary results that are needed in the proof of the main result in Section 3. One of the key ingredients is *Ramanujan's* sum which we recall in Lemma 3.2. Section 4 is devoted to the proof of Theorem A. By appropriately organizing the character sum in the expression for the number of solutions to Equation (3), we are able to obtain the desired bound given in Theorem A for the number of solutions. In the final section, we apply our main result to the problem of the size of optimal CAC and deduce a large range of  $\ell_0$  such that Conjecture C (as well as Conjecture B and A) hold.

# 2. PRELIMINARIES

In this section, we fix notations and present some facts that are related to the question of solvability of Equation (3). Let  $\mathbb{F}_q$  be a finite field of  $q$  elements where  $q$  is a power of the prime *p*. Fix a generator *g* of  $\mathbb{F}_q^{\times}$  and a proper divisor  $\ell$  of  $q - 1$ . Let *L* be the subgroup of all  $\ell$ -th power of elements of  $\mathbb{F}_q^{\times}$ . We have that  $\mathbb{F}_q^{\times}/L$  is generated by the coset  $gL$  and  $\ell$  is the order of the cyclic group  $\mathbb{F}_q^{\times}/L$ .

Recall that we're concerned with the solvability of Equation (3)

$$
g^2X^{\ell} + gY^{\ell} + 1 = 0
$$

6

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

over  $\mathbb{F}_q$ . Let  $\mathscr{C}_g$  be the affine plane curve defined by this equation. Note that  $\mathscr{C}_g$  is non-singular and irreducible over  $\overline{\mathbb{F}}_q$ , an algebraic closure of  $\mathbb{F}_q$ . Denote the set of  $\mathbb{F}_q$ -rational points of  $\mathscr{C}_g$  by

$$
\mathscr{C}_{g}(\mathbb{F}_{q}) = \left\{ (x, y) \in \mathbb{F}_{q}^{2} \mid g^{2}x^{\ell} + gy^{\ell} + 1 = 0 \right\}
$$

and let  $N_g = |\mathscr{C}_g(\mathbb{F}_q)|$  be its cardinality. Furthermore, let  $\widetilde{\mathscr{C}}_g$  be the (Zariski) closure of  $\mathscr{C}_g$  in the projective plane defined by the homogeneous equation

(4)

$$
\quad g^{2}X^{\ell} + gY^{\ell} + Z^{\ell} = 0.
$$

Note that  $\widetilde{\mathscr{C}}_g$  is also non-singular. We let  $\widetilde{N}_g$  denote the cardinality of  $\widetilde{\mathscr{C}}_g(\mathbb{F}_q)$ . Having Conjecture B and Conjecture C in mind, we are especially concerned with whether or not a point  $(x, y) \in \widetilde{\mathscr{C}}_g(\mathbb{F}_q)$  satisfying  $xy \neq 0$ . The following lemma shows that this is always true except for very limited special cases.

**Lemma 2.1.** Equation (4) has a nontrivial solution  $(x, y, z)$  with  $xyz = 0$  if and only if one of the following situations holds:

(i)  $\ell = 1 \text{ or } 2;$ 

(ii)  $\ell = 4$  and  $-1 \notin L$ .

*Moreover, if*  $\ell > 2$ *, then xz*  $\neq 0$ *.

Proof.* Suppose that  $(x, y, z)$  is a nontrivial solution to Equation (4) with  $xyz = 0$ . Then only one of  $x, y, z$  is zero. Observe that if  $x = 0$  or  $z = 0$ , then  $-g in L$  and  $gL$  is either of order 1 or 2 in  $\mathbb{F}_q^{\times}/L$ ; if  $y = 0$ , then  $-g^2 \in L$  and  $gL$  is of order 4 in  $\mathbb{F}_q^{\times}/L$ . In particular, we have  $xz \neq 0$  provided that  $\ell \neq 2$ . In the case where  $\ell = 4$ , we see that  $-L = g^2L \neq L$ . It follows that  $-1 \notin L$ .

Conversely, if  $\ell = 1$  then it's clear that Equation (4) has a nontrivial solution  $(x, y, z)$  with  $xyz = 0$ . Suppose that  $\ell = 2$ , then  $\mathbb{F}_q^{\times}/L = \{L, gL\}$ . If  $-1 \notin L$ , then  $-L = gL$ . In this case,  $g = -a^2 \in L$  for some  $a \in \mathbb{F}_q^{\times}$ . Then, we clearly have solutions  $(x, y, z) = (1, a, 0)$  and  $(0,1,a)$ . Suppose  $-1 \in L$ , then  $-g^2 = b^2 \in L$  for some  $b \in \mathbb{F}_q^{\times}$  and we have the solution  $(x, y, z) = (1, 0, b)$  in this case.

Finally, suppose that  $\ell = 4$  and  $-1 \notin L$ . Then both  $g^2L$  and  $-L$  are of order 2 in the cyclic group  $\mathbb{F}_q^{\times}/L$ . Thus,  $-L = g^2L$  and this gives a solution  $(x, y, z) = (1, 0, b)$  where  $-g^2 = b^4 \in L$ .  $\Box$ 

Following [Wei48], the number  $N_g$  of solutions to Equation (3) can be expressed as a character sum which we now recall. As usual, by a multiplicative character of  $\mathbb{F}_q$  we mean a character of the group  $\mathbb{F}_q^{\times}$ , i.e. a group homomorphism from  $\mathbb{F}_q^{\times}$  to  $\mathbb{C}^{\times}$ . As we only deal with multiplicative characters of  $\mathbb{F}_q$ , we'll simply call them characters. The trivial character will be denoted by  $\varepsilon$  such that  $\varepsilon(a) = 1$  for all  $a \in \mathbb{F}_q^{\times}$ . We extend the domain of a character  $\chi$  such that  $\chi(0) = 1$  if  $\chi = \varepsilon$  and  $\chi(0) = 0$  otherwise. We call the extension of  $\chi$  an extended character and still denote the extension by  $\chi$  if there is no

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

7

danger of confusion. We fix a character  $\chi$  of order  $\ell$ . Then we have

(5) 

$$
N_g = q + \sum_{1 \le j,k \le \ell-1} \chi^j(-g^{-2}) \chi^k(-g^{-1}) J(\chi^j, \chi^k)
$$

where

$$
J(\chi^j, \chi^k) = \sum_{a \in \mathbb{F}_q} \chi^j(a) \chi^k(1-a)
$$

is a *Jacobi sum* with respect to  $\chi^j$  and  $\chi^k$ . The following properties of Jacobi sums are useful.

**Lemma 2.2** ([LN97, Theorem 5.19, 5.21, 5.22]). Let  $\lambda$ ,  $\psi$  be two extended characters of  $\mathbb{F}_q$ .

(i)  $J(\lambda, \psi) = J(\psi, \lambda)$ ;

(ii)  $J(\varepsilon, \varepsilon) = q$ ;

(iii)  $J(\lambda, \varepsilon) = 0$  if  $\lambda \neq \varepsilon$ ;

(iv)  $J(\lambda, \lambda^{-1}) = -\lambda(-1)$  if  $\lambda \neq \varepsilon$ ;

(v)  $|J(\lambda,\psi)| = \sqrt{q}$  if  $\lambda, \psi$  and  $\lambda \psi$  are all nontrivial.

Note that  $|\chi'(a)| = 1$  for all  $a \in \mathbb{F}_q^{\times}$ . By (iv) and (v) of Lemma 2.2, one has the following estimate of  $N_g$  from (5)

$$
|N_g - q| \le M_0 + M_1 \sqrt{q}
$$

where  $M_0$  (resp.  $M_1$ ) is the number of pairs  $(j,k)$  with  $\chi^j \chi^k = \varepsilon$  (resp.  $\chi^j \chi^k \neq \varepsilon$ ). Observe that  $M_0 = \ell - 1$  and  $M_1 = (\ell - 1)(\ell - 2)$ . Thus, if

(6) 

$$
q > (\ell - 1) + (\ell - 1)(\ell - 2)\sqrt{q},
$$

then  $N_g > 0$ . Consequently, for  $q$  large enough (for example  $q > (\ell - 1)^4$ ), one has  $N_g > 0$  for any  $g \in \mathbb{F}_q^{\times}$ .

For the numbers of rational solutions to equations over finite fields, the Hasse-Weil bound [\[Wei48\]](#page-1-1) provides more precise information than the crude estimate given above.

**Theorem 1** (Hasse-Weil bound). Let  $\mathscr{C}$  be a non-singular, absolutely irreducible projective curve over  $\mathbb{F}_q$  and let  $N_{\mathscr{C}} = |\mathscr{C}(\mathbb{F}_q)|$  be the number of  $\mathbb{F}_q$ -rational points of  $\mathscr{C}$ . Then,

$$
|N_{\mathscr{C}} - (q+1)| \le 2\mathfrak{g}\sqrt{q}
$$

where  $\mathfrak{g}$  is the genus of  $\mathscr{C}$ .

Applying the Hasse-Weil bound to  $\widetilde{\mathscr{C}}_g$ , we see that

$$
|\widetilde{N_g} - (q+1)| \le (\ell-1)(\ell-2)\sqrt{q}
$$

since the genus of  $\,\widetilde{\mathscr{C}}_g$  is  $\mathfrak{g}_\ell = (\ell - 1)(\ell - 2)/2$  by the degree-genus formula [\[Har77\]](#Har77). Consequently,  $\widetilde{N}_g > 0$  for any generator  $g$  of  $\mathbb{F}_q^{\times}$  provided that  $q + 1 > (\ell - 1)(\ell - 2)\sqrt{q}$  and therefore  $\widetilde{\mathscr{C}}_g(\mathbb{F}_q)$  is non-empty if  $q \geq (\ell - 1)^2(\ell - 2)^2$ .

8

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

With this lower bound, one can easily verify the truth of Conjecture  $C$  (and Conjecture B) for small values of  $\ell$ . The following results are direct consequences of Theorem 1. For the reader's convenience, we give a proof.

**Corollary 2.3.** For  $1 \leq \ell \leq 4$ , we have  $N_g > 0$  for every generator  $g$  of  $\mathbb{F}_q^{\times}$ . Moreover, there exists a point  $(x, y) \in \mathscr{C}_g(\mathbb{F}_q)$  such that  $xy \neq 0$  and hence Conjecture C holds for the *case where*  $\ell_0 = [\mathbb{F}_p^{\times}: H] \leq 4$ .

*Proof.* As it's easy to deduce the conclusion if  $\ell = 1$ , we leave the verification of this case to the reader. Let's first consider the case where  $\ell = 2$ . Notice that in this case  $p > 2$  and  $\mathfrak{g}_{\ell}=0$ . Therefore,  $\widetilde{N_g}=q+1$  by Theorem 1. It's not hard to verify that

$$
N_g = \begin{cases} \widetilde{N_g} & \text{if } q \equiv 1 \pmod{4} \\ \widetilde{N_g} - 2 & \text{if } q \equiv 3 \pmod{4} \end{cases}.
$$

Therefore,  $N_g = q+1$  if  $q \equiv 1 \pmod{4}$  and  $N_g = q-1$  if  $q \equiv 3 \pmod{4}$ . In either case, we clearly have  $N_g > 0$ . It remains to show that there exists a point  $(x,y) \in \mathscr{C}_g(\mathbb{F}_q)$  such that  $xy \neq 0$ . Observe that there are at most four points in  $\mathscr{C}_g(\mathbb{F}_q)$  with either  $x = 0$  or  $y = 0$ . In the case where  $q \equiv 1 \pmod{4}$  we have  $N_g = q + 1 \ge 6$ . It remains to look at the case where  $q \equiv 3 \pmod{4}$ . Since  $\ell = 2$  is a proper divisor of  $q - 1$  by assumption, we see that  $q \ge 7$  and we also have  $N_g = q-1 \ge 6$ . Now, it's clear that there's a point  $(x, y) \in \mathscr{C}_g(\mathbb{F}_q)$  such that  $xy \neq 0$  since  $N_g > 4$  in both cases.

Next, we consider the cases where  $l = 3$  and 4. Since  $l > 2$ , we have that  $N_g = \widetilde{N_g}$  by Lemma 2.1. Suppose that  $l = 3$ . In this case  $\widetilde{\mathscr{C}}_g$  is of genus one. Then the Hasse-Weil bound gives that

$$
N_g \ge (q+1) - 2\sqrt{q} = (\sqrt{q}-1)^2 > 0.
$$

Therefore,  $N_g > 0$  for any generator  $g$  of  $\mathbb{F}_q^{\times}$  in this case. Suppose that there exists a solution  $(x, y)$  to Equation (3) such that either  $x = 0$  or  $y = 0$  for  $\ell = 3$ . Then we get that either *g* or  $g^2$  is a cube in  $\mathbb{F}_q^{\times}$ . This implies that the order of  $gL$  in the group  $\mathbb{F}_q^{\times}/L$  divides 2 which is absurd since  $|\mathbb{F}_q^{\times}/L| = 3$ . Therefore, any  $(x, y) \in C_g(\mathbb{F}_q)$  must satisfy  $xy \neq 0$  as desired.

Assume that  $\ell = 4$ . A direct computation shows that for  $q > 49$ , we have that  $N_g > 8$ . Since there are at most eight solutions to Equation (3) such that either  $x = 0$  or  $y = 0$  for  $\ell = 4$ , we see that for  $q > 49$  there exists  $(x, y) \in \mathcal{C}_g(\mathbb{F}_q)$  such that  $xy \neq 0$  as asserted.It remains to check prime power numbers  $q$  satisfying  $q \le 49$  such that 4 is a proper divisor of  $q - 1$ . Hence, we are left with eight cases where  $q = 9, 13, 17, 25, 29, 37, 41, 49$  to verify. Note that if  $(x, y) \in \mathcal{C}_g(\mathbb{F}_q)$  with  $xy \neq 0$  then  $(x^{-1}, x^{-1}y) \in \mathcal{C}_{g^{-1}}(\mathbb{F}_q)$ . It follows that  $\mathcal{C}_g(\mathbb{F}_q)$  contains a point whose coordinates are nonzero if and only if  $\mathcal{C}_{g^{-1}}(\mathbb{F}_q)$  has this property as well. Also, for any generator  $g'$  of  $\mathbb{F}_q^{\times}$  we have  $g'L \in \{gL, g^{-1}L\}$  in the case where  $|\mathbb{F}_q^{\times}/L| = 4$ . It follows that  $\mathcal{C}_g(\mathbb{F}_q)$  contains a point whose coordinates are nonzero if and only if  $\mathcal{C}_{g'}(\mathbb{F}_q)$  has this property as well. Hence, it suffices to show that  $\mathcal{C}_g(\mathbb{F}_q)$  containing a point with nonzero coordinates for just one generator  $g$  of  $\mathbb{F}_q^{\times}$ . We

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

9

give the following table for each case.

| q | 9        | 13 | 17 | 25        | 29 | 37 | 41 | 49          |
|---|----------|----|----|-----------|----|----|----|-------------|
| g | $\alpha$ | 2  | 3  | $\beta$   | 2  | 5  | 6  | $\gamma$    |
| x | $\alpha$ | 4  | 6  | 1         | 4  | 2  | 3  | 2           |
| y | $\alpha$ | 1  | 2  | $\beta^2$ | 4  | 2  | 3  | $2\gamma^7$ |

where  $\alpha = 1 + \sqrt{-1}$  in  $\mathbb{F}_9 = \mathbb{F}_3(\sqrt{-1})$ ,  $\beta = 1 + 2\sqrt{2}$  in  $\mathbb{F}_{25} = \mathbb{F}_5(\sqrt{2})$  and  $\gamma = 4 + \sqrt{-1}$  in  $\mathbb{F}_{49} = \mathbb{F}_7(\sqrt{-1})$ .

This completes the verifications of all cases in which  $N_g > 0$ . Moreover, we've exhibited all solutions  $(x, y)$  such that  $xy \neq 0$  and thus finish the proof.  $\Box$ 

We would like to point out that it's possible to prove Corollary 2.3 by using the bound (6) without applying the Hasse-Weil bound.

In view of Conjecture C, we only need to find a generator  $g$  of  $\mathbb{F}_q^{\times}$  such that  $\mathscr{C}_g(\mathbb{F}_q)$  is non-empty. Instead of computing  $N_g$ , our goal is to show that the following sum

$$
N(q,\ell) = \sum_{\mathbb{F}_q^\times = \langle g' \rangle} N_{g'} = \sum_{\substack{1 \leq t \leq q-1, \ \gcd(t,q-1)=1}} N_{g^t}
$$

is a positive integer under appropriate conditions.

# 3. KEY INGREDIENTS

In this section, we gather tools and results that are needed for the proof of Theorem A. To simplify the notation, we'll put  $(a_1, a_2) = \text{gcd}(a_1, a_2)$ , the greatest common divisor of integers  $a_1$  and  $a_2$ . The following lemma is an elementary fact in algebra which we will use repeatedly. As one can easily find a proof in any algebra text book, we skip the proof here.

**Lemma 3.1.** Let  $n \in \mathbb{N}$  and let d be a divisor of n. Then the canonical group homomorphism

$$
\pi: (\mathbb{Z}/n\mathbb{Z})^\times \to (\mathbb{Z}/d\mathbb{Z})^\times
$$

induced by

$$
\mathbb{Z}/n\mathbb{Z} \rightarrow \mathbb{Z}/d\mathbb{Z}
$$

$$
k+n\mathbb{Z} \mapsto k+d\mathbb{Z}
$$

is surjective. Furthermore, this homomorphism splits. Namely, there exists a subgroup *M* of  $(\mathbb{Z}/n\mathbb{Z})^{\times}$  which is isomorphic to  $(\mathbb{Z}/d\mathbb{Z})^{\times}$  under  $\pi$  and  $(\mathbb{Z}/n\mathbb{Z})^{\times} = M \cdot N$  where  $N = \ker(\pi)$ .

For  $n \in \mathbb{N}$  and  $m \in \mathbb{Z}$ , the Ramanujan's sum  $c_n(m)$  ([\[Ram18\]](#Ram18) or [\[HSW00](#HSW00), pp. 179–199]) is defined by

$$
c_n(m) = \sum_{\substack{1 \le t < n, \\ (t,n)=1}} \zeta_n^{mt}
$$

10

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

where  $\zeta_n$  is a primitive *n*-th root of 1 in  $\mathbb{C}$ . Studying on cyclotomic polynomials, O. Hölder [\[Höl36\]](#Höl36) showed that the sum  $c_n(m)$  has a nice closed form in terms of the Euler and Möbius functions. Denote  $\varphi$  the Euler's totient function and  $\mu$  the Möbius function. We present it in the following lemma where the right-hand side is also called *von Sterneck* function [\[Ste03\]](#Ste03). A proof is given below to the readers for convenience. For different proofs, one refers to [\[AA53\]](#AA53), [\[Mol52\]](#Mol52) and [\[HW08, Theorem 272\]](#HW08).

**Lemma 3.2.** *Let*  $n \in \mathbb{N}$  *and*  $m \in \mathbb{Z}$ *. Then* 

$$
c_n(m) = \mu\left(\frac{n}{(n,m)}\right) \frac{\varphi(n)}{\varphi\left(\frac{n}{(n,m)}\right)}
$$

*Proof.* First of all, suppose that  $m = 1$ . Recall an elementary formula that

$$
\sum_{k|r} \mu(k) = \begin{cases} 1 & \text{if } r = 1; \\ 0 & \text{if } r > 0, \end{cases}
$$

for  $r \in \mathbb{N}$  ([\[Bur11, Theorem 6.6\]](#page-11-1)). Then

$$
c_n(1) = \sum_{t=1}^n \zeta_n^t \sum_{k|(t,n)} \mu(k) = \sum_{k|n} \mu(k) \sum_{\substack{1 \le t \le n, \\ k|(t,n)}} \zeta_n^t = \sum_{k|n} \mu(k) \sum_{\substack{1 \le t' \le \frac{n}{k}}} (\zeta_n^k)^{t'}
$$

where  $t' = \frac{t}{k}$ . Since  $\zeta_n^k$  is a primitive  $\frac{n}{k}$ -th root of 1, the last sum gives 1 if  $k = n$  and 0 if  $k < n$ . Hence,  $c_n(1) = \mu(n)$ .

For general  $m \in \mathbb{Z}$ , we rewrite  $c_n(m)$  as

$$
c_n(m) = \sum_{t \in (\mathbb{Z}/n\mathbb{Z})^{\times}} z^t
$$

where  $z = \zeta_n^m$ . Let  $d = \frac{n}{(n,m)}$ . Recall that  $(\mathbb{Z}/n\mathbb{Z})^{\times} = M \cdot N$  where  $M$  and  $N$  are given in 

Lemma 3.1. Note that  $z = \zeta_n^m$  is a primitive *d*-th root of 1 since  $\left(d, \frac{m}{(n,m)}\right) = 1$ . Hence,

$$
c_n(m) = \sum_{t_1 \in M} \sum_{t_2 \in N} z^{t_1 t_2} = \sum_{t_1 \in M} |N| z^{t_1} = |N| c_d(1).
$$

Now, the result follows from  $|N| = \frac{\varphi(n)}{\varphi(d)}$  and  $c_d(1) = \mu(d)$  by the first paragraph.  $\Box$ 

Note that  $(n,m) = (n, (n,m))$ . Thus, we have the following immediate consequence.

**Corollary 3.3.** Let  $n \in \mathbb{N}$  and  $m \in \mathbb{Z}$ . Then  $c_n(m) = c_n((n,m))$ .

As a consequence, we note that if m' is an integer such that  $m' \equiv m \pmod{n}$ , then we conclude from Corollary 3.3 that  $c_n(m') = c_n(m)$ .

The following decomposition of a Cartesian product is useful for counting pairs of integers. Roughly speaking, the product below is partitioned by parallel lines on  $\Z \times \Z$ .

**Lemma 3.4.** Let  $n \in \mathbb{N}$  and let  $I = \{1, 2, ..., n - 1\}$ . For every  $a, b \in \mathbb{Z}$ , we have

$$
I \times I = \biguplus_{d \mid n} \biguplus_{\substack{1 \le t \le \frac{n}{d}, \\ (t, \frac{n}{d}) = 1}} \{ (x, y) \in I \times I \mid ax + by \equiv td \pmod{n} \}.
$$

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

11

*Proof.* Let  $a, b \in \mathbb{Z}$  be two fixed integers and let

$$
S(d,t) = \{(x,y) \in I \times I \mid ax + by \equiv td \pmod{n}\}.
$$

Then the union of  $S(d,t)$  for all such  $d$  and  $t$  is a subset of  $I \times I$ . This union indeed contains all elements of  $I \times I$ . To see this, let  $(x,y) \in I \times I$  and let  $d = (ax+by,n)$ . Pick  $1 \le t \le \frac{n}{d}$  such that  $t \equiv \frac{ax+by}{d} \pmod{\frac{n}{d}}$ . Then  $(t, \frac{n}{d}) = 1$  and  $ax + by \equiv td \pmod{n}$ . Thus,  $(x,y) \in S(d,t)$ . Finally, if  $S(d,t) \cap S(d',t') \neq \emptyset$ , then choose one pair  $(x,y)$  in this intersection. We obtain  $d = (ax+by,n) = d'$ . Furthermore,  $td \equiv t'd \pmod{n}$  implies that  $t \equiv t' \pmod{\frac{n}{d}}$ . Since  $1 \le t, t' \le \frac{n}{d}$ , we have  $t = t'$ .  $\Box$ 

# 4. PROOF OF THE MAIN RESULT

Recall that we aim at showing the following sum

$$
N(q,\ell) = \sum_{\substack{1 \le t \le q-1, \\ (t,q-1)=1}} N_{g^t}
$$

is not equal to zero where  $g$  is a fixed generator of  $\mathbb{F}_q^{\times}$ . It's not hard to see that if  $g^tL = g^sL$  then  $N_{g^t} = N_{g^s}$ . We have the following reduction for  $N(q, \ell)$ .

**Proposition 4.1.** Let g be generator of  $\mathbb{F}_q^{\times}$  and  $\ell | q-1$ . Then

$$
N(q,\ell) = \frac{\varphi(q-1)}{\varphi(\ell)} \sum_{\substack{1 \leq t \leq \ell, \\ (t,\ell)=1}} N_{g^{t}}.
$$

*Proof.* By the definition of  $N(q, \ell)$ , it is a sum indexed by all elements of  $(\mathbb{Z}/(q-1)\mathbb{Z})^{\times}$ . Recall that  $(\mathbb{Z}/(q-1)\mathbb{Z})^{\times} = M \cdot N$  where *M* and *N* are given in Lemma 3.1 for  $n = q-1$  and  $d = \ell$ . Note that if  $t_1 \in N$ , then  $t_1 \equiv 1 \pmod{\ell}$  and  $g^{t_1}L = gL$ . It follows that  $N_{g^{t_1t_2}} = N_{g^{t_2}}$  for any integer  $t_2$ . Hence,

$$
N(q,\ell) = \sum_{t \in (\mathbb{Z}/(q-1)\mathbb{Z})^{\times}} N_{g^t} = \sum_{t_1 \in N} \sum_{t_2 \in M} N_{g^{t_1t_2}} = |N| \sum_{t_2 \in M} N_{g^{t_2}}.
$$

The result follows since  $|N| = \frac{\varphi(q-1)}{\varphi(\ell)}$  and  $M \simeq (\mathbb{Z}/ \mathbb{\ell Z})^{\times}$ .

Recall from  $(5)$  that

$$
N_{g^t} = q + \sum_{1 \le j,k \le \ell-1} \chi^j(-g^{-2t}) \chi^k(-g^{-t}) J(\chi^j,\chi^k)
$$

where  $\chi$  is a nontrivial character of  $\mathbb{F}_q$  of order  $\ell$ . We can rewrite  $N_{q^t}$  as follows.

**Lemma 4.2.** *For*  $1 \le t \le \ell$  *and*  $(t, \ell) = 1$ *,* 

$$
N_{g^{t}}=q+1+\sum_{\substack{1 \leq j,k \leq \ell-1,\\j+k \neq \ell}} \chi(-1)^{j+k} \chi(g^{-1})^{(2j+k)t} J(\chi^{j},\chi^{k}).
$$

12

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

*Proof.* If  $j+k = \ell$ , then  $J(\chi^j, \chi^k) = -\chi((-1)^j)$  by (iv) of Lemma 2.2. It follows that

$$
\sum_{\substack{1 \le j,k \le \ell-1, \\ j+k=\ell}} \chi(-1)^{j+k} \chi(g^{-1})^{(2j+k)t} J(\chi^j,\chi^k) = - \sum_{j=1}^{\ell-1} \chi(-g^{-t})^j.
$$

Note that the kernel of  $\chi$  is *L*. If  $-g^{-t} \in L$ , then  $g^{-t}L = -L$ . This gives  $\ell = |\mathbb{F}_q^{\times}/L| \le 2$  since  $g^{-t}L$  also generates  $\mathbb{F}_q^{\times}/L$  as  $1 \le t \le \ell$  and  $(t,\ell) = 1$ . This is not our case and thus  $\chi(-g^{-t}) \neq 1$ . Hence,  $\sum_{j=1}^{\ell-1} \chi((-g^{-t})^j) = -1$  and the result follows.  $\Box$ 

Now, we are ready to prove our main theorem.

**Theorem 4.3.** Let  $q$  be a power of a prime and let  $\ell$  be a proper divisor of  $q-1$ . If

$$
q \ge (2^{\omega(\ell)}(\ell - 3 - \delta) + 2)^{2} - 2
$$

where  $\omega(\ell)$  is the number of distinct prime divisors of  $\ell$  and

$$
\delta = \left\{ \begin{array}{ll} 1 & \textit{if } 4 \mid \ell, \\ 0 & \textit{otherwise} \end{array} \right.
$$

then there is a generator  $g$  of  $\mathbb{F}_q^{\times}$  such that  $N_g > 0$ .

*Proof.* By Proposition 4.1, it is enough to consider the subsum

$$
N = \sum_{\substack{1 \le t \le \ell, \\ (t,\ell) = 1}} N_{g^t}
$$

where *g* is a fixed generator of  $\mathbb{F}_q^{\times}$ . Lemma 4.2 gives that

$$
N = \varphi(\ell)(q+1) + \sum_{\substack{1 \le j,k \le \ell-1, \\ j+k \ne \ell}} \chi(-1)^{j+k} J(\chi^{j}, \chi^{k}) z(j,k) \quad \text{where}
$$

$$
z(j,k) = \sum_{\substack{1 \le t \le \ell, \\ (t,\ell)=1}} \chi(g^{-1})^{(2j+k)t}.
$$

Note that  $\chi(g^{-1}) = \zeta_{\ell}$  is a primitive  $\ell$ -th root of 1. Therefore,

$$
z(j,k) = \sum_{\substack{1 \le t \le \ell, \\ (t,\ell) = 1}} \zeta_{\ell}^{(2j+k)t} = c_{\ell}(2j+k),
$$

is a Ramanujan's sum and

$$
N = \varphi(\ell)(q+1) + \sum_{\substack{1 \le j,k \le \ell-1,\ j+k \ne \ell}} \chi(-1)^{j+k} J(\chi^j,\chi^k) c_{\ell}(2j+k).
$$

Let  $I = \{1, 2, \ldots, \ell - 1\}$  and for positive integer  $d \mid \ell$  and integer  $t$  with  $1 \le t \le \ell/d$  such that  $(t, \ell/d) = 1$ , we set

$$
S'(d,t) = \{ (j,k) \in I \times I \mid 2j+k \equiv td \pmod{\ell} \text{ and } j+k \neq \ell \}.
$$

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

13

By omitting pairs  $(j, k)$  of  $I \times I$  satisfying  $j+k = \ell$ , Lemma 3.4 gives that

$$
N - \varphi(\ell)(q+1) = \sum_{d|\ell} \sum_{\substack{1 \le t \le \frac{\ell}{d} \\ (t,\frac{\ell}{d}) = 1}} \sum_{(j,k) \in S'(d,t)} \chi(-1)^{j+k} J(\chi^j, \chi^k) c_{\ell}(2j+k).
$$

For  $(j,k) \in S'(d,t)$ , one has  $(2j+k,\ell) = d$  and then  $c_{\ell}(2j+k) = c_{\ell}(d)$  by Corollary 3.3. Thus,

$$
N - \varphi(\ell)(q+1) = \sum_{d|\ell} c_{\ell}(d)f(d)
$$

where

$$
f(d) = \sum_{\substack{1 \leq t \leq \frac{\ell}{d} \\ (t,\frac{\ell}{d}) = 1}} \sum_{(j,k) \in S'(d,t)} \chi (-1)^{j+k} J(\chi^{j},\chi^{k}).
$$

We need to estimate  $|f(d)|$ .

By definition, every pair  $(j,k)$  of  $S'(d,t)$  satisfies  $j+k \not\equiv 0 \pmod{\ell}$  and thus  $|J(\chi^j,\chi^k)| = \sqrt{q}$  by (v) of Lemma 2.2. Since  $|\chi(-1)| = 1$ , it follows that

$$
|f(d)| \leq \sum_{\substack{1 \leq t \leq \frac{\ell}{d}, \ (t,\frac{\ell}{d}) = 1}} |S'(d,t)| \sqrt{q}.
$$

Now, we compute  $|S'(d,t)|$ . Observe that every pair  $(j,k)$  in  $S'(d,t)$  is determined by  $j \\in I$  with the proviso that  $j + k \\neq \\ell$ . Thus, for  $(j,k) \\in I \\times I$  satisfying the congruence  $2j+k \\equiv td \\pmod{\\ell}$  we have to exclude the pair  $(j,k)$  with  $j \\equiv td \\pmod{\\ell}$ . Note that  $td \\leq \\ell$  while  $j \\leq \\ell - 1$ , this congruence can occur only when  $d \\leq \\ell$  and  $j = td$ . Moreover, as  $k \\neq 0$ , we also need to exclude the case where  $2j \\equiv td \\pmod{\\ell}$ . This depends on the parity of  $\\ell$ . We discuss in the next paragraph to steer clear of confusing.

Suppose that  $\ell$  is odd. Let  $s \in I$  be such that  $2s \equiv 1 \pmod{\ell}$ . Then, we need to exclude  $j \in I$  such that  $j \equiv std \pmod{\ell}$ . If  $d = \ell$ , then there is no such j because  $j \not\equiv 0 \pmod{\ell}$ . When  $d \leq \ell$ , there is exactly one  $j_0 \in I$  satisfying  $j_0 \equiv std \pmod{\ell}$ . Remember that we also have to exclude the case where  $j = td$ . As a consequence, if  $\ell$  is odd, then

$$
|S'(d,t)| = \begin{cases} |I| & \text{if } d = \ell; \\ |I| - 2 & \text{if } d \neq \ell. \end{cases}
$$

Now we assume that  $\ell$  is even. There are three cases to consider: (i) *td* is odd, (ii) *td* is even and  $d \le \ell$  and (iii)  $t = 1, d = \ell$ . For case (i), since *td* is odd, there is no *j* such that  $2j \equiv td \pmod{\ell}$ . Only the case where  $j = td$  has to be excluded. For (ii) and (iii), we have that  $td$  is even and then there is some  $j_1 \in I$  such that  $2j_1 \equiv td \pmod{\ell}$ . In fact, we have  $j_1 \equiv \frac{td}{2} \pmod{\frac{\ell}{2}}$ . If  $d \le \ell$ , then either  $j_1 = \frac{td}{2}$  or  $j_1 = \frac{td}{2} + \frac{\ell}{2}$  and in particular,  $j_1 \neq td$  in this case. If  $d = \ell$ , then  $t = 1$  and  $j_1 = \frac{\ell}{2}$ . We conclude that

$$
|S'(d,t)| = \begin{cases} |I|-1 & \text{if } d = \ell; \\ |I|-1 & \text{if } d \neq \ell \text{ and } td \text{ is odd;} \\ |I|-3 & \text{otherwise.} \end{cases}
$$

14

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN


Combining these two situations of  $\ell$ , we have an expression for  $|S'(d,t)|$  as follows.

$$
|S'(d,t)| = |I| - 2 + 2\left\lfloor\frac{d}{\ell}\right\rfloor - (-1)^{td}\lambda = |I| - 2 + 2\left\lfloor\frac{d}{\ell}\right\rfloor - (-1)^d\lambda
$$

where  $\lambda = \frac{1}{2}(1 + (-1)^{\ell})$  and note that  $td \equiv d \pmod{2}$  when  $\ell$  is even as  $(t, \frac{\ell}{d}) = 1$ . In particular,  $|S'(d, t)|$  is independent on t. Therefore,

$$
|f(d)| \le \varphi\left(\frac{\ell}{d}\right) \left(|I| - 2 + 2\left\lfloor\frac{d}{\ell}\right\rfloor - (-1)^d \lambda\right) \sqrt{q}
$$

and

$$
|N - \varphi(\ell)(q+1)| \leq \sum_{d|\ell} |c_{\ell}(d)f(d)|
$$

$$
\leq \sum_{d|\ell} |c_{\ell}(d)| \varphi\left(\frac{\ell}{d}\right) \left(|I| - 2 + 2\left\lfloor\frac{d}{\ell}\right\rfloor - (-1)^{d}\lambda\right) \sqrt{q}.
$$

By Lemma 3.2, we have  $c_{\ell}(d)\varphi(\frac{\ell}{d}) = \mu(\frac{\ell}{d})\varphi(\ell)$ . By dividing  $\varphi(\ell)$ , we obtain

$$
\left|\frac{N}{\varphi(\ell)} - (q+1)\right| \leq \sum_{d|\ell} \left|\mu\left(\frac{\ell}{d}\right)\right| \left(|I| - 2 + 2\left\lfloor\frac{d}{\ell}\right\rfloor - (-1)^d \lambda\right) \sqrt{q}.
$$

Note that  $|\mu(\frac{\ell}{d})| = 1$  if  $\frac{\ell}{d}$  is square-free and  $|\mu(\frac{\ell}{d})| = 0$  otherwise. Observe that the number of divisors d in which  $\frac{\ell}{d}$  is square-free is  $2^{\omega(\ell)}$ . Moreover,

$$
\sum_{\substack{d|\ell,\\mu\left(\frac{\ell}{d}\right)\neq 0}}(-1)^d\lambda=2^{\omega(\ell)}\delta.
$$

It follows that

$$
\left|\frac{N}{\varphi(\ell)} - (q+1)\right| \le \left(2^{\omega(\ell)}(|I| - 2 - \delta) + 2\right)\sqrt{q}
$$

As a consequence, if  $q + 1 > (2^{\omega(\ell)} (|I| - 2 - \delta) + 2) \sqrt{q}$ , then we can conclude that  $N > 0$ . By dividing  $\sqrt{q}$  and taking square on both sides, the last inequality is equivalent to

$$
q+2+\frac{1}{q} > (2^{\omega(\ell)}(|I|-2-\delta)+2)^2 = (2^{\omega(\ell)}(\ell-3-\delta)+2)^2.
$$

All terms except  $\frac{1}{q}$  on both sides are integers and  $\frac{1}{q} < 1$ . The result follows.

**Corollary 4.4.** If q is congruent to 1 modulo 5, then  $g^2X^5 + gY^5 + 1 = 0$  is solvable in  $\mathbb{F}_q$  *for some primitive root g of*  $\mathbb{F}_q$ .

*Proof.* By Theorem 4.3, the result holds for  $q \ge 34$ . For  $q < 34$  and  $q \equiv 1 \pmod{5}$ , one has  $q = 11, 16, 31$ . For  $q = 11$ , one has  $g = 7$  and  $7^2 \cdot (-1)^5 + 7 \cdot (-1)^5 + 1 = 0$ . For  $q = 16$ , one has  $\mathbb{F}_{16} = \mathbb{F}_2(\alpha)$  with  $\alpha^4 = 1 + \alpha$  and  $\mathbb{F}_{16}^{\times} = \langle \alpha \rangle$ . Moreover,  $\alpha^2 \cdot (\alpha^2)^5 + \alpha \cdot (\alpha^2)^5 + 1 = 0$ . For  $q = 31$ , one has  $g = 3$  and  $3^2 \cdot (-3)^5 + 3 \cdot 3^5 + 1 = 0$ .  $\square$

**Corollary 4.5.** If q is congruent to 1 modulo 6, then  $g^2X^6 + gY^6 + 1 = 0$  is solvable in  $\mathbb{F}_q$  *for some primitive root g of*  $\mathbb{F}_q$  *if and only if*  $q > 13$ . $\Box$ 

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

15

*Proof.* By Theorem 4.3, the result holds for  $q \ge 194$ . For  $q < 194$  and  $q \equiv 1 \pmod{6}$ , we first look at  $q = 7$  and  $q = 13$ . When  $q = 7$ , one has  $x^6 = 1$  for all  $x \in \mathbb{F}_7^{\times}$ . But  $g^2 + g + 1 \neq 0$  for any primitive root  $g$  of  $\mathbb{F}_7$ . So it is not solvable in this case. For  $q = 13$ ,  $x^6 = \pm 1$  for all  $x \in \mathbb{F}_{13}^{\times}$ . It is easy to check that  $g^2X^6 + gY^6 + 1 = 0$  is not solvable for all primitive roots  $g = 2, 6, 7, 11$  of  $\mathbb{F}_{13}$ . For the rest of cases that  $13 < q < 194$ , the following table gives a solution for some primitive root  $g$ :

| q | 19  | 25         | 31  | 37  | 43  | 49        | 61  | 67         | 73  | 79  | 97 | 103 |
|---|-----|------------|-----|-----|-----|-----------|-----|------------|-----|-----|----|-----|
| g | 2   | $\alpha$   | 3   | 2   | 3   | $\beta$   | 2   | 2          | 5   | 3   | 5  | 5   |
| X | 1   | $\alpha^3$ | 19  | 2   | 1   | $\beta^3$ | 24  | 4          | 1   | 6   | 5  | 5   |
| Y | 2   | $\alpha$   | 27  | 1   | 28  | $\beta^3$ | 4   | 43         | 59  | 6   | 29 | 32  |

| q | 109 | 121        | 127 | 139 | 151 | 157       | 163 | 169        | 181 | 193 |
|---|-----|------------|-----|-----|-----|-----------|-----|------------|-----|-----|
| g | 6   | $\gamma$   | 3   | 2   | 6   | 5         | 2   | $\kappa$   | 2   | 5   |
| X | 16  | $\gamma^7$ | 84  | 2   | 1   | 22        | 8   | 1          | 86  | 1   |
| Y | 26  | $\gamma^4$ | 3   | 103 | 132 | 82        | 1   | $\kappa^2$ | 148 | 127 |

where $\alpha = 3 + \sqrt{2}$ in $F_{25} = F_5(\sqrt{2})$, $\beta = 4 + \sqrt{-1}$ in $F_{49} = F_7(\sqrt{-1})$, $\gamma = 2 + \sqrt{2}$ in $F_{121} = F_{11}(\sqrt{2})$ and $\kappa = 7 - 2\sqrt{2}$ in $F_{169} = F_{13}(\sqrt{2})$. $\square$  $\Box$ 

# 5. APPLICATION: CONFLICT-AVOIDING CODES OF WEIGHT 3

In this section, we apply our main result to the construction of CAC. We consider the special case where  $q = p$  and  $\ell = \ell_0$  the index of  $H$  in  $\mathbb{F}_p^{\times}$ . Let's start with a proof of Corollary B.

*Proof.* Let p be a prime such that the multiplicative order  $o_p(2)$  of 2 is not a multiple of 4. Suppose that  $p$  satisfies the condition

$$
p \ge (2^{\omega(\ell_0)}(\ell_0 - 3 - \delta) + 2)^2 - 2
$$

where  $\delta = 1$  if  $4 \mid \ell_0$  and  $\delta = 0$  otherwise. It follows from Theorem A that there exists a generator  $g$  of  $\mathbb{F}_p^{\times}$  such that Equation (2) is solvable over  $\mathbb{F}_p$ . By Corollary 2.3 for  $1 \leq \ell_0 \leq$  4 and Lemma 2.1 for  $\ell_0 \ge 5$ , we see that there exists a solution  $(x, y) \in \mathbb{F}_p^2$  to Equation (2) satisfying  $xy \neq 0$ . Thus, Conjecture C and hence Conjecture B holds for prime numbers p satisfying the inequality given above. As it is explained in Section 1, Conjecture A is also true for these prime numbers. Combining the algorithm given in [FLS14], we conclude that an optimal CAC of length  $p$  and weight 3 has the size

$$
M(p,\ell_0) = \frac{p-1-2\ell_0}{4} + \left\lfloor \frac{\ell_0}{3} \right\rfloor
$$

as desired.

Our strategy for studying the size of optimal CAC of prime lengths is through investigating Conjecture B (equivalently, Conjecture C). In the paper [MZS14] the authors

16

LIANG-CHUNG HSIA, HUA-CHIEH LI, AND WEI-LIANG SUN

announce that Conjecture B has been verified to hold for prime  $p \le 2^{30}$ . Applying Corollary B, we are able to extend the range of prime numbers  $p$  such that Conjecture B holds.

For  $\ell \in \mathbb{N}$ , let

$$
b(\ell) = (2^{\omega(\ell)}(\ell - 3 - \delta) + 2)^2 - 2
$$

be the lower bound appearing in Theorem A. Suppose that  $p$  is a prime number such that the index  $\ell_0$  of  $H$  in  $\mathbb{F}_p^{\times}$  satisfying  $b(\ell_0) \leq 2^{30}$ , then either  $p \leq 2^{30}$  or  $p > 2^{30} \geq b(\ell_0)$ . It follows that Conjecture C holds for this prime number  $p$ . This leads to the question about the integer  $\ell$  such that  $b(\ell) \leq 2^{30}$ . The answer depends on the number of distinct prime divisors of  $\ell$ . For  $\omega(\ell) < 4$ , one can check that  $b(\ell) \leq 2^{30}$  if one of the following conditions holds:

$$
\begin{cases} \ell < 16411 \text{ with } \omega(\ell) = 1, \\ \ell < 8197 \text{ with } \omega(\ell) = 2, \\ \ell < 4100 \text{ with } \omega(\ell) = 3. \end{cases}
$$

Moreover, one also has  $b(\ell) \leq 2^{30}$  whenever  $\ell < 2070$ . As a consequence, we have the following result.

**Theorem 5.1.** Conjecture C holds for primes p with  $\ell_0$  satisfying one of the following conditions

$$
\begin{cases} \ell_0 < 16411 \text{ with } \boldsymbol{\omega}(\ell_0) = 1, \\ \ell_0 < 8197 \text{ with } \boldsymbol{\omega}(\ell_0) = 2, \\ \ell_0 < 4100 \text{ with } \boldsymbol{\omega}(\ell_0) = 3, \\ \ell_0 < 2070. \end{cases}
$$

For an integer  $l$  such that  $b(l) > 2^{30}$ , we consider the set of prime numbers between  $2^{30}$  and  $b(l)$ . Let

$$
P(\ell) = \left\{ \text{primes } p > 2^{30} \mid \left[ \mathbb{F}_p^{\times} : \langle -1, 2 \rangle \right] = \ell \text{ and } p < b(\ell) \right\}
$$

For prime numbers in  $P(\ell)$ , we verify Conjecture C by the aid of computer for the computations. For instance, we obtain that  $P(2070) = \emptyset$  and hence Conjecture C holds for prime numbers  $p$  with  $\ell_0 = 2070$ . By computer search, there are 423 primes in the union of  $P(\ell)$  for  $2070 \leq \ell \leq 3000$ . The largest prime number in the union is 7324065841 with  $\ell = 2730$ . We have checked that Conjecture C holds for these prime numbers.

**Theorem 5.2.** Conjecture C *holds for primes p such that*  $[\mathbb{F}_p^{\times} : \langle -1, 2 \rangle] \leq 3000$ .

For the solvability of Equation  $(3)$ , we have the following simple observation.

**Proposition 5.3.** Let  $\ell$  be a proper divisor of  $q-1$  and  $\ell' \mid \ell$ . Suppose that Equation (3) is solvable over  $\mathbb{F}_q$  for exponent  $\ell$  then it is also solvable for exponent  $\ell'$ .

Proposition 5.3 leads to the following consideration for  $q = p$ , a prime number, and  $\ell = \frac{p-1}{2}$  in Equation (3). In this case,  $L = \{\pm 1\}$  and it suffices to consider the four possibilities  $\pm g^2 \pm g + 1 = 0$  where  $g \in \mathbb{N}$  is a primitive root modulo  $p$  (i.e.  $g$  is a generator of  $\mathbb{F}_p^{\times}$ ). Clearly,  $g^2 \pm g + 1 = 0$  if and only if  $g^3 = \pm 1$ , and then  $p - 1 = 3, 6$ .


CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS

17

This holds for  $p = 7$  and  $g = 3$ . The remaining two cases  $-g^2 \pm g + 1 = 0$  are equivalent because  $-g^2 + g + 1 = 0$  if and only if  $-g^{-2} - g^{-1} + 1 = 0$ . In other words, we only need to consider the equality  $g^2 = g + 1$  over  $\mathbb{F}_p$ . Such a primitive root  $g$  is called a *Fibonacci primitive root* modulo  $p$ , as the *golden ratio*  $\varphi_{gr}$  satisfying  $\varphi_{gr}^2 = \varphi_{gr} + 1$ . The primes  $p$  such that  $\mathbb{F}_p$  has a Fibonacci primitive root is the sequence A003147:  $5, 11, 19, 31, 41, 59, 61, 71, 79, 109, ...$  on OEIS [Slo]. Consequently, we have  $N(p, (p-1)/2) > 0$  if and only if  $\mathbb{F}_p$  has a Fibonacci primitive root. On the other hand, the order  $|H|$  of the subgroup  $H = \langle -1, 2 \rangle$  is an even integer. It follows that  $\ell_0 = \frac{p-1}{|H|}$  must divide  $\frac{p-1}{2}$ . By Proposition 5.3, we see that Equation (2) is solvable over  $\mathbb{F}_p$  if  $\mathbb{F}_p$  has a Fibonacci primitive root. In this case, there exists a solution  $(x, y) \in \mathbb{F}_p^2$  such that  $xy \neq 0$  and thus Conjecture C holds.


 **Proposition 5.4.** If $\mathbb{F}_p$ has a Fibonacci primitive root, then Conjecture C holds for this p.

On a related issue, for the valid cases in Conjecture C established above we would like to know how many prime numbers  $p$  are there such that the subgroup  $H$  generated by  $-1$  and 2 has the given index  $\ell_0$  in  $\mathbb{F}_p^{\times}$ . This question can be viewed as a generalization of the Artin's primitive root conjecture. It is shown in [Mur91, Theorem 1] that there are infinitely many primes  $p$  such that the index  $[\mathbb{F}_p^{\times}:H]=\ell_0$  under the *Generalized* Riemann Hypothesis (GRH). Assuming GRH, we conclude from Corollary B that there are infinitely many prime numbers  $p$  with  $\ell_0$  satisfying conditions in Theorem 5.2 and therefore, the size of optimal CACs of prime lengths is equal to  $M(p, \ell_0)$  for *infinitely* many primes  $p$ .

# ACKNOWLEDGMENT

We would like to thank Professor Yuan-Hsun Lo for bringing [FLS14] to our attention. The first named author is partially supported by MOST grant 110-2115-M-003-007-MY2. The second named author is partially supported by MOST grant 111-2115-M-003-005. The third named author is supported by MOST grant 110-2811-M-003-530.

# REFERENCES

- [AA53]  D.R. Anderson and T.M. Apostol. The evaluation of Ramanujan's sum and generalizations. Duke Math. J., 20(2):211-216, 1953. doi:10.1215/S0012-7094-53-02021-3.
- [Bur11] D.M. Burton. *Elementary Number Theory*. McGraw-Hill, New York, 2011. [Bur11]
- [FLM10] H.-L. Fu, Y.-H. Lin, and M. Mishima. Optimal conflict-avoiding codes of even length and weight 3. IEEE Trans. Inform. Theory, 56(11):5747-5756, 2010. doi:10.1109/TIT.2010.2069270.
- [FLS14] H.-L. Fu, Y.-H. Lo, and S.W. Shum. Optimal conflict-avoiding codes of odd length and weight three. *Des. Codes Cyptogr.*, 72(2):289–309, 2014. doi:10.1007/s10623-012-9764-5.
- [GV93] L. Györfi and I. Vajda. Constructions of protocol sequences for multiple access collision channel without feedback. IEEE Trans. Inform. Theory, 39(5):1762-1765, 1993. doi:10.1109/18.259673.
- [Har77] R. Hartshore. Algebraic Geometry, volume 52 of Graduate Texts in Mathematics. Springer, New York, 1977. doi:10.1007/978-1-4757-3849-0.

18

LIANG-CHUNG HSIA,HUA-CHIEH LI,AND WEI-LIANG SUN


- [HLS] L.-C. Hsia, H.-C. Li, and W.-L. Sun. Conflict-avoiding codes of prime lengths and cyclotomic  $[HLS]$ numbers, preprint.
- [hq136] O. Hölder. Zur theorie der kreisteilungsgleichung  $K_m(x) = 0$ . (German) *Prace Matematyczno-*[Höl36] Fizyczne, 43(1):13–23, 1936. URL: http://eudml.org/doc/215570.
- [HSW00] G.H. Hardy, P.V. Seshu Aiyar, and B.M. Wilson, editors. *Collected papers of Srinivasa Ramanu*jan. AMS Chelsea Publishing, Providence, RI, 2000. Third printing of the 1927 original. With a new preface and commentary by B.C. Berndt.
- [HW08] G.H. Hardy and E.M. Wright. *An introduction to the theory of numbers*. Oxford University Press, Oxford, sixth edition, 2008. Revised by D.R. Heath-Brown and J. Silverman. With a foreword by A. Wiles.
- [JMJ<sup>+</sup>07] M. Jimbo, M. Mishima, S. Janiszewski, A.Y. Teymorian, and V.D. Tonchev. On conflict-avoiding codes of length  $n = 4m$  for three active users. *IEEE Trans. Inform. Theory*, 53(8):2732–2742, 2007.doi:10.1109/TIT.2007.901233.
- [Lev07] V.I. Levenshtein. Conflict-avoiding codes and cyclic triple systems. Probl. Inf. Transm., 43(3):199-212, 2007. doi:10.1134/S0032946007030039.
- [LMSJ14] Y. Lin, M. Mishima, J. Satoh, and M. Jimbo. Optimal equi-difference conflictavoiding codes of odd length and weight three. Finite Fields Appl., 26:49-68, 2014. doi:10.1016/j.ffa.2013.11.001.
- [LN97] R. Lidl and H. Niederreiter. Finite Fields, volume 20 of Encyclopedia of Mathemat-[LN97] ics and its Applications. Cambridge University Press, Cambridge, second edition, 1997. doi:10.1017/CB09780511525926.
- [LT05] V.I. Levenshtein and V.D. Tonchev. Optimal conflict-avoiding codes for three active users. *Proc.* [LT05] IEEE Int. Symp. Inform. Theory, pages 535–537, 2005. doi:10.1109/ISIT.2005.1523392.
- [Mat90] P. Mathys. A class of codes for a  $t$  active users out of  $n$  multiple-access communication system. IEEE Trans. Inform. Theory, 36(6):1206-1219, 1990. doi:10.1109/18.59923.
- [MFU09] M. Mishima, H.-L. Fu, and S. Uruno. Optimal conflict-avoiding codes of length  $n \equiv 0 \pmod{16}$  and weight 3. *Des. Codes Cryptogr.*, 52(3):275–291, 2009. doi:10.1007/s10623-009-9282-2.
- [MM17] M. Mishima and K. Momihara. A new series of optimal tight conflict-avoiding codes of weight 3. Discrete Math., 340(4):617-629, 2017. doi:10.1016/j.disc.2016.12.003.
- [Mol52] R. Moller. Sums of power of numbers having a given exponent modulo a prime. Amer. Math. Monthly, 59(4):226-230, 1952. With additional remarks by H.S. Zuckerman. doi:10.1080/00029890.1952.11988111.
- [Mom07] K. Momihara. Necessary and sufficient conditions for tight equi-difference conflictavoiding codes of weight three. Des. Codes Cryptogr., 45(3):379-390, 2007. doi:10.1007/s10623-007-9139-5.
- [Mur91] L. Murata. A problem analogous to Artin's conjecture for primitive roots and its applications. Arch. Math., 57(6):555-565, 1991. doi:10.1007/BF01199060.
- [MZS14] W. Ma, C. Zhao, and D. Shen. New optimal constructions of conflict-avoiding codes of odd length and weight 3. Des. Codes Cyptogr., 73(3):791-804, 2014. doi:10.1007/s10623-013-9827-2.
- [NGM92] Q.A. Nguyen, L. Györfi, and J.L. Massey. Constructions of binary constant-weight cyclic codes and cyclically permutable codes. *IEEE Trans. Inform. Theory*, 38(3):940–949, 1992. doi:10.1109/18.135636.
- [Ram18] S. Ramanujan. On certain trigonometrical sums and their applications in the theory of numbers. Trans. Cambridge Philos. Soc., 22(13):259-276, 1918.

CERTAIN DIAGONAL EQUATIONS AND CONFLICT-AVOIDING CODES OF PRIME LENGTHS 19

- [Slo] N.J.A. Sloane. OEIS Foundation Inc. (2023), The On-Line Encyclopedia of Integer Sequences, Published electronically at http://oeis.org.
- [Ste03] R.v. Sterneck. Über ein analogon zur additiven zahlentheorie. (German) Jahres-[Ste03] bericht der Deutschen Mathematiker-Vereinigung, 12:110–113, 1903. URL: http://eudml.org/doc/144877.
- [TR02] B.S. Tsybakov and A.R. Rubinov. Some constructions of conflict-avoiding codes. Probl. Inf. [TR02] Transm., 38(4):268-279, 2002. doi:10.1023/A:1022045812079.
- [Wei48] A. Weil. Sur les Courbes Algébrique et les Variétés Qui s'en Déduisent. *Hermann*, 1948.
- [WF13]S.-L. Wu and H.-L. Fu. Optimal tight equi-difference conflict-avoiding codes of length  $n = 2^k \pm 1$ [WF13] and weight 3. J. Combin. Des., 21(6):223-231, 2013. doi:10.1002/jcd.21332.

DEPARTMENT OF MATHEMATICS, NATIONAL TAIWAN NORMAL UNIVERSITY, TAIPEI 11677, TAI-WAN, ROC

*Email address*: hsia@math.ntnu.edu.tw

DEPARTMENT OF MATHEMATICS, NATIONAL TAIWAN NORMAL UNIVERSITY, TAIPEI 11677, TAI-WAN, ROC

Email address: li@math.ntnu.edu.tw

DEPARTMENT OF MATHEMATICS, NATIONAL TAIWAN NORMAL UNIVERSITY, TAIPEI 11677, TAI-WAN. ROC

*Email address*: wlsun@ntnu.edu.tw