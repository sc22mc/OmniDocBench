arXiv:2302.00876v1 [cs.CR] 2 Feb 2023

# IMPROVEMENT AND EVALUATION OF RESILIENCE OF ADAPTIVE CRUISE CONTROL AGAINST SPOOFING ATTACKS USING INTRUSION DETECTION SYSTEM

Mubark B Jedh Iowa State University Ames, United States mjedh@iastate.edu

Lotfi ben Othmane University of North Texas Denton, United States lotfi.benothmane@unt.edu

Arun K Somani Iowa State University Ames, United State run@iastate.edu

Abstract

The Adaptive Cruise Control (ACC) system automatically adjusts the vehicle speed to maintain a safe distance between the vehicle and the lead (ahead) vehicle. The controller's decision to accelerate or decelerate is computed using the target speed of the vehicle and the difference between the vehicle's distance to the lead vehicle and the safe distance from that vehicle. Spoofing the vehicle speed communicated through the Controller Area Network  $(CAN)$  of the vehicle impacts negatively the capability of the ACC (Proportional-Integral-Derivative variant) to prevent crashes with the lead vehicle. The paper reports about extending the ACC with a real-time Intrusion Detection System (IDS) capable of detecting speed spoofing attacks with reasonable response time and detection rate, and simulating the proposed extension using the CARLA simulation platform. The results of the simulation are:  $(1)$  spoofing the vehicle speed can foil the ACC to falsely accelerate, causing accidents, and  $(2)$  extending ACC with ML-based IDS to trigger the brakes when an accident is imminent may mitigate the problem. The findings suggest exploring the capabilities of ML-based IDS to support the resilience mechanisms in mitigating cyber-attacks on vehicles.

# 1 Introduction

The Adaptive Cruise Control (ACC) is an advanced cruise control system that automatically adjusts the vehicle speed to maintain a safe distance between the (ego) vehicle and the lead (ahead) vehicle. The objective of the ACC system is to make the ego vehicle travels at the driver's specified speed as long as it travels at a safe distance from the lead vehicle. The ACC-equipped vehicle uses radar sensors to measure the distance to the lead vehicle, as depicted by Figure 1, to take proper actions (acceleration or deceleration) in order to keep a safe distance from the lead vehicle.<sup>1</sup> Winner et al., for example, designed an ACC control module that uses a range sensor to measure the distance between the vehicle and the lead vehicle  $[1]$ .<sup>2</sup> The first commercial system in use was a lidar-based distance detection system Debonair Mitsubishi, which is available since  $1992$ .

The promises of Adaptive Cruise Control (ACC) systems in terms of driver comforts and safety assurance encouraged researchers to experiment with the feasibility and impact of cyber-attack on ACC systems. The experiments showed that forcing the ACC to use the wrong information about the distance between the vehicle and the lead vehicle leads to the wrong acceleration/deceleration decision, which leads to accidents. The falsification of the safe distance was achieved using two techniques:  $(1)$  forcing the distance sensor (e.g., LIDAR or front Camera) to report wrong information to the ACC  $[3, 4]$ , and  $(2)$  manipulating the distance

 1The lead vehicle is driving in the same lane as the ego vehicle.

 2Cooperative Adaptive Cruise Control (CACC) uses, in addition, to the ego vehicle's speed and distance to the lead vehicle (which are used by ACC), information about the speed and location of close-by vehicles to better regulate its speed  $[2]$ .
 
1 INTRODUCTION

2

![](_page_1_Figure_1.jpeg)

Figure 1: Visualisation of the Adaptive Cruise Control (ACC). It shows that the sensor measured distance is smaller than the safe distance.

between the vehicle and the lead vehicle communicated by the distance sensor to the ACC through the CAN Bus  $[5, 6]$ . The proposed solutions focus on communicating the wrong distance between the vehicles to the ACC by, e.g., using time-varying sampling of the distance between the two vehicles [6] or Model Predictive Controller (MPC) system  $[5]$ .

Table 1:Strategy for resilience.

| ID | Technique                   | Addressed security aspect         | Description                                                                                                                                                       | Ref      |
|----|-----------------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
| 1  | Recursive Least square      | No Security                       | Online parameter estimation of distance gap by optimizing the root mean squared error (RMSE) between simulated space gap data and recorded space gap data.        | [7,8]      |
| 2  | Recursive Least square      | Challenge response authentication | A RLS is used to estimate the spoofed sensor measurement.                                                                                                         | [9]      |
| 3  | Extended Kalman filter      | Yes, through estimation           | Estimating the velocity of the vehicle in the local reference system.                                                                                             | [10, 11] |
| 4  | Kalman filter               | No Security                       | Estimating the velocity of the vehicle in the local reference system and concurrently the absolute position                                                       | [10]     |
| 5  | Particle filter             | No Security                       | Online parameter estimation of ACC                                                                                                                                | [8]      |
| 6  | Model Predictive Controller | Yes, through estimation           | Applies the linear model of the system, disturbance, and noise models to estimate the state of the control system and also anticipate the system's future outputs | [5]      |


The ACC uses the vehicle's speed, besides the distance between the vehicle and the lead vehicle, in computing the acceleration/deceleration control decision. Forcing the ACC to use the wrong vehicle speed could also potentially lead to the wrong acceleration/deceleration decision, which leads to accidents. This paper proposes extending the ACC system with a real-time IDS to detect cyber-attacks on the vehicle and to trigger the brakes when spoofing of the vehicle speed is detected. We implemented the solution into CARLA simulator [12] considering the performance of a real-time IDS implemented in our previous research [13, 14, 15]. The solution is assessed using the following scenarios: (1) simulate the ego vehicle trailing the lead vehicle and using an ACC to avoid crashes; (2) simulate the ego vehicle trailing the lead vehicle while using the ACC to avoid crashes, and spoofing the speed of the ego vehicle; and  $(3)$  simulate the ego vehicle trailing a lead vehicle, spoof the speed of the ego vehicle, and use an ACC extended with a simulated real-time IDS [14].

The contributions of the paper are:

- Demonstrate that spoofing the speed of the vehicle can mislead the ACC to compute the wrong safety distance with the lead vehicles, leading to potential crashes.
- Extend the ACC (Proportional-Integral-Derivative (PID) variant [16]) with a real-time IDS to force cold brake when spoofing of the vehicle speed is detected addresses the problem.

The results suggest that using the vehicle's IDS by proactively monitoring the CAN bus will improve the resilience of the ACC system to cyber-attacks.

The paper is organized as follows: section 2 gives an overview of related works; section 3 describes the proposed ACC extension with real-time IDS; section 4 describes and analyses the results of simulating the proposed extension; and section  $5$  concludes the paper.

2 RELATED WORK

3

# 2 Related work


This section describes related work on cyber-attacks on ACC systems and cyber-resilience of ACC systems.

## 2.1 Cyber-attacks on Adaptive Cruise Control

Several researchers investigated the security of LiDAR, especially spoofing the LiDAR signal. For instance, Harris [4] developed an attack on LiDAR laser that makes the vehicle wrongly believe that there is a large object in front of it, preventing it from moving by overwhelming the LiDAR sensor [4]. Coa et al. spoofed obstacles, leading the LiDAR-based perception to believe it is close to the object  $[3]$ . Also, Rad et al. [17] and Jagielski et al. [18] showed that sensor spoofing against RADAR and LIDAR impacts the efficiency of the ACC and CACC leading to potential discomfort of the passenger and safety hazard including accidents. Farivar et al. [5] proposed a covert attack on ACC that manipulate radar sensor input, which leads the ACC to decrease the safe distance, causing crashes. The authors developed an IDS for such attacks and corrected the system using MPC system. Moreover, Sun et al. demonstrated a spoofing attack against a LiDAR sensor, effectively tricking the system into perceiving an obstacle in its path by transmitting laser signals to the victim's LiDAR [19]. Their result showed that attackers can achieve  $80\%$  mean success rate on all LiDAR target models. Petit et al. [20] showed the efficacy of the Lidar relay attacks and spoofing attacks using a cheap transceiver.

The proposed solutions to such attack include the physical chall-enge-response authentication  $(PyCRA)$ technique, which was developed by Shoukry et al. [21] to enhance the cyber-resilience of sensors to attacks. PyCRA assumes that an attacker cannot detect a challenge immediately due to its hardware and signal processing latency. Given that, PyCRA detects an attack signal that continues to be higher than a noise threshold during a challenging period using the Chi-square method. PyCRA turns off sensors that have been attacked, providing an authentication mechanism that not only detects malicious attacks but provides resilience against them.

The ACC system uses the speed and distance sensors information to compute the desired acceleration to maintain a safe distance from the lead vehicle. The system is integrated as an embedded system into the CAN Bus, which is known to be vulnerable to cyber-attacks exploiting the lack of secure communication between the Electronic Control Units (ECUs) communicating through the bus [22]. Heijeden et al. [23] showed that controllers are vulnerable to jamming or Denial of Service (DoS) and message injection attacks and proposed quantifying the impact of attacks on vehicle controllers system. Furthermore, Tianxiang et al. [6] studied the stability of the ACC system subject to DoS by performing real-time DoS attacks on the ACC system at various time steps and studying the time it takes the ACC system to return to the closed-loop system. They found that under DoS attacks, the ACC system behaves as an open-loop system, and the speed errors increase.

## 2.2 Cyber-resilience of Adaptive Cruise Control

Several authors investigated different aspects of ACC resilience to cyber-attacks. Table 1 summarizes the main proposed techniques. Oh et al. proposed using a sliding mode observer to detect sensor faults in the case of cyber-attacks on the acceleration sensor and radar [24]. Abdollahi et al. also proposed using a sliding mode observer to detect  $DoS$  attack and estimate correction [25]. Fiu et al. proposed a technique to estimate the position of a vehicle under GPS spoofing and LIDAR replay attacks [11]. In addition, Liu proposed the use of an extended Kalman filter to fuse sensor measurements to estimate a vehicle's position and designed a Cumulative Sum (CUSUM) detector based on the residual of Extended Kalman Filter (EKF) to monitor the inconsistency [11]. When detecting that the sensor is under cyber-attack, EKF is reconfigured to estimate the correct position of a vehicle  $[11]$ .

Each of the resilience methods discussed above proposes new formulations of the controllers to mitigate specific attacks such as Denial of Service (DOS), which limit their adaptation in practice. Also, given that the algorithms/formulation are public, the attackers should be able to design attacks that avoid the protection-much like avoiding the failure-detection capabilities of existing controllers. This paper proposes delegating detecting cyber-attacks to IDS and extending the ACC controller to use IDS to mitigate such cyber-attacks. This allows having a robust and generic solution for cyber-attacks for ACC systems.

3 EXTENDING ADAPTIVE CRUISE CONTROL WITH ML-BASED INTRUSION DETECTION SYSTEM4

![](_page_3_Figure_1.jpeg)

Figure 2: Controllers composing the Adaptive Cruise Control System.

![](_page_3_Figure_3.jpeg)

Figure 3: Components of the Proportional-Integral-Derivative (PID) Controller model.

# 3 Extending Adaptive Cruise Control with ML-based Intrusion Detection System

The negative impact of spoofing distance sensors on the efficiency of ACC started to be known, and the community started developing ACC models resilient to cyber-attacks on these sensors and the distance data communicated through the CAN bus. These models do not consider spoofing the vehicle speed, also used by the ACC system. This paper proposes a generic solution to the ineffective resilience of ACC to cyber-attacks, focusing on spoofing vehicle speed. This section describes the proposed solution.

## 3.1 Overview of the Adaptive Cruise Control

The primary goal of the ACC is to maintain a safe distance from the lead vehicle, that is, keeping the difference between the current distance from the lead vehicle and the safe distance, as shown by figure 4, formulated using Equation 1, higher than zero. The Safe Stopping Distance (SSD), or simply the safe distance, determines how far the vehicle travels before it comes to a complete stop and avoids collision with the lead vehicle, as is formulated using Equation  $2$  [26].

$$
D = D_c - SSD
$$

(1)

![](_page_3_Figure_10.jpeg)

Figure 4: The Ego vehicle uses an ACC while following the lead vehicle, which allows it to keep a safe distance.

3.2 Architecture of the Extended Adaptive Cruise Control

5

$$
SSD = 0.278 \times t \times v + \frac{v^2}{254} \times f + g
$$

(2)

where SSD is the stopping distance in meters,  $t$  is the perception-reaction time in seconds (it is 2.5s for most drivers),  $v$  is the speed of the car in km/h,  $G$  is the slope of the road, and  $f$  is the coefficient of friction between the tires and the road. The ego vehicle avoids collision while moving by stopping immediately when the SSD is less than its current distance from the lead vehicl.

The ACC system uses two controllers as depicted by Figure 2: an upper-level controller and a lower-level controller. The lower-level controller determines the throttle and brake while the upper-level controller determines the desired longitudinal acceleration to attain the desired spacing and constant speed [16]. Different dynamic responses that implement the two-levels ACC system have been proposed including PID controllers [16], Linear Quadratic Regulator control (LQR) [27], Sliding Mode Control [28], Fuzzy Logic Control [29], and Model Predictive Controller (MPC) [5]. We use in this paper the PID model because it is widely used in many systems to reach the stability status.

$$
e(t) = S_t(t) - S_c(t)
$$

(3)

Figure 3 depicts the overall PID-based ACC system [16]. The PID controller adjusts the acceleration and deceleration commands to minimize the error computed using Equation 3, which measures the difference between the target speed of the vehicle  $(S_t)$  and its current speed  $(S_c)$  as measured by the speed sensor [16]. The speed error is used to compute the control signal  $u(t)$ , shown in Figure 3, using Equation 4, which uses  $\text{three constants:

- $K_p$  proportional gain of the action to the error,
- $K_i$  integral gain to reduce the steady-state errors through low-frequency compensation by an  $\text{integration}$
- $K_d$  derivative gain to improve the transient response through high-frequency compensation by a differential.

$$
u(t) = K_{\rm p}e(t) + K_{\rm i} \int_0^t e(t) \, \mathrm{dt} + K_{\rm d} \frac{\mathrm{d}e(t)}{\mathrm{d}t} \quad [16]
$$

(4)

Increasing the  $K_p$  value helps the vehicle reaching the target speed more quickly, but tends to exceed its target and overshoot. The  $K_d$  term affects the decrease of the overshoot. The  $K_i$  value affects the capability to limit the steady error and prevent oscillatory. Adjusting the gains of the  $K_p$ ,  $K_d$ , and  $K_i$  allows to achieve a satisfactory overall response.

## 3.2 Architecture of the Extended Adaptive Cruise Control

Resilience has been an effective active solution for vehicle controllers, providing robust capabilities for vehicles to reduce errors and detect failures during vehicle operation. Resilience mechanisms trust the sensors to provide measurements and consider the random outliers as errors. Cyber-attacks mislead the controllers by spoofing the sensor measurements. A resilient controller should enhance the system's performance during an attack.

IDS has been proposed as a solution, although passive, to mitigate cyber-attacks on vehicles  $[30, 31]$ . It detects intrusion that results in compromised system components in the ACC system (e.g., sensors and controllers output) and reports the anomaly to combat the malicious attackers. ACC cannot report an intrusion detected by the IDS to a remote security expert or even the driver and wait for their decision while possibly getting closer to the lead vehicle.

The ACC must use a correct, safe distance to work properly. We propose to extend the ACC with a vehicle IDS that allows detecting the vehicle's speed spoofing with reasonable efficacy. The ACC has two options to mitigate detected cyber-attacks:  $(1)$  trigger cold break and  $(2)$  get the correct speed using another approach, including predicting it using machine learning models. We use option one in this paper as it allows us to evaluate the solution more easily.

3.2 Architecture of the Extended Adaptive Cruise Control

![](_page_5_Figure_1.jpeg)

Figure 5: Architecture design simulation setup for scenario three

![](_page_5_Figure_3.jpeg)

Figure 6: Flowchart of the proposed extended ACC, called ACC-IDS. The IDS components are marked with the gray color.

Figure 7 shows the architecture of the proposed extended ACC, called from now on ACC-IDS, that uses a real-time IDS to detect attacks [15], in addition to the driver-specified target speed, the distance to the lead vehicle, and the vehicle speed (used to compute the safe distance).<sup>3</sup> Real-time IDS for cars monitors the CAN bus of the vehicle and detects message injections that spoof, for example, the speed sensor using, e.g., machine learning techniques.

Figure 6 shows the flowchart of the proposed ACC-IDS. It shows that the messages read from the CAN bus of the vehicle are processed by the IDS component and also used to check whether the vehicle maintains a safe distance from the lead vehicle. The ACC-IDS applies an emergency brake when either the distance to the object is less than the SSD or an intrusion is detected.

3Let's assume that spoofing the road's slope and the friction coefficient between the tires and the road may not have an important impact on the safe stopping distance.

Table 2. The performance of the LDS in the simulated section [15].

| Factor                                                                      | Parameter                    |
|-----------------------------------------------------------------------------|------------------------------|
| Dataset                                                                     | $\text{Simulated real-time}$ |
| Network                                                                     | $\text{Simulated CAN bus}$   |
| $\text{Detection rate}$                                                     | $0.97\%$                     |
| $\text{Detection latency}$                                                  | $152 \text{ ms}$             |
| $\text{Response time}$                                                      | $1026 \text{ ms}$            |
|                                                                             |                              |

4 EVALUATION OF THE ACC-IDS SUING GARLA SIMULATION

7

![](_page_6_Figure_1.jpeg)

Figure 7: Architecture for simulation setup

The ACC-IDS can be effective only if the IDS provides high accuracy in detecting messages injections $^4$ and low response time sufficient for the upper and lower controllers to adjust the vehicle's speed and avoid an accident. There is currently no real-time IDS for connected vehicles to use in evaluating the solution. To assess the solution, we use the performance measures of a real-time IDS that we have proposed and simulated [14, 15] using data collected from a moving vehicle under malicious speed reading message injections [13]. Table 2 provides the performance measurement of the real-time IDS deployed on a Raspberry Pi in a simulated environment [15]. Notably, the response time of the IDS is 1.026 seconds, which is lower than the driver's reaction time of  $2.5$  seconds.

# 4 Evaluation of the ACC-IDS using CARLA Simulation

We evaluate the ACC-IDS solution using the simulation method and CARLA simulation environment tool.

## 4.1 Simulation Setup

In the simulation, the position of the ego vehicle and lead vehicle is set in defined coordinates at the start point with a safe distance of 30 m. The ego vehicle detects the positions of neighboring vehicles and obstacles in real time.<sup>5</sup> The PID controllers compute both the steering and acceleration/braking commands in order to achieve a safe distance from the lead vehicle.<sup>6</sup> The ego vehicle uses obstacle detection and safe distance to avoid crashes. The simulated scenarios are:

- 1. Scenario 1 Ego vehicle drives at target speed of  $25 \text{ km/h}$  and lead vehicle drives at speed of  $0 \text{ km/h}$ to 30 km/h and back to  $0 \text{ km/h}$ .<sup>7</sup> The ego vehicle sensor speed is not spoofed
- 2. Scenario 2 The target speed of the ego vehicle and lead vehicle are set to  $60 \text{ km/h}$ . The ego vehicle sensor speed is spoofed to  $10 \text{km/h}$ . The ACC of the ego vehicle does not use an IDS to detect the spoofing. The attack interval is fixed at a rate of  $75\%$ , leading the controller to falsely produce more throttle force than sufficient. The scenario is repeated with the target speed of the ego vehicle and lead vehicle is set to  $90 \text{ km/h}$ .
- 3. Scenario 3 The target speed of the ego vehicle and lead vehicle is set to  $60 \text{ km/h}$ . The ego vehicle sensor speed is spoofed to 10km/h. The ACC of the ego vehicle uses the real-time IDS to detect the spoofing. The parameters of the IDS are provided by Table 2. The scenario is repeated with the target speed of the ego vehicle and lead vehicle is set to  $90 \text{ km/h}$ .

We note that we also simulated the three scenarios with the target speed of the ego vehicle and lead vehicle is set to 40 km/h [32]. The results are omitted as it provides less insight as setting target speed of 60 km/h and 90 km/h.

We designed our simulation scenario using the CARLA simulator [12]. The proposed evaluation framework, including the structure of the simulation, is shown in Figure 7. Data from the sensors are obtained by

 4Messages are injected as spoofing of a given ECU.

 5The vehicle is allowed to ignore the speed limits and traffic lights. The stop destination is straight ahead of the starting point, and there are no dynamic objects in the environment.

 6It is assumed that the lower-level controller applies controller output synchronously, which makes the vehicle accelerate or decelerate exactly with the desired acceleration.

 7he speed of the lead vehicle is read from a CAN bus log dataset of a moving vehicle [13].
 
4.2 Result and Analysis of Simulation Experiments
 
 8
 
 Table 3: Summary of the simulated scenarios. The ego vehicle uses PID-based ACC for all the scenarios.

| Scenario | Target speed of ego vehicle | Target speed of lead          | Attack type              | Use of IDS | Crashes |
|----------|-----------------------------|--------------------------------|--------------------------|------------|---------|
| 1        | 25 km/h                     | extracted from the CAN Bus     | no spoofing              | No         | No      |
| 2        | 60 and 90 km/h              | 60, and 90 km/h                | spoofing of speed sensor | No         | Yes     |
| 3        | 60 and 90 km/h              | 60, and 90 km/h                | spoofing of speed sensor | Yes        | No      |


![](_page_7_Figure_3.png)

(a)The ego vehicle mimics a car driving at speed increasing from 0 km/h to 30 km/h and decreasing to 0km/h again.The ECUs of the vehicle are not spoofed.

(b)The ego vehicle uses the CAN bus log of moving vehicle while the RPM reading is being spoofed.

(c) The ego vehicle uses CAN log of moving vehicle while speed reading is being spoofing

Figure 8: Simulation results of the effectiveness of PID-based ACC for the scenario  $1$  - The ego vehicle drives at target speed of  $25 \text{km/h}$  and the lead vehicle drives at varying speed values. The figure shows that the distance between the two vehicles (in green) oscillates to keep a safe distance between the vehicles and avoid crashes. The used CAN Bus log is available in  $[13]$ .

connecting to the CARLA server. We used Town04 and Town05 given by the CARLA simulator to model both vehicles' routes. CARLA uses a set of ECUs emulators. Our simulation sends CARLA sensor data as messages periodically into a Linux virtual CAN bus. It also injects "spoofed" messages into the virtual CAN Bus to mislead the moving vehicle. CARLA's ACC and the simulated IDS read the ECUs data from the virtual CAN bus and process them according to the flowchart of Figure 6.

We used in this simulation the controller' constants used by the default CARLA setup. Given that driving is in a plane, the upper controller uses two controllers: (1) a longitudinal controller and (2) a latitude controller. We used  $K_p = 1.0$ ,  $K_d = 0$ ,  $K_i = 0.7$ , and  $dt = 0.05$  for the longitudinal controller and  $K_p = 1.98$ ,  $K_d = 0.20$ ,  $K_i = 0.07$ , and  $dt = 0.05$ . for the lateral controlle.

We implemented and deployed the simulation in accelerated computing AWS instances with 12 core processors, 200 GB of memory, and 8 GB of dedicated Nivida GPU running with a 64-bit Ubuntu 18.04.3 LTS.

## 4.2 Result and Analysis of the Simulation Experiments

This subsection reports about the results of the simulation scenarios.

### 4.2.1 Results of simulating scenario 1

In this scenario, we simulate an ego vehicle driving at target speed of  $25 \text{km}$  /h and a lead vehicle driving at speed of 0 km/h to 30 km/h and back to 0 km/h. We used a dataset [13] of a CAN Bus log of a moving car to mimic driving at speed of  $0 \text{ km/h}$  to  $30 \text{ km/h}$  and back to  $0 \text{ km}$.

Figure 8 plots the speed of the ego vehicle, lead vehicle and the distance between the two vehicles as time progresses. The speed of the ego vehicle in subfigure 8a is read from the log of a vehicle driving at speed increasing from 0 km/h to 30 km/h and back to 0 km/h again. The speed of the ego vehicle in subfigure  $8b$ is read from the log of a vehicle driving at speed increasing from  $0 \text{ km/h}$  to  $13 \text{ km/h}$  and back to  $0 \text{ km/h}$ again, while the RPM reading is being spoofed. The speed of the ego vehicle in subfigure 8c is read from

4.2 Result and Analysis of the Simulation Experiments

9

![](_page_8_Figure_1.jpeg)

(a)Simulation of normal driving of the ego and lead vehicle.



(b)Simulation of normal driving of the lead vehicle and spoofing of the speed of the ego vehicle.



(c)Collision frequency of the ego vehicle for the case of spoofing of the speed values.

Figure 9: Simulation results of the effectiveness of PID-based ACC for the scenario  $2$  - The ego and lead vehicles drive at target speed of  $90 \text{km/h}$ . Subfigure a shows that the distance between the two vehicles (in green) oscillates to keep a safe distance between the vehicles. Subfigure b shows that the distance between the two vehicles (in green) gets to low values between time steps  $40$  and  $60$ . Subfigure c shows the crashes of the two vehicles.

![](_page_8_Figure_5.jpeg)

(a) The ego vehicle speed is 40km/h.



(b) The ego vehicle speed is 60km/h



(c) The ego vehicle speed is 90km/h

Figure 10: Resilience response of ego vehicle while using the ACC-IDS. The figure shows that ACC-IDS reacts to messages injections correctly and avoids the crashes.

the log of a vehicle driving at speed increasing from  $0 \text{ km/h}$  to  $13 \text{ km/h}$  and back to  $0 \text{ km/h}$  again, while the speed reading is being spoofed.

The figure shows that the distance between the two vehicles (in green) oscillates to keep a safe distance between the vehicles. The ego vehicle accelerates and decelerates according to a command issued by the PID controller equation 4. The distance between the two vehicles decreases multiple times but the ego vehicle applies emergency breaks or decreases the speed to avoid crashing into the lead vehicle. The spoofed RPM and speed datasets didn't cause the ego vehicle to crash into the lead vehicle. The figure shows that the PID-based ACC succeeds in this scenario to regulate the speed of the ego vehicle to avoid crashes.

### 4.2.2 Results of simulating scenario 2

In this scenario, we simulate an ego vehicle driving at target speed of  $90 \text{ km/h}$  and a lead vehicle driving at speed of  $90 \text{ km/h}$ . In addition, the speed sensor of the ego vehicle is spoofed to  $10 \text{ km/h}$ . Figure 9 plots the speed of the ego vehicle, lead vehicle and the distance between the two vehicles as time progresses. Subfigure a shows that the distance between the two vehicles (in green) oscillates to keep a safe distance between the vehicles. Subfigure b shows that the distance between the two vehicles (in green) gets to low values between time steps 40 and 60. Subfigure c shows the crashes of the two vehicles. The figure shows that PID-based ACC succeed to regulate the speed of the ego vehicle in normal driving condition but fails to do so when the speed sensor is spoofed. The experiments was repeated for speed target of  $40 \text{ km/h}$  and  $60 \text{ km/m}$  with the same observation. $8$ 

<sup>8<sup>Interested reader may consult reference [32].

4.3 Impacts and limitations of the study

10

### 4.2.3 Results of simulating scenario 3

In this scenario, we simulate an ego vehicle driving at target speed of  $90 \text{ km/h}$  and a lead vehicle driving at speed of 90 km/h. In addition, the speed sensor of the ego vehicle is spoofed to  $10 \text{ km/h}$  and acts following a uniform distribution with probability of injection of spoofed message of  $0.75$ . We changed the PID-based ACC controller to use a flag returned by the IDS. The ACC initiates cold break when an attack is returned by the IDS and applies the default behavior otherwise.

Fig. 10c shows the speed and distance of the ego vehicle and lead vehicle. The IDS was simulated with a success rate of  $0.97\%$  and a response time of 149 ms as a single process with no threads. furthermore, Figure 10c shows the distance between the ego and the lead vehicle increases drastically as the ego vehicle continues to apply the emergency brake to avoid crashing with the lead vehicle.

## 4.3 Impacts and limitations of the study

These simulation results demonstrate that extending ACC with ML-based real-time IDS would allow for mitigating cyber-attacks. The simulation covers three cases:  $(1)$  vehicles drive at 40 km/h, and the spoofed speed is 5 km/h, (2) vehicles drive at 60 km/h, and the spoofed speed is 10 km/h, and (3) vehicles drive at 40 km/h, and the spoofed speed is  $10 \text{ km/h}$ . The three scenarios show that spoofing the speed of the Ego vehicle misleads the ACC to accelerate, which causes accidents and that the ACC-IDS responds to the attacks and avoids accidents.

The simulation of the three scenarios with the target speed of the ego vehicle and lead vehicle is set to 40  $\text{km/h}$  [32] shows that spoofing the speed of an ACC-equipped ego vehicle driving at a speed of 40km/h causes accidents when the spoofed value is  $5 \text{ km/h}$  and does not cause accidents when the value is  $10 \text{km/h}$ . We observe also that spoofing the speed of an ACC-equipped ego vehicle with a value of  $10 \text{ km/h}$  does not cause accidents when the speed of the vehicle is  $40 \text{ km/h}$  but causes an accident when the speed of the vehicle is  $60 \text{ km/h}$  or  $90 \text{ km/h}$ . Thus, the ACC-equipped vehicle fails to mitigate speed spoofing attacks based on the combination of the Ego vehicle's speed and the spoofed speed value.

We used in the simulation study a spoofing detection success rate of  $97\%$  and a response time of  $1.026$  seconds for the IDS. These parameters show that the proposed approach avoids accidents for the three simulated scenarios. An extensive simulation that varies the speed of the vehicle, the values of the spoofed speed, the IDS's success rate to detect injection, and the IDS's response time should be performed to set the boundaries of success of ACC-IDS in mitigating message injection.

# 5 Conclusion

Newer vehicles include ACCs that regulate the vehicle's speed for driver comfort and accident avoidance. Spoofing the vehicle speed communicated through the CAN bus of the vehicle can mislead the ACC to accelerate and crash the vehicle with the lead vehicle. The paper proposes extending the ACC with a real-time IDS capable of detecting speed spoofing attacks with reasonable response time, and detection rate. The CARLA simulation shows that the proposed extended ACC, called ACC-IDS, mitigates speed spoofing attacks as the ML-based IDS triggers the brakes when an accident is imminent. The findings suggest exploring the integration of real-time IDS into the resilience mechanisms to mitigate cyber-attacks on vehicles instead of using the estimation approach.

We will explore in the future the impact of the speed of the vehicle, the values of the spoofed speed, the IDS's success rate to detect injections, and the IDS's response time on the efficacy of the ACC-IDS in mitigating cyber-attacks on the CAN bus of connected vehicles.

# References

- [1] H. Winner, S. Witte, W. Uhler, and B. Lichtenberg, "Adaptive cruise control system aspects and development trends," in *International Congress and Exposition*, SAE International, feb 1996.
- [2] S. Sardesai, D. Ulybyshev, L. ben Othmane, and B. Bhargava, "Impacts of security attacks on the effectiveness of collaborative adaptive cruise control mechanism," in 2018 IEEE International Smart Cities Conference (ISC2), pp. 1–5, 2018.
- [3] Y. Cao, C. Xiao, B. Cyr, Y. Zhou, W. Park, S. Rampazzi, Q. A. Chen, K. Fu, and Z. M. Mao, "Adversarial sensor attack on lidar-based perception in autonomous driving," in *Proceedings of the*

REFERENCES

11

2019 ACM SIGSAC Conference on Computer and Communications Security, CCS '19, (New York, NY, USA), p. 2267–2281, Association for Computing Machinery, 2019.

- [4] M. Harris, "Researcher hacks self-driving car sensors," Sep 2015.
- [5] F. Fariyar, M. Sayad Haghighi, A. Jolfaei, and S. Wen, "On the security of networked control systems in smart vehicle and its adaptive cruise control," IEEE Transactions on Intelligent Transportation Systems, vol. 22, no. 6, pp. 3824–3831, 2021.
- [6] Q. Tianxiang, H. Defeng, L. Liangye, and S. Xiulan, "Adaptive cruise control of vehicles subject to denial-of-service," in 2017 32nd Youth Academic Annual Conference of Chinese Association of Automa $tion (YAC)$ , pp. 382–386, 2017.
- [7] Y. Wang, G. Gunter, and D. B. Work, "Online parameter estimation of adaptive cruise control models with delays and lags," in 2020 IEEE 23rd International Conference on Intelligent Transportation  $Systems (ITSC)$ , pp. 1–6, 2020.
- [8] Y. Wang, G. Gunter, M. Nice, M. L. D. Monache, and D. B. Work, "Online parameter estimation methods for adaptive cruise control systems," *IEEE Transactions on Intelligent Vehicles*, vol. 6, no. 2, pp.  $288-298$ ,  $2021$ .
- [9] R. G. Dutta, X. Guo, T. Zhang, K. Kwiat, C. Kamhoua, L. Njilla, and Y. Jin, "Estimation of safe sensor measurements of autonomous system under attack," in Proceedings of the 54th Annual Design Automation Conference 2017, DAC '17, (New York, NY, USA), Association for Computing Machinery, 2017.
- [10] M. Bersani, M. Vignati, S. Mentasti, S. Arrigoni, and F. Cheli, "Vehicle state estimation based on kalman filters," in 2019 AEIT International Conference of Electrical and Electronic Technologies for  $Automotive (AEIT AUTOMOTIVE), \text{ pp. 1–6, 2019.}$
- [11] Q. Liu, Y. Mo, X. Mo, C. Lv, E. Mihankhah, and D. Wang, "Secure pose estimation for autonomous vehicles under cyber attacks," in 2019 IEEE Intelligent Vehicles Symposium (IV), pp. 1583–1588, 2019.
- [12] A. Dosovitskiy, G. Ros, F. Codevilla, A. Lopez, and V. Koltun, "CARLA: An open urban driving simulator," in Proceedings of the 1st Annual Conference on Robot Learning, pp. 1–16, 2017.
- [13] L. Ben Othmane, L. Dhulipala, M. Abdelkhalek, N. Multari, and M. Govindarasu, "On the performance of detecting injection of fabricated messages into the can bus," *IEEE Transactions on Dependable and* Secure Computing, vol. 19, pp. 468–481, Jan.-Feb. 2022.
- [14] M. Jedh, L. Ben Othmane, N. Ahmed, and B. Bhargava, "Detection of message injection attacks onto the can bus using similarities of successive messages-sequence graphs," *IEEE Transactions on Information* Forensics and Security, vol. 16, pp. 4133–4146, 2021.
- [15] M. B. Jedh, J. K. Lee, and L. B. Othmane, "Evaluation of the architecture alternatives for real-time intrusion detection systems for connected vehicles," in Proc. the IEEE International Conference on Software Quality, Reliability, and Security, (Guangzhou, China), Dec. 2022.
- [16] R. Rajamani, Vehicle dynamics and control. Springer Science & Business Media, 2011.
- [17] S. A. Rad, M. G. Tamizi, M. Azmoun, M. T. Masouleh, and A. Kalhor, "Experimental study on robust adaptive control with insufficient excitation of a 3-dof spherical parallel robot for stabilization purposes," Mechanism and Machine Theory, vol. 153, p. 104026, 2020.
- [18] M. Jagielski, N. Jones, C.-W. Lin, C. Nita-Rotaru, and S. Shiraishi, "Threat detection for collaborative adaptive cruise control in connected cars," in Proceedings of the 11th ACM Conference on Security  $\mathcal{E}$ Privacy in Wireless and Mobile Networks, pp. 184–189, 2018.
- [19] J. Sun, Y. Cao, Q. A. Chen, and Z. M. Mao, "Towards robust lidar-based perception in autonomous driving: General black-box adversarial sensor attack and countermeasures," 2020.
- [20] J. Petit, B. Stottelaar, M. Feiri, and F. Kargl, "Remote attacks on automated vehicles sensors: Experiments on camera and lidar," *Black Hat Europe*, vol. 11, no. 2015, p. 995, 2015.
- [21] Y. Shoukry, P. D. Martin, Y. Yona, S. N. Diggavi, and M. B. Srivastava, "Pycra: Physical challengeresponse authentication for active sensors under spoofing attacks," Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security, 2015.
- [22] L. B. Othmane, H. Weffers, M. M. Mohamad, and M. Wolf, A Survey of Security and Privacy in Connected Vehicles, pp. 217–247. New York, NY: Springer New York, 2015.
- [23] R. van der Heijden, T. Lukaseder, and F. Kargl, "Analyzing attacks on cooperative adaptive cruise control (cacc)," in 2017 IEEE Vehicular Networking Conference (VNC), pp. 45–52, 2017.

REFERENCES

12

- [24] K. Oh, S. Park, J. Lee, and K. Yi, "Functional perspective-based probabilistic fault detection and diagnostic algorithm for autonomous vehicle using longitudinal kinematic model," *Microsystem Technologies*, vol. 24, no. 11, pp. 4527–4537, 2018.
- [25] Z. Abdollahi Biron, S. Dey, and P. Pisu, "Real-time detection and estimation of denial of service attack in connected vehicle systems," *IEEE Transactions on Intelligent Transportation Systems*, vol. 19, no. 12, pp. 3893–3902, 2018.
- [26] A. A. of State Highway and T. Officials., "Policy on geometric design of highways and streets with  $2013$ )," 01 2011.
- [27] Y. Jiang, L. Cai, and X. Jin, "Optimization of adaptive cruise control system controller: using linear quadratic gaussian based on genetic algorithm," 2019.
- [28] B. Ganji, A. Z. Kouzani, S. Y. Khoo, and M. Nasir, "A sliding-mode-control-based adaptive cruise controller," in 11th IEEE International Conference on Control and Automation (ICCA), pp. 394-397,  $2014.$
- [29] S.-J. Ko and J.-J. Lee, "Fuzzy logic based adaptive cruise control with guaranteed string stability," in 2007 International Conference on Control, Automation and Systems, pp. 15–20, 2007.
- [30] C. Young, J. Zambreno, H. Olufowobi, and G. Bloom, "Survey of automotive controller area network intrusion detection systems," *IEEE Design and Test*, vol. 36, no. 6, pp. 48–55, 2019.
- [31] W. Wu, R. Li, G. Xie, J. An, Y. Bai, J. Zhou, and K. Li, "A survey of intrusion detection for in-vehicle networks," *IEEE Transactions on Intelligent Transportation Systems*, vol. 21, no. 3, pp. 919–933, 2020.
- [32] M. Jedh, attacks detection and cyber resilience: securing in-vehicle controller area network. PhD thesis, Iowa State University, 2023.